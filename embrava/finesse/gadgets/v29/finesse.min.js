/*
 almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/almond for details
*/
var $jscomp={scope:{},checkStringArgs:function(n,x,h){if(null==n)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(x instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return n+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(n,x,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");n!=Array.prototype&&n!=Object.prototype&&(n[x]=h.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(n,x,h,g){if(x){h=$jscomp.global;n=n.split(".");for(g=0;g<n.length-1;g++){var f=n[g];f in h||(h[f]={});h=h[f]}n=n[n.length-1];g=h[n];x=x(g);x!=g&&null!=x&&$jscomp.defineProperty(h,n,{configurable:!0,writable:!0,value:x})}};
$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(n,h){var g=$jscomp.checkStringArgs(this,n,"startsWith");n+="";for(var f=g.length,d=n.length,a=Math.max(0,Math.min(h|0,g.length)),b=0;b<d&&a<f;)if(g[a++]!=n[b++])return!1;return b>=d}},"es6-impl","es3");$jscomp.findInternal=function(n,x,h){n instanceof String&&(n=String(n));for(var g=n.length,f=0;f<g;f++){var d=n[f];if(x.call(h,d,f,n))return{i:f,v:d}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(n,h){return $jscomp.findInternal(this,n,h).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(n){return $jscomp.SYMBOL_PREFIX+(n||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(n){var x=0;return $jscomp.iteratorPrototype(function(){return x<n.length?{done:!1,value:n[x++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};$jscomp.makeIterator=function(n){$jscomp.initSymbolIterator();var x=n[Symbol.iterator];return x?x.call(n):$jscomp.arrayIterator(n)};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function x(){this.batch_=null}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;x.prototype.asyncExecute=function(d){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(d);return this};x.prototype.asyncExecuteBatch_=function(){var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})};var h=$jscomp.global.setTimeout;x.prototype.asyncExecuteFunction=function(d){h(d,0)};x.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=
this.batch_;this.batch_=[];for(var a=0;a<d.length;++a){var b=d[a];delete d[a];try{b()}catch(c){this.asyncThrow_(c)}}}this.batch_=null};x.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var g=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(b){a.reject(b)}};g.prototype.createResolveAndReject_=function(){function d(c){return function(e){b||(b=!0,c.call(a,e))}}var a=this,b=
!1;return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};g.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof g)this.settleSameAsPromise_(d);else{var a;a:switch(typeof d){case "object":a=null!=d;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};g.prototype.resolveToNonPromiseObj_=function(d){var a=void 0;try{a=d.then}catch(b){this.reject_(b);return}"function"==
typeof a?this.settleSameAsThenable_(a,d):this.fulfill_(d)};g.prototype.reject_=function(d){this.settle_(2,d)};g.prototype.fulfill_=function(d){this.settle_(1,d)};g.prototype.settle_=function(d,a){if(0!=this.state_)throw Error("Cannot settle("+d+", "+a|"): Promise already settled in state"+this.state_);this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};g.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=this.onSettledCallbacks_,a=0;a<d.length;++a)d[a].call(),
d[a]=null;this.onSettledCallbacks_=null}};var f=new x;g.prototype.settleSameAsPromise_=function(d){var a=this.createResolveAndReject_();d.callWhenSettled_(a.resolve,a.reject)};g.prototype.settleSameAsThenable_=function(d,a){var b=this.createResolveAndReject_();try{d.call(a,b.resolve,b.reject)}catch(c){b.reject(c)}};g.prototype.then=function(d,a){function b(a,b){return"function"==typeof a?function(b){try{c(a(b))}catch(l){e(l)}}:b}var c,e,f=new g(function(a,b){c=a;e=b});this.callWhenSettled_(b(d,c),
b(a,e));return f};g.prototype["catch"]=function(d){return this.then(void 0,d)};g.prototype.callWhenSettled_=function(d,a){function b(){switch(c.state_){case 1:d(c.result_);break;case 2:a(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?f.asyncExecute(b):this.onSettledCallbacks_.push(function(){f.asyncExecute(b)})};g.resolve=function(d){return d instanceof g?d:new g(function(a,b){a(d)})};g.reject=function(d){return new g(function(a,b){b(d)})};
g.race=function(d){return new g(function(a,b){for(var c=$jscomp.makeIterator(d),e=c.next();!e.done;e=c.next())g.resolve(e.value).callWhenSettled_(a,b)})};g.all=function(d){var a=$jscomp.makeIterator(d),b=a.next();return b.done?g.resolve([]):new g(function(c,e){function d(a){return function(b){k[a]=b;f--;0==f&&c(k)}}var k=[],f=0;do k.push(void 0),f++,g.resolve(b.value).callWhenSettled_(d(k.length-1),e),b=a.next();while(!b.done)})};$jscomp.EXPOSE_ASYNC_EXECUTOR&&(g.$jscomp$new$AsyncExecutor=function(){return new x});
return g},"es6-impl","es3");$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(n,x){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var h=0,g={next:function(){if(h<n.length){var f=h++;return{value:x(f,n[f]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill("Array.prototype.entries",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n,h){return[n,h]})}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n){return n})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(n,h,g){var f=this.length||0;0>h&&(h=Math.max(0,f+h));if(null==g||g>f)g=f;g=Number(g);0>g&&(g=Math.max(0,f+g));for(h=Number(h||0);h<g;h++)this[h]=n;return this}},"es6-impl","es3");
(function(n,x){"function"===typeof define&&define.amd?define("finesse",[],x):n.finesse=x()})(this,function(){var n,x,h;(function(g){function f(a,b){var c,e,d,k,v,f,p,q,m,l=b&&b.split("/"),g=G.map,r=g&&g["*"]||{};if(a&&"."===a.charAt(0))if(b){l=l.slice(0,l.length-1);a=a.split("/");v=a.length-1;G.nodeIdCompat&&z.test(a[v])&&(a[v]=a[v].replace(z,""));a=l.concat(a);for(v=0;v<a.length;v+=1)if(c=a[v],"."===c)a.splice(v,1),--v;else if(".."===c)if(1!==v||".."!==a[2]&&".."!==a[0])0<v&&(a.splice(v-1,2),v-=
2);else break;a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((l||r)&&g){c=a.split("/");for(v=c.length;0<v;--v){e=c.slice(0,v).join("/");if(l)for(m=l.length;0<m;--m)if(d=g[l.slice(0,m).join("/")])if(d=d[e]){k=d;f=v;break}if(k)break;!p&&r&&r[e]&&(p=r[e],q=v)}!k&&p&&(k=p,f=q);k&&(c.splice(0,f,k),a=c.join("/"))}return a}function d(a,b){return function(){return q.apply(g,D.call(arguments,0).concat([a,b]))}}function a(a){return function(b){return f(b,a)}}function b(a){return function(b){r[a]=
b}}function c(a){if(t.call(u,a)){var b=u[a];delete u[a];B[a]=!0;k.apply(g,b)}if(!t.call(r,a)&&!t.call(B,a))throw Error("No "+a);return r[a]}function e(a){var b,c=a?a.indexOf("!"):-1;-1<c&&(b=a.substring(0,c),a=a.substring(c+1,a.length));return[b,a]}function p(a){return function(){return G&&G.config&&G.config[a]||{}}}var k,q,m,l,r={},u={},G={},B={},t=Object.prototype.hasOwnProperty,D=[].slice,z=/\.js$/;m=function(b,d){var w,k=e(b),p=k[0];b=k[1];p&&(p=f(p,d),w=c(p));p?b=w&&w.normalize?w.normalize(b,
a(d)):f(b,d):(b=f(b,d),k=e(b),p=k[0],b=k[1],p&&(w=c(p)));return{f:p?p+"!"+b:b,n:b,pr:p,p:w}};l={require:function(a){return d(a)},exports:function(a){var b=r[a];return"undefined"!==typeof b?b:r[a]={}},module:function(a){return{id:a,uri:"",exports:r[a],config:p(a)}}};k=function(a,e,w,k){var f,p,v,A,q=[];p=typeof w;var z;k=k||a;if("undefined"===p||"function"===p){e=!e.length&&w.length?["require","exports","module"]:e;for(A=0;A<e.length;A+=1)if(v=m(e[A],k),p=v.f,"require"===p)q[A]=l.require(a);else if("exports"===
p)q[A]=l.exports(a),z=!0;else if("module"===p)f=q[A]=l.module(a);else if(t.call(r,p)||t.call(u,p)||t.call(B,p))q[A]=c(p);else if(v.p)v.p.load(v.n,d(k,!0),b(p),{}),q[A]=r[p];else throw Error(a+" missing "+p);e=w?w.apply(r[a],q):void 0;a&&(f&&f.exports!==g&&f.exports!==r[a]?r[a]=f.exports:e===g&&z||(r[a]=e))}else a&&(r[a]=w)};n=x=q=function(a,b,e,d,f){if("string"===typeof a)return l[a]?l[a](b):c(m(a,b).f);if(!a.splice){G=a;G.deps&&q(G.deps,G.callback);if(!b)return;b.splice?(a=b,b=e,e=null):a=g}b=b||
function(){};"function"===typeof e&&(e=d,d=f);d?k(g,a,b,e):setTimeout(function(){k(g,a,b,e)},4);return q};q.config=function(a){return q(a)};n._defined=r;h=function(a,b,c){b.splice||(c=b,b=[]);t.call(r,a)||t.call(u,a)||(u[a]=[a,b,c])};h.amd={jQuery:!0}})();h("../thirdparty/almond",function(){});h("../thirdparty/Class",[],function(){var g=!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Class=function(){};Class.extend=function(d){function a(){!g&&this.init&&this.init.apply(this,arguments)}var b=this.prototype;
g=!0;var c=new this;g=!1;for(var e in d)c[e]="function"==typeof d[e]&&"function"==typeof b[e]&&f.test(d[e])?function(a,c){return function(){var e=this._super;this._super=b[a];var d=c.apply(this,arguments);this._super=e;return d}}(e,d[e]):d[e];a.prototype=c;a.prototype.constructor=a;a.extend=arguments.callee;return a};return Class});h("FinesseBase",["../thirdparty/Class"],function(g){g=g.extend({init:function(){}});window.finesse=window.finesse||{};return window.finesse.FinesseBase=g});h("utilities/../../thirdparty/util/converter",
[],function(){var g=function(){return{xml2json:function(f,d){var a={toObj:function(b){var c={};if(1===b.nodeType){if(b.attributes.length)for(var d=0;d<b.attributes.length;d++)c["@"+b.attributes[d].nodeName]=(b.attributes[d].nodeValue||"").toString();if(b.firstChild){for(var k=d=0,f=!1,m=b.firstChild;m;m=m.nextSibling)1==m.nodeType?f=!0:3==m.nodeType&&m.nodeValue.match(/[^ \f\n\r\t\v]/)?d++:4==m.nodeType&&k++;if(f)if(2>d&&2>k)for(a.removeWhite(b),m=b.firstChild;m;m=m.nextSibling)3==m.nodeType?c["#text"]=
a.escape(m.nodeValue):4==m.nodeType?c["#cdata"]=a.escape(m.nodeValue):c[m.nodeName]?c[m.nodeName]instanceof Array?c[m.nodeName][c[m.nodeName].length]=a.toObj(m):c[m.nodeName]=[c[m.nodeName],a.toObj(m)]:c[m.nodeName]=a.toObj(m);else b.attributes.length?c["#text"]=a.escape(a.innerXml(b)):c=a.escape(a.innerXml(b));else if(d)b.attributes.length?c["#text"]=a.escape(a.innerXml(b)):c=a.escape(a.innerXml(b));else if(k)if(1<k)c=a.escape(a.innerXml(b));else for(m=b.firstChild;m;m=m.nextSibling)c["#cdata"]=
a.escape(m.nodeValue)}b.attributes.length||b.firstChild||(c=null)}else if(9==b.nodeType)c=a.toObj(b.documentElement);else throw"unhandled node type: "+b.nodeType;return c},toJson:function(b,e,d){var c=e?'"'+e+'"':"";if(b instanceof Array){for(var f=0,p=b.length;f<p;f++)b[f]=a.toJson(b[f],"",d+"\t");c+=(e?":[":"[")+(1<b.length?"\n"+d+"\t"+b.join(",\n"+d+"\t")+"\n"+d:b.join(""))+"]"}else if(null==b)c+=(e&&":")+"null";else if("object"==typeof b){f=[];for(p in b)f[f.length]=a.toJson(b[p],p,d+"\t");c+=
(e?":{":"{")+(1<f.length?"\n"+d+"\t"+f.join(",\n"+d+"\t")+"\n"+d:f.join(""))+"}"}else c="string"==typeof b?c+((e&&":")+'"'+b.toString()+'"'):c+((e&&":")+b.toString());return c},innerXml:function(a){var b="",c=function(a){var b="";if(1==a.nodeType){for(var b=b+("<"+a.nodeName),e=0;e<a.attributes.length;e++)b+=" "+a.attributes[e].nodeName+'="'+(a.attributes[e].nodeValue||"").toString()+'"';if(a.firstChild){b+=">";for(e=a.firstChild;e;e=e.nextSibling)b+=c(e);b+="</"+a.nodeName+">"}else b+="/>"}else 3==
a.nodeType?b+=a.nodeValue:4==a.nodeType&&(b+="<![CDATA["+a.nodeValue+"]]\x3e");return b};for(a=a.firstChild;a;a=a.nextSibling)b+=c(a);return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(b){b.normalize();for(var c=b.firstChild;c;)if(3==c.nodeType)if(c.nodeValue.match(/[^ \f\n\r\t\v]/))c=c.nextSibling;else{var d=c.nextSibling;b.removeChild(c);c=d}else 1==c.nodeType&&a.removeWhite(c),c=c.nextSibling;
return b}};9==f.nodeType&&(f=f.documentElement);var b=a.toJson(a.toObj(a.removeWhite(f)),f.nodeName,"\t");return"{\n"+d+(d?b.replace(/\t/g,d):b.replace(/\t|\n/g,""))+"\n}"},json2xml:function(f,d){var a=function(b,c,d){var e="";if(b instanceof Array)for(var f=0,k=b.length;f<k;f++)e+=d+a(b[f],c,d+"\t")+"\n";else if("object"==typeof b){f=!1;e+=d+"<"+c;for(k in b)"@"==k.charAt(0)?e+=" "+k.substr(1)+'="'+b[k].toString()+'"':f=!0;e+=f?">":"/>";if(f){for(k in b)"#text"==k?e+=b[k]:"#cdata"==k?e+="<![CDATA["+
b[k]+"]]\x3e":"@"!=k.charAt(0)&&(e+=a(b[k],k,d+"\t"));e+=("\n"==e.charAt(e.length-1)?d:"")+"</"+c+">"}}else e+=d+"<"+c+">"+b.toString()+"</"+c+">";return e},b="",c;for(c in f)b+=a(f[c],c,"");return d?b.replace(/\t/g,d):b.replace(/\t|\n/g,"")}}}();window.finesse=window.finesse||{};return window.finesse.Converter=g});h("utilities/SaxParser",[],function(){var g={parse:function(f,d){var a=0,b=f.length,c=/^[ \t\r\n]*$/,e=function(){for(;c.test(f.charAt(a));)a+=1},p=function(){var c,e="";a+=1;"#"===f.charAt(a)?
(a+=1,"x"===f.charAt(a)?(c=2,a+=1):c=1):c=3;for(;";"!==f.charAt(a);)if(e+=f.charAt(a),a+=1,a>=b)throw Error("Unterminated XML reference: "+e);switch(c){case 1:return String.fromCharCode(parseInt(e,10));case 2:return String.fromCharCode(parseInt(e,16));case 3:switch(e){case "amp":return"&";case "lt":return"<";case "gt":return">";case "apos":return"'";case "quot":return'"';default:throw Error("Invalid XML entity reference: "+e);}}},k=function(){var q=[],m=[],l="",g=!1;for(a+=1;a<b;){l=f.charAt(a);if((g=
c.test(l))||"/"===l||">"===l){q=q.join("");d.call(null,"StartElement",q);break}else q.push(l);a+=1}if(g)for(;a<b;){e();l=f.charAt(a);if("/"!==l&&">"!==l){var g=[],l=[],u="";g.push(f.charAt(a));for(a+=1;a<b;){u=f.charAt(a);if(c.test(u)||"="===u)break;else g.push(u);a+=1}e();if("="===u)a+=1;else throw Error("Did not find = following attribute name at "+a);e();if(a!==b-1&&'"'===f.charAt(a))for(a+=1;a<b;){u=f.charAt(a);if('"'===u){g=g.join("");l=l.join("");d.call(null,"Attribute",{name:g,value:l});break}else l.push(u);
a+=1}else throw Error("Found unquoted attribute value at "+a);}l=f.charAt(a);if("/"===l||">"===l)break;else a+=1}if("/"===l)a!==b-1&&">"===f.charAt(a+1)&&(a+=1,d.call(null,"EndElement",q));else for(a+=1;a<b;){l=f.charAt(a);if("<"===l)if(a!==b-1&&"/"===f.charAt(a+1)){m=m.join("");c.test(m)||d.call(null,"Text",m);q=[];for(a+=2;a<b;){m=f.charAt(a);if(">"===m){q=q.join("");d.call(null,"EndElement",q);break}else q.push(m);a+=1}break}else m=m.join(""),c.test(m)||d.call(null,"Text",m),k(),m=[];else"&"===
l?m.push(p()):m.push(l);a+=1}};"<?xml"===f.substr(0,5)&&c.test(f.charAt(5))&&(a=f.indexOf(">")+1);e();k()}};window.finesse=window.finesse||{};window.finesse.utilities=window.finesse.utilities||{};return window.finesse.utilities.SaxParser=g});h("utilities/../../thirdparty/util/iso8601",[],function(){(function(g,f){var d=g.parse,a=[1,4,5,6,7,10,11];g.parse=function(b){var c,e=0;if(c=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(b)){b=
0;for(var p;p=a[b];++b)c[p]=+c[p]||0;c[2]=(+c[2]||1)-1;c[3]=+c[3]||1;"Z"!==c[8]&&c[9]!==f&&(e=60*c[10]+c[11],"+"===c[9]&&(e=0-e));c=g.UTC(c[1],c[2],c[3],c[4],c[5]+e,c[6],c[7])}else c=d?d(b):NaN;return c}})(Date)});h("utilities/../../thirdparty/util/Math.uuid",[],function(){(function(){var g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(f,d){var a=[],b;d=d||g.length;if(f)for(b=0;b<f;b++)a[b]=g[0|Math.random()*d];else{var c;a[8]=a[13]=a[18]=a[23]="-";
a[14]="4";for(b=0;36>b;b++)a[b]||(c=0|16*Math.random(),a[b]=g[19==b?c&3|8:c])}return a.join("")};Math.uuidFast=function(){for(var f=Array(36),d=0,a,b=0;36>b;b++)8==b||13==b||18==b||23==b?f[b]="-":14==b?f[b]="4":(2>=d&&(d=33554432+16777216*Math.random()|0),a=d&15,d>>=4,f[b]=g[19==b?a&3|8:a]);return f.join("")};Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var d=16*Math.random()|0;return("x"==f?d:d&3|8).toString(16)})}})()});h("utilities/Utilities",
["../../thirdparty/util/converter","./SaxParser","../../thirdparty/util/iso8601","../../thirdparty/util/Math.uuid"],function(g,f){var d={CONSTANTS:{CACHED_REST_DATA:"CACHED_REST_DATA",RELOAD_OTHER_SIDE:"RELOAD_OTHER_SIDE",LOG_COLL_DATA:"LOG_COLL_DATA",CHANGED_LAYOUT_STRUCTURE:"CHANGED_LAYOUT_STRUCTURE",PREVIOUS_LAYOUT_HASH_ID:"PREVIOUS_LAYOUT_HASH_ID",PREVIOUS_CD_LAYOUT:"PREVIOUS_CD_LAYOUT",MESSAGES_DATA:"MESSAGES_DATA",USER_ID:"USER_ID"},IDB_ACTIONS:{SAVE_OR_UPDATE:"saveOrUpdate",FETCH:"fetch",DELETE:"delete",
CLEAR_ALL:"clear"},IDB_TOPICS:{REQUEST:"finesse.idb.request",RESPONSE:"finesse.idb.response"},MAINTENANCE_STATE:{MIGRATING:"MIGRATING",SCHEDULED:"SCHEDULED"},_fakeConstuctor:function(){},getDOMStoreItem:function(a){var b=window.localStorage;if(b)return b.getItem(a)},setDOMStoreItem:function(a,b){var c=window.localStorage;return c?(c.setItem(a,b),!0):!1},removeDOMStoreItem:function(a){var b=window.localStorage;return b?(b.removeItem(a),!0):!1},clearDOMStore:function(){var a=window.localStorage;return a?
(a.clear(),!0):!1},receiveMessage:function(a,b){if("function"!==typeof a)throw Error("Callback is not a function.");var c=function(c){("string"!==typeof b||"string"===typeof b&&"string"===typeof c.origin&&c.origin.toLowerCase()===b.toLowerCase())&&a(c)};window.addEventListener?window.addEventListener("message",c,!1):window.attachEvent("onmessage",c);return c},isIEorEdge:function(){var a=-1!==navigator.userAgent.indexOf("Trident")||0<navigator.userAgent.indexOf("MSIE "),b="Netscape"===navigator.appName&&
-1<navigator.appVersion.indexOf("Edge");return a||b},sendMessage:function(a,b,c){b=b||parent;window.postMessage&&b.postMessage(a,c||"*")},validateHandler:function(a){if(void 0===a||"function"===typeof a)return a;throw Error("handler must be a function");},getErrCode:function(a){try{return a.object.ApiErrors.ApiError.ErrorType}catch(b){if(a&&a.status)return"HTTP "+a.status;if(a&&a.isUnsent)return"Request could not be completed"}},getErrData:function(a){try{return a.object.ApiErrors.ApiError.ErrorData}catch(b){if(a&&
a.status)return"HTTP "+a.status;if(a&&a.isUnsent)return"Request could not be completed"}},getErrMessage:function(a){try{return a.object.ApiErrors.ApiError.ErrorMessage}catch(b){if(a&&a.status)return"HTTP "+a.status;if(a&&a.isUnsent)return"Request could not be completed"}},getPeripheralErrorCode:function(a){try{return a.object.ApiErrors.ApiError.PeripheralErrorCode}catch(b){if(a&&a.status)return"HTTP "+a.status;if(a&&a.isUnsent)return"Request could not be completed"}},getErrOverrideable:function(a){try{return a.object.ApiErrors.ApiError.Overrideable}catch(b){if(a&&
a.status)return"HTTP "+a.status}},trim:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")},currentTimeMillis:function(){return(new Date).getTime()},getCurrentDrift:function(){var a;if(a=window.sessionStorage.getItem("clientTimestampDrift"))a=parseInt(a,10),isNaN(a)&&(a=0);return a},convertToServerTimeMillis:function(a){var b=this.getCurrentDrift();return a+b},currentServerTimeMillis:function(){var a=this.getCurrentDrift();return(new Date).getTime()+a},buildTimeString:function(a){var b;b="00:00";
a&&"-1"!==a&&(b=this.pad(Math.floor(a/6E4)),a=this.pad(Math.floor(a%6E4/1E3)),b=b+":"+a);return b},buildTimeStringWithOptionalHours:function(a){var b,c;b="00:00";var e="";a&&"-1"!==a&&(c=a/1E3,a=this.pad(Math.floor(c/3600)),b=this.pad(Math.floor(c%3600/60)),c=this.pad(Math.floor(c%3600%60)),0<a&&(e=a+":"),b=e+b+":"+c);return b},buildElapsedTimeString:function(a,b){var c,e;c="--:--";0!==b&&(e=a-b,0<e&&(c=this.buildTimeString(e)));return c},buildElapsedTimeStringWithOptionalHours:function(a,b){var c,
e;c="--:--";0!==b&&(e=a-b,0<e&&(c=this.buildTimeStringWithOptionalHours(e)));return c},buildTotalTimeString:function(a,b){return this.buildElapsedTimeString(a,b)},buildHoldTimeString:function(a,b){return this.buildElapsedTimeString(a,b)},buildWrapupTimeString:function(a,b){return this.buildElapsedTimeString(a,b)},extractTime:function(a){""===a?a=0:null===a?a=0:(a=this.parseDateStringISO8601(a),a=a.getTime());return a},generateUUID:function(){return Math.uuidCompact()},xml2json:finesse.Converter.xml2json,
getJSONParser:function(){return(window.gadgets||{}).json||window.JSON},json2xml:function(a,b){return b?this._json2xmlWithEscape(a):finesse.Converter.json2xml(a,"\t")},xml2JsObj:function(a){return this.getJSONParser().parse(finesse.Converter.xml2json(jQuery.parseXML(a),""))},xml2js:function(a){var b=0,c={},e,d=[c],k="",q=function(a,b){var c=d[d.length-1];c.hasOwnProperty(a)&&c[a]instanceof Array?c[a].push(b):c.hasOwnProperty(a)?c[a]=[c[a],b]:c[a]=b};f.parse(a,function(a,c){switch(a){case "StartElement":1===
b&&(e={},q(k,e),d.push(e));b=1;k=c;break;case "EndElement":1===b?q(k,null):4===b&&d.pop();b=4;break;case "Attribute":1===b&&(e={},q(k,e),d.push(e));q("@"+c.name,c.value);b=2;break;case "Text":2===b?q("#text",c):q(k,c),b=3}});return c},js2xml:function(a){var b="",c,e;if(null!==a)if(a.constructor===Object)for(e in a)if(null===a[e]||"undefined"===typeof a[e])b+="<"+e+"/>";else if(a[e].constructor===Array)for(c=0;c<a[e].length;c++)b+="<"+e+">"+this.js2xml(a[e][c])+"</"+e+">";else"@"!==e[0]&&(b=this.js2xmlObjIsEmpty(a[e])?
b+("<"+e+this.js2xmlAtt(a[e])+"/>"):"#text"===e?b+a[e]:b+("<"+e+this.js2xmlAtt(a[e])+">"+this.js2xml(a[e])+"</"+e+">"));else b=a;return b},js2xmlAtt:function(a){var b;if(null!==a&&a.constructor===Object)for(b in a)if(null!==a[b]&&"undefined"!==typeof a[b]&&a[b].constructor!==Array&&"@"===b[0])return" "+b.substring(1)+'="'+a[b]+'"';return""},js2xmlObjIsEmpty:function(a){var b;if(null!==a)if(a.constructor===Object)for(b in a)if(null!==a[b]){if(a[b].constructor===Array||"@"!==b[0])return!1}else return!1;
else return!1;return!0},b64Encode:function(a){var b="",c,e;for(c=0;c<a.length;c+=3)e=a.charCodeAt(c)<<16|a.charCodeAt(c+1)<<8|a.charCodeAt(c+2),b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>>12&63),b+=c+1<a.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e>>>6&63):"=",b+=c+2<a.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e&
63):"=";return b},b64Decode:function(a){var b="",c,e;for(c=0;c<a.length;c+=4)e=["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c)),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c+1)),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c+2)),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(c+3))],e=e[0]<<18|e[1]<<12|e[2]<<6|e[3],e="="===a.charAt(c+2)?String.fromCharCode(e>>>
16&255):"="===a.charAt(c+3)?String.fromCharCode(e>>>16&255,e>>>8&255):String.fromCharCode(e>>>16&255,e>>>8&255,e&255),b+=e;return b},getCredentials:function(a){var b={};a=this.b64Decode(a);var c=a.indexOf(":");if(-1===c)throw Error("String is not colon delimited.");b.id=a.substring(0,c);b.password=a.substring(c+1);return b},removeSpaces:function(a){return a.split(" ").join("")},escapeSpaces:function(a){return a.replace(/\s/g,"\u00a0")},addWordWrapping:function(a){return'<span style="word-wrap: break-word;">'+
a+"</span>"},isArray:function(a){return-1!==a.constructor.toString().indexOf("Array")},getArray:function(a){if(this.isArray(a))return a;var b=[];b.push(a);return b},getId:function(a){if(!a)return"";var b=a.lastIndexOf("/");return a.slice(b+1)},getEquals:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&(a[c]||(a[c]=""),"undefined"===typeof b[c]||"object"===typeof b[c]&&!b[c].equals(a[c])||b[c]!==a[c]))return!1;return!0},ampRegEx:RegExp("&","gi"),ampEntityRefRegEx:RegExp("&amp;","gi"),ltRegEx:RegExp("<",
"gi"),ltEntityRefRegEx:RegExp("&lt;","gi"),gtRegEx:RegExp(">","gi"),gtEntityRefRegEx:RegExp("&gt;","gi"),xmlSpecialCharRegEx:RegExp("[&<>\"']","g"),entityRefRegEx:RegExp("&[^;]+(?:;|$)","g"),translateHTMLEntities:function(a,b){"undefined"!==typeof a&&null!==a&&""!==a&&(b?(a=a.replace(this.ampRegEx,"&amp;"),a=a.replace(this.ltRegEx,"&lt;"),a=a.replace(this.gtRegEx,"&gt;")):(a=a.replace(this.gtEntityRefRegEx,">"),a=a.replace(this.ltEntityRefRegEx,"<"),a=a.replace(this.ampEntityRefRegEx,"&")));return a},
translateXMLEntities:function(a,b){var c=function(a){switch(a){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case "'":return"&apos;";case '"':return"&quot;";default:return a}},e=function(a){switch(a){case "&amp;":return"&";case "&lt;":return"<";case "&gt;":return">";case "&apos;":return"'";case "&quot;":return'"';default:if("#"===a.charAt(1)&&";"===a.charAt(a.length-1))return"x"===a.charAt(2)?String.fromCharCode(parseInt(a.slice(3,-1),16)):String.fromCharCode(parseInt(a.slice(2,
-1),10));throw Error("Invalid XML entity: "+a);}};"undefined"!==typeof a&&null!==a&&""!==a&&(a=b?a.replace(this.xmlSpecialCharRegEx,c):a.replace(this.entityRefRegEx,e));return a},pad:function(a){return 10>a?"0"+a:String(a)},padWithWidth:function(a,b){var c,e,d;d="";for(e=b;1<e;e--)c=Math.pow(10,e-1),a<c&&(d+="0");return String(d+a)},convertDateToISODateString:function(a){return a.getUTCFullYear()+"-"+this.padWithWidth(a.getUTCMonth()+1,2)+"-"+this.padWithWidth(a.getUTCDate(),2)+"T"+this.padWithWidth(a.getUTCHours(),
2)+":"+this.padWithWidth(a.getUTCMinutes(),2)+":"+this.padWithWidth(a.getUTCSeconds(),2)+"."+this.padWithWidth(a.getUTCMilliseconds(),3)+"Z"},dateToISOString:function(a){var b;try{b=a.toISOString()}catch(c){b=this.convertDateToISODateString(a)}return b},parseDateStringISO8601:function(a){var b;a=a.match(/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:.(\d+))?(Z|[+\-]\d{2})(?::(\d{2}))?/);if(!a)return null;for(b in a)a[b]=~~a[b];return new Date(Date.UTC(a[1],a[2]-1,a[3],a[4],a[5],a[6],a[7])+6E4*
(60*a[8]+a[9]))},getDisplayTime:function(a){var b,c;b="00:00:00";a&&"-1"!==a&&(b=this.pad(Math.floor(a/3600)),c=this.pad(Math.floor(a%3600/60)),a=this.pad(Math.floor(a%3600%60)),b=b+":"+c+":"+a);return b},convertNullToEmptyString:function(a){return a||""},convertTsToDuration:function(a,b){return this.convertTsToDurationWithFormat(a,!1,b)},convertTsToDurationWithFormat:function(a,b,c){var e="-1";if(a&&"string"===typeof a){if("--"===a||""===a||"-1"===a)return"-1";a=Date.parse(a);if(!isNaN(a)&&(c=c&&
c instanceof Date?this.convertToServerTimeMillis(c.getTime()):this.currentServerTimeMillis(),e=Math.floor((c-a)/1E3),-1===e&&(e=0),0>e))return b?"-1":this.getDisplayTime("-1")}else if(b)return"-1";return this.getDisplayTime(e)},getRefreshTime:function(a,b){return Math.floor(a*b*1E3/100)},getParameterByName:function(a,b){var c;b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(a);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getUserAuthString:function(){return window.sessionStorage.getItem("userFinesseAuth")},
getAuthTokenObj:function(){var a=window.sessionStorage.getItem("ssoTokenObject");return this.getJSONParser().parse(a)},getToken:function(){var a=window.sessionStorage.getItem("ssoTokenObject");if(a&&"string"===typeof a){a=this.getJSONParser().parse(a);if(a.token)return a.token;throw Error("Unable to retrieve token : Invalid token Object in browser session");}},getAuthHeaderString:function(a){if(a.systemAuthMode===this.getAuthModes().SSO)a="Bearer "+a.authToken;else if(a.systemAuthMode===this.getAuthModes().NONSSO)a=
a.authorization&&-1<a.authorization.indexOf("Bearer")?a.authorization:"Basic "+a.authorization;else throw Error("Unknown auth mode "+a.systemAuthMode);return a},getAuthModes:function(){return{SSO:"SSO",NONSSO:"NON_SSO",HYBRID:"HYBRID"}},encodeNodeName:function(a){if(null===a)return null;var b,c,e;b=["?","@","&","'"];c=["?3F","?40","?26","?27"];-1!==a.indexOf(b[0])&&(a=a.replace(/\?/g,c[0]));for(e=1;e<b.length;e++)-1!==a.indexOf(b[e])&&(a=a.replace(new RegExp(b[e],"g"),c[e]));return a},convertMilliSecondsToMinutes:function(a){if(!a||
isNaN(a))throw Error("passed argument is not a number");return Math.floor(a/6E4)},addCookie:function(a,b,c,e){b=a+"="+escape(b);"number"===typeof c&&(a=new Date,a.setTime(a.getTime()+864E5*c),b+="; expires="+a.toGMTString());e&&(b+="; domain="+e);document.cookie=b+"; path=/; secure;"},getCookie:function(a){var b,c,e;if(document.cookie)for(c=document.cookie.split(";"),b=0;b<c.length;b+=1)if(e=this.trim(c[b]).split("="),e[0]===a)return unescape(e[1]);return null},getCookieEntriesThatStartsWith:function(a){var b,
c,e,d=[];if(document.cookie)for(c=document.cookie.split(";"),b=0;b<c.length;b+=1)e=this.trim(c[b]).split("="),e[0].startsWith(a)&&d.push({key:e[0],value:unescape(e[1])});return d},deleteCookie:function(a,b){this.addCookie(a,"",-1,b)},getSecondLevelDomain:function(){var a=document.location.host.split(":")[0].split("."),b=a.length;return a[b-2]+"."+a[b-1]},caseInsensitiveSort:function(a,b){var c=0;b+="";a=(a+"").toLowerCase();b=b.toLowerCase();a>b&&(c=1);a<b&&(c=-1);return c},onGadgetFirstVisible:function(a){var b,
c,e,d,f,q,g,l=!1;try{c=dojo.attr(window.frameElement,"id"),e=c.match(/\d+$/)[0],d="#finesse_gadget_"+e+"_title",dojo.query(".tab-panel",window.parent.document).some(function(a,c,e){b=dojo.query(d,a);0<b.length&&(q=a,f=dojo.attr(q,"id"),l=dojo.hasClass(q,"active"),f.slice(6))}),l?setTimeout(a):g=setInterval(dojo.hitch(this,function(){dojo.hasClass(q,"active")&&(clearInterval(g),setTimeout(a))}),250)}catch(r){}},downloadFile:function(a){var b=document.getElementById("download_iframe");b||(b=document.createElement("iframe"),
$(document.body).append(b),$(b).css("display","none"));b.src=a},bitMask:{isSet:function(a,b){return(a&b)===b},all:function(a,b){var c=b.length;"undefined"===typeof c&&(b=[b],c=1);for(;-1!==--c;)if(!this.isSet(a,b[c]))return!1;return!0},any:function(a,b){var c=b.length;"undefined"===typeof c&&(b=[b],c=1);for(;-1!==--c;)if(this.isSet(a,b[c]))return!0;return!1}},renderDojoGridOffScreen:function(a){var b=$("<div style='position: absolute; left: -5001px; width: 5000px;'></div>")[0];$(document.body).append(b);
a.placeAt(b);a.startup();document.body.removeChild(b);return a},initializeSearchInput:function(a,b,c,e,d){var f=null,p="string"===typeof a?$("#"+a):$(a),g=p.find("input"),l=p.find("a"),r=g.val(),u=function(){""===g.val()?(l.hide(),p.removeClass("input-append"),g.width(230)):(g.width(204),l.show(),p.addClass("input-append"))};g.attr("placeholder",d);g.unbind("keyup").bind("keyup",function(){r!==g.val()&&(window.clearTimeout(f),r=g.val(),f=window.setTimeout(function(){b.call(e||window,g.val());g[0].focus()},
c));u()});l.bind("click",function(){g.val("");b.call(e||window,"");u();g[0].focus()});g.val("");u()},DataTables:{createDataTable:function(a,b){var c=$('<table cellpadding="0" cellspacing="0" border="0" class="finesse"><thead><tr></tr></thead></table>'),e=c.find("tr"),d=$.extend({},{aaData:[],bPaginate:!1,bLengthChange:!1,bFilter:!1,bInfo:!1,sScrollY:"176",oLanguage:{sEmptyTable:"",sZeroRecords:""}},b),f=[];$(a.columns).each(function(a,b){e.append($("<th></th>"));f[a]={mData:b.propertyName,sTitle:b.columnHeader,
sWidth:b.width,aTargets:[a],bSortable:b.sortable,bVisible:b.visible,mRender:b.render};"function"===typeof b.renderFunction&&(f[a].mRender=function(a,c,e){var d;"function"===typeof b.render&&(a=b.render.call(a,a,a));if("string"===typeof c)switch(c){case "undefined":case "sort":d=a;break;case "set":throw Error("Unsupported set data in Finesse Grid");case "filter":case "display":case "type":d=b.renderFunction.call(e,a,e)}else throw Error("type param not specified in Finesse DataTable mData");return d})});
d.aoColumnDefs=f;"undefined"!==typeof a.bodyHeightPixels&&null!==a.bodyHeightPixels&&(d.sScrollY=a.bodyHeightPixels+"px");"undefined"!==typeof a.container&&null!==a.container&&$(a.container).append(c);c.dataTable(d);return c}},setDojoButtonDisabledAttribute:function(a,b){var c,e;a.set("disabled",b);c=$("#"+a.id+"_label");b?(c.data("finesse:dojoButton:tabIndex",c.attr("tabindex")),c.removeAttr("tabindex")):(e=c.data("finesse:dojoButton:tabIndex"),"string"===typeof e&&c.attr("tabindex",Number(e)))},
disableTabStopForDojoFirebugIframe:function(){var a=$("iframe[src*='loadFirebugConsole']");a.length&&"-1"!==a.attr("tabIndex")&&a.attr("tabIndex","-1")},measureText:function(a,b,c){b=$("<div></div>").text(a).css({fontSize:c,fontFamily:b}).addClass("offscreen").appendTo(document.body);a=b.width();b.remove();return a},adjustGadgetHeight:function(){var a=$("body").height()+20;gadgets.window.adjustHeight(a)},_json2xmlWithEscape:function(a){var b=this,c="",e,d=function(a,c){var e="",f;if(a instanceof Array)for(f=
0;f<a.length;++f)e+=d(a[f],c);else if("object"===typeof a){e+="<"+c+">";for(f in a)a.hasOwnProperty(f)&&(e+=d(a[f],f));e+="</"+c+">"}else e+="<"+c+">"+b.translateHTMLEntities(a.toString(),!0)+"</"+c+">";return e};for(e in a)a.hasOwnProperty(e)&&(c+=d(a[e],e));return c},getSanitizedUserAgentString:function(){return this.translateXMLEntities(navigator.userAgent,!0)},whenAllDone:function(){var a=[],b=$.Deferred();$.each(arguments,function(b,e){var c=$.Deferred();e.then(function(){c.resolve(!1,arguments)},
function(){c.resolve(!0,arguments)});a.push(c)});$.when.apply($,a).then(function(){var a=[],e=[];$.each(arguments,function(b,c){var d=c[1];(c[0]?a:e).push(1===d.length?d[0]:c)});return a.length?b.reject.apply(b,a):b.resolve.apply(b,e)});return b},formatString:function(a){if(!a||1>=arguments.length)return a;var b,c=a;for(b=1;b<arguments.length;b+=1)c=c.replace(new RegExp("\\{"+(b-1)+"\\}","g"),arguments[b]);return c.replace(/\\'/g,"'")},setSchemeAndPortForHttps:function(a){"https:"===window.location.protocol&&
(a.restScheme="https",a.localhostPort=a.hostPort);return a},executeAsync:function(a){var b=new Promise(function(a,b){a()});b.then(a);return b},extractHostname:function(a){a=-1<a.indexOf("//")?a.split("/")[2]:a.split("/")[0];a=a.split(":")[0];return a=a.split("?")[0]},getQueryString:function(a,b){var c=(new RegExp("[?&]"+a+"=([^&#]*)","i")).exec(b?b:window.location.href);return c?decodeURIComponent(c[1]):""},removeLogScheduleDataFromSession:function(){sessionStorage.getItem(finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA)&&
sessionStorage.removeItem(finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA)},removeScheduleLogDataForFailoverFromSession:function(){var a=JSON.parse(sessionStorage.getItem(finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA)||null);a&&a.scheduledLogArrayData&&(finesse.clientservices.ClientServices.log("Utilities.removeScheduleLogDataForFailoverFromSession(): Deleting the scheduled array data from session"),delete a.scheduledLogArrayData,sessionStorage.setItem(window.finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA,
JSON.stringify(a)))},showRetryModal:function(a){return window.finesse.Dialog.showRetryModal(a)},isAbsoluteUrl:function(a){return a?/^(http|https):\/\//i.test(a):!1}};window.finesse=window.finesse||{};window.finesse.utilities=window.finesse.utilities||{};return window.finesse.utilities.Utilities=d});h("cslogger/ClientLogger",[],function(){var g=function(){var f,d,a,b,c,e={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"},p=function(){if(null!==window.sessionStorage.getItem("clientTimestampDrift"))return parseInt(window.sessionStorage.getItem("clientTimestampDrift"),
10)},k=function(){try{if(void 0!==window.console)return!0}catch(G){}return!1},g=function(a){return 10>a?"0"+a:a},m=function(a){return 10>a?"00"+a:100>a?"0"+a:a},l=function(a,b){var c,e;0>a?(c=-a,e="-"):(c=a,e="+");return":"===b?e+g((c/60).toString().split(".")[0])+b+g(c%60):e+g((c/60).toString().split(".")[0])+g(c%60)},r=function(a,b,c){var d;if(null===a)return"--- -- ---- --:--:--.--- -----";if(void 0===b||void 0===c)return k()&&window.console.log("drift or serverOffset must be a number"),"--- -- ---- --:--:--.--- -----";
d=(new Date).getTimezoneOffset();a=new Date(a+b+6E4*(d+c));b=a.getMonth();var f;try{f=e[b]}catch(F){k()&&window.console.log("Month must be between 0 and 11")}return f+" "+g(a.getDate())+" "+a.getFullYear().toString()+" "+g(a.getHours())+":"+g(a.getMinutes())+":"+g(a.getSeconds())+"."+m(a.getMilliseconds())+" "+l(c,"")},u=function(a,e){var d,f,q;b||(b="true"===window.sessionStorage.getItem("enableLocalLog")?" "+window.sessionStorage.getItem("finSessKey"):" ");f=b;d=new Date;var B;q=null===d?new Date:
d;B=-1*q.getTimezoneOffset();q=q.getFullYear().toString()+"-"+g(q.getMonth()+1)+"-"+g(q.getDate())+"T"+g(q.getHours())+":"+g(q.getMinutes())+":"+g(q.getSeconds())+"."+m(q.getMilliseconds())+" "+l(B,":");if(void 0!==p()){d=d.getTime();B=p();var u;u=null!==window.sessionStorage.getItem("serverTimezoneOffset")?parseInt(window.sessionStorage.getItem("serverTimezoneOffset"),10):void 0;d=r(d,B,u)}else d=r(null,0,0);f=q+":"+f+": "+c+": "+d+": "+a;k()&&(e?window.console.error(f,e):window.console.log(f));
return f};return{log:function(b,c){f&&f.publish(d,u(a+b,c))},_fakeConstuctor:function(){},init:function(b,e,k){f=b;d="finesse.clientLogging."+e;a=e+" : ";c=void 0===k||"undefined"===k?finesse.container&&finesse.container.Config&&finesse.container.Config.host?finesse.container.Config.host:"?.?.?.?":k&&k.host?k.host:"?.?.?.?"}}}();window.finesse=window.finesse||{};window.finesse.cslogger=window.finesse.cslogger||{};window.finesse.cslogger.ClientLogger=g;finesse=finesse||{};finesse.cslogger=finesse.cslogger||
{};return g});h("clientservices/MasterTunnel",["utilities/Utilities","cslogger/ClientLogger"],function(g,f){var d=function(a,b){if("string"!==typeof a||0===a.length)throw Error("Required host parameter missing.");var c=!1,e,d,k=!1,q,m,l,r,u,h,B,t,D,z,F,n,w,A={subscribe:{},unsubscribe:{}},y=function(a,b){g.sendMessage(a+"|"+b,q,e)},H=function(a){if("string"===typeof a.data){var b=a.data.indexOf("|"),e=Number(a.data.substr(0,b));a=a.data.substr(b+1);switch(e){case 0:h=a;"function"===typeof m&&m(a);
break;case 4:u=a;if("loaded"===a){c=!0;F&&y(3,F);var d=JSON.stringify({xmppRequestTimeout:finesse.container.Config.xmppRequestTimeout,xmppFailoverDetectionPingInterval:finesse.container.Config.xmppFailoverDetectionPingInterval,xmppFailoverRequestMaxRetry:finesse.container.Config.xmppFailoverRequestMaxRetry});y(12,w);y(1,B);y(5,t);y(2,D);y(6,z);y(15,d)}else"function"===typeof r&&r({status:u,resourceID:n});break;case 3:n=a;break;case 7:var v=a.split("|"),k=v[0];v.length&&(d=v[1]);A.subscribe[k]&&(A.subscribe[k](d),
delete A.subscribe[k]);break;case 8:d=a.split("|");k=d[0];d.length&&(v=d[1]);A.unsubscribe[k]&&(A.unsubscribe[k](v),delete A.unsubscribe[k]);break;case 14:d=a.split("|");v=d[0];d.length&&(k=d[1]);A.subscriptions&&(A.subscriptions(v,k),delete A.subscriptions);break;case 9:"function"===typeof l&&l(a);break;case 13:f.log(a)}}};this.makeConnectReq=function(){y(2,D)};this.getHost=function(){return a};this.getResourceID=function(){return n};this.isTunnelLoaded=function(){return c};this.getTunnelURL=function(){return d};
this.subscribe=function(a,b){if(b&&"function"!==typeof b)throw Error("Parameter is not a function.");A.subscribe[a]=b;y(7,a)};this.getSubscriptions=function(a){if(a&&"function"!==typeof a)throw Error("Parameter is not a function.");A.subscriptions=a;y(14)};this.unsubscribe=function(a,b){if(b&&"function"!==typeof b)throw Error("Parameter is not a function.");A.unsubscribe[a]=b;y(8,a)};this.registerEventHandler=function(a){if("function"!==typeof a)throw Error("Parameter is not a function.");m=a;h&&
a(h)};this.unregisterEventHandler=function(){m=void 0};this.registerPresenceHandler=function(a){if("function"!==typeof a)throw Error("Parameter is not a function.");l=a};this.unregisterPresenceHandler=function(){l=void 0};this.registerConnectionInfoHandler=function(a){if("function"!==typeof a)throw Error("Parameter is not a function.");r=a;u&&a({status:u,resourceID:n})};this.unregisterConnectionInfoHandler=function(){r=void 0};this.init=function(a,b,c,f,A,p){if("string"!==typeof a||"string"!==typeof b||
"string"!==typeof c||"string"!==typeof f||"string"!==typeof p)throw Error("Invalid or missing required parameters.");!0!==k&&(e=window.location.origin,d=e+"/tunnel/",k=!0);B=a;D=b;t=c;z=f;F=A;w=p;g.receiveMessage(H,e);a=self===parent?"tunnel-frame":"autopilot-tunnel-frame";b=document.createElement("iframe");b.style.display="none";b.setAttribute("id",a);b.setAttribute("name",a);b.setAttribute("src",d);document.body.appendChild(b);q=window.frames[a]}};finesse.clientservices=finesse.clientservices||
{};window.finesse=window.finesse||{};window.finesse.clientservices=window.finesse.clientservices||{};return window.finesse.clientservices.MasterTunnel=d});h("clientservices/Topics",[],function(){var g=function(){this.namespace="finesse.info";var f=function(d){return this.namespace+"."+d};return{REQUESTS:f("requests"),RESPONSES:f("responses"),EVENTS_CONNECTION_INFO:f("connection"),PRESENCE:f("presence"),ACCESS_TOKEN_REFRESHED_EVENT:f("accessTokenRefresh"),getTopic:function(d){0===d.indexOf("/")&&(d=
d.substr(1));return d.replace(/\//g,".")}}}();window.finesse=window.finesse||{};window.finesse.clientservices=window.finesse.clientservices||{};return window.finesse.clientservices.Topics=g});h("clientservices/MasterPublisher",["clientservices/MasterTunnel","clientservices/Topics","utilities/Utilities"],function(g,f,d){var a=function(a,c){if(!(a instanceof g))throw Error("Required tunnel object missing or invalid.");var b=c,p={log:finesse.clientservices.ClientServices.log},k=a,q={},m={CONNECTIONINFO:"ConnectionInfoReq",
SUBSCRIBE:"SubscribeNodeReq",UNSUBSCRIBE:"UnsubscribeNodeReq",SUBSCRIPTIONSINFO:"SubscriptionsInfoReq",CONNECT:"ConnectionReq"},l={},r=function(a){var c,e,w=!1;try{c=a.indexOf("{"),e=a.lastIndexOf("}"),-1!==c&&e===a.length-1&&(w=!0)}catch(I){p.log("MasterPublisher._isJsonPayload() - Caught error: "+I)}if(w){var k,g,q=a.indexOf("{"),l,m,r=a;try{if(0<q)l=decodeURI(a.substr(0,q)),r=a.substr(q),k=f.getTopic(l);else throw p.log("MasterPublisher._parseAndPublishJSONEvent() - [ERROR] node is not given in postMessage: "+
r),Error("node is not given in postMessage: "+r);m=d.getJSONParser();g=m.parse(r)}catch(I){throw p.log("MasterPublisher._parseAndPublishJSONEvent() - [ERROR] Malformed event payload: "+I),Error("Malformed event payload : "+I);}p.log("MasterPublisher._parseAndPublishJSONEvent() - Received JSON event on node '"+l+"': "+r);a={content:a,object:g};k&&g&&b.publish(k,a)}else{g=a.indexOf("<");var B;k=a;try{if(0<g)B=decodeURI(a.substr(0,g)),k=a.substr(g),q=f.getTopic(B);else throw p.log("MasterPublisher._parseAndPublishXMLEvent() - [ERROR] node is not given in postMessage: "+
k),Error("node is not given in postMessage: "+k);r=d.xml2JsObj(k)}catch(I){throw p.log("MasterPublisher._parseAndPublishXMLEvent() - [ERROR] Malformed event payload: "+I),Error("Malformed event payload : "+I);}p.log("MasterPublisher._parseAndPublishXMLEvent() - Received XML event on node '"+B+"': "+k);a={content:a,object:r};q&&r&&(-1<q.indexOf("User.")&&r.Update&&r.Update.data&&r.Update.data.user&&(k=k.substring(k.indexOf("<user>"),k.indexOf("</user>")+7).replace("<user>","<User>").replace("</user>",
"</User>"),sessionStorage.setItem("User",k)),b.publish(q,a))}},u=function(a){var c=d.xml2JsObj(a);a={content:a,object:c};c&&b.publish(f.PRESENCE,a)},h=function(){return q?{status:q.status,resourceID:q.resourceID}:null},B=function(){var a,c,e={error:{errorType:"Disconnected",errorMessage:"Outstanding request will never complete."}};for(a in l)if(l.hasOwnProperty(a)){for(c in l[a].subscribing.reqIds)l[a].subscribing.reqIds.hasOwnProperty(c)&&b.publish(f.RESPONSES+"."+c,e);for(c in l[a].unsubscribing.reqIds)l[a].unsubscribing.reqIds.hasOwnProperty(c)&&
b.publish(f.RESPONSES+"."+c,e)}},t=function(a){var c=q.status;q=a;p.log("MasterPublisher._connInfoHandler() - Connection status: "+a.status);b.publish(f.EVENTS_CONNECTION_INFO,h());"connected"===c&&"connected"!==a.status&&B()},D=function(a){k.getSubscriptions(function(c){b.publish(f.RESPONSES+"."+a,c)})},z=function(a,c){"connected"!==q.status?b.publish(f.RESPONSES+"."+c,{error:{errorType:"Not connected",errorMessage:"Cannot subscribe without connection."}}):(l[a]||(l[a]={subscribing:{reqIds:{},length:0},
active:{reqIds:{},length:0},unsubscribing:{reqIds:{},length:0},holding:{reqIds:{},length:0}}),0===l[a].active.length?0===l[a].unsubscribing.length?0===l[a].subscribing.length?(l[a].subscribing.reqIds[c]=!0,l[a].subscribing.length+=1,p.log("MasterPublisher._subscribeNode() - Attempting to subscribe to node '"+a+"'"),k.subscribe(a,function(c){var e,k;if(c){e={subscribe:{content:c}};try{e.subscribe.object=gadgets.json.parse(d.xml2json(jQuery.parseXML(c),""))}catch(E){e.error={errorType:"parseError",
errorMessage:"Could not serialize XML: "+E}}p.log("MasterPublisher._subscribeNode() - Error subscribing to node '"+a+"': "+c)}else p.log("MasterPublisher._subscribeNode() - Subscribed to node '"+a+"'");for(k in l[a].subscribing.reqIds)l[a].subscribing.reqIds.hasOwnProperty(k)&&(b.publish(f.RESPONSES+"."+k,e),c||(l[a].active.reqIds[k]=!0,l[a].active.length+=1),delete l[a].subscribing.reqIds[k],--l[a].subscribing.length)})):(l[a].subscribing.reqIds[c]=!0,l[a].subscribing.length+=1):(l[a].holding.reqIds[c]=
!0,l[a].holding.length+=1):(l[a].active.reqIds[c]=!0,l[a].active.length+=1,b.publish(f.RESPONSES+"."+c,void 0)))},F=function(a,c,e){l[a]||e?"connected"!==q.status?b.publish(f.RESPONSES+"."+c,{error:{errorType:"Not connected",errorMessage:"Cannot unsubscribe without connection."}}):l[a]&&1<l[a].active.length?(delete l[a].active.reqIds[c],b.publish(f.RESPONSES+"."+c,void 0),--l[a].active.length):l[a]&&1===l[a].active.length||e?(l[a]&&(l[a].unsubscribing.reqIds[c]=!0,l[a].unsubscribing.length+=1,delete l[a].active.reqIds[c],
--l[a].active.length),p.log("MasterPublisher._unsubscribeNode() - Attempting to unsubscribe from node '"+a+"'"),k.unsubscribe(a,function(e){var k,w;if(e){k={subscribe:{content:e}};try{k.subscribe.object=gadgets.json.parse(d.xml2json(jQuery.parseXML(e),""))}catch(K){k.error={errorType:"parseError",errorMessage:"Could not serialize XML: "+K}}p.log("MasterPublisher._unsubscribeNode() - Error unsubscribing from node '"+a+"': "+e)}else p.log("MasterPublisher._unsubscribeNode() - Unsubscribed from node '"+
a+"'");if(l[a]){for(w in l[a].unsubscribing.reqIds)l[a].unsubscribing.reqIds.hasOwnProperty(w)&&(b.publish(f.RESPONSES+"."+w,k),delete l[a].unsubscribing.reqIds[w],--l[a].unsubscribing.length);if(!e&&0<l[a].holding.length)for(w in l[a].holding.reqIds)l[a].holding.reqIds.hasOwnProperty(w)&&(delete l[a].holding.reqIds[w],--l[a].holding.length,z(a,w))}else b.publish(f.RESPONSES+"."+c,void 0)})):b.publish(f.RESPONSES+"."+c,void 0):b.publish(f.RESPONSES+"."+c,void 0)},n=function(a,c){var e;if("object"===
typeof c&&"string"===typeof c.type&&"object"===typeof c.data)switch(c.type){case m.CONNECTIONINFO:if(e=h())void 0!==c.invokeID&&(e.invokeID=c.invokeID),b.publish(f.EVENTS_CONNECTION_INFO,e);break;case m.SUBSCRIBE:"string"===typeof c.data.node&&z(c.data.node,c.invokeID);break;case m.UNSUBSCRIBE:"string"===typeof c.data.node&&F(c.data.node,c.invokeID,c.isForceOp);break;case m.SUBSCRIPTIONSINFO:D(c.invokeID);break;case m.CONNECT:p.log("MasterPublisher._clientRequestHandler(): F403: Access denied. Non-master ClientService instances do not have the clearance level to make this request: makeConnectionReq")}};
k.registerEventHandler(r);k.registerPresenceHandler(u);k.registerConnectionInfoHandler(t);b.subscribe(f.REQUESTS,n);this.connect=function(a,b,c){k.makeConnectReq(a,b,c)};this.wipeout=function(){B();l={}};this.beginTestSection=0;this.getTestObject=function(){var a=new MockControl;b=a.createMock(gadgets.Hub);k=a.createMock();return{mock:a,hub:b,tunnel:k,setTunnel:function(a){k=a},getTunnel:function(){return k},reqtypes:m,eventHandler:r,presenceHandler:u,subscribeNode:z,unsubscribeNode:F,getNodeList:function(){return l},
setNodeList:function(a){l=a},cloneConnInfoObj:h,connInfoHandler:t,clientRequestHandler:n}};this.endTestSection=0};window.finesse=window.finesse||{};window.finesse.clientservices=window.finesse.clientservices||{};return window.finesse.clientservices.MasterPublisher=a});h("clientservices/ClientServices",["clientservices/MasterTunnel","clientservices/MasterPublisher","clientservices/Topics","utilities/Utilities"],function(g,f,d,a){var b=function(){var b,e,p,k,q={},m,l,r=!1,u=!1,h={},B,t=!1,D,z,n,C,w,
A,y,H=[],v=function(a,b){try{q.log&&q.log("[ClientServices] "+a,b)}catch(O){}},E=function(a){if(void 0===y||y.status!==a.status)switch(y=a,a.status){case "connecting":r&&D&&D();break;case "connected":!r&&t||!z||z();break;case "disconnected":r&&C&&C();break;case "conflict":r&&C&&C("conflict");break;case "unauthorized":r&&C&&C("unauthorized");break;case "disconnecting":r&&n&&n();break;case "reconnecting":r&&w&&w();break;case "unloading":r&&A&&A();break;case "failing":r||(t=!0,C&&C());break;case "recovered":for(r||
(t=!1,z&&z()),e&&e.wipeout(),a=H.length-1;0<=a;--a)try{v("Refreshing "+H[a].getRestUrl()),H[a].refresh(10)}catch(I){v("ClientServices._refreshObjects() unexpected error while refreshing object"+I)}}},K=function(){if(!u)throw Error("ClientServices needs to be inited.");},J=function(a,b){if("function"===typeof b)switch(y&&y.status===a&&b(),a){case "connecting":D=b;break;case "connected":z=b;break;case "disconnected":C=b;break;case "disconnecting":n=b;break;case "reconnecting":w=b;break;case "unloading":A=
b}else throw Error("Callback is not a function");},M=function(a,b){v("Access token refreshed - topic :"+a+", authToken :"+b.authToken);b.authToken&&(l.authToken=b.authToken,finesse.gadget&&finesse.gadget.Config&&(finesse.gadget.Config.authToken=b.authToken))},N=function(){var a;try{a=window.parent.finesse}catch(I){a=void 0}a?l.systemAuthMode=a.container.Config.systemAuthMode:new finesse.restservices.SystemInfo({id:l.id,onLoad:function(a){l.systemAuthMode=a.getSystemAuthMode()},onError:function(a){throw Error("Unable to retrieve systemAuthMode from config. Initialization failed......");
}})};return{addToRefreshList:function(a){H.push(a)},getNotificationConnectionState:function(){return y&&y.status},removeFromRefreshList:function(a){var b;for(b=H.length-1;0<=b;--b)if(H[b]===a){H.splice(b,1);break}},getTunnelURL:function(){return b.getTunnelURL()},isTunnelLoaded:function(){return b.isTunnelLoaded()},isMaster:function(){return r},getResourceID:function(){return void 0!==y?y.resourceID:null},registerOnConnectingHandler:function(a){J("connecting",a)},unregisterOnConnectingHandler:function(){D=
void 0},registerOnConnectHandler:function(a){J("connected",a)},unregisterOnConnectHandler:function(){z=void 0},registerOnDisconnectHandler:function(a){J("disconnected",a)},unregisterOnDisconnectHandler:function(){C=void 0},registerOnDisconnectingHandler:function(a){J("disconnecting",a)},unregisterOnDisconnectingHandler:function(){n=void 0},registerOnReconnectingHandler:function(a){J("reconnecting",a)},unregisterOnReconnectingHandler:function(){w=void 0},registerOnUnloadingHandler:function(a){J("unloading",
a)},unregisterOnUnloadingHandler:function(){A=void 0},makeRequest:function(a,b,c){K();c=c||{};c[gadgets.io.RequestParameters.REFRESH_INTERVAL]=c[gadgets.io.RequestParameters.REFRESH_INTERVAL]||0;c[gadgets.io.RequestParameters.HEADERS]=c[gadgets.io.RequestParameters.HEADERS]||{};c[gadgets.io.RequestParameters.HEADERS].Authorization=p.getAuthHeaderString(l);c[gadgets.io.RequestParameters.HEADERS].locale=l.locale;if(p.isAbsoluteUrl(a))v("makeRequest to absolute url: "+a),gadgets.io.makeRequest(a,b,c);
else{v("makeRequest to relative url: "+a);var e="http://localhost:8082",d=finesse.container.Config,f=window.location.hostname;finesse.vars&&finesse.vars.isCfAdminGadget&&d.restHost&&d.restHost.toLocaleLowerCase()!==f&&(v("makeRequest to relative url. hostname("+f+") and restHost("+d.restHost+") are different"),e=d.scheme+"://"+d.restHost+":"+d.hostPort);gadgets.io.makeRequest(e+(a.startsWith("/")?a:"/"+a),b,c)}},subscribe:function(a,b,c,e){K();e=a+(void 0===e?"":e);return h[e]?!1:(h[e]=k.subscribe(a,
function(a,e){c&&!r&&t||b(e)}),!0)},unsubscribe:function(a,b){K();a+=void 0===b?"":b;h[a]&&(k.unsubscribe(h[a]),delete h[a])},subscribeNode:function(a,b){if(b&&"function"!==typeof b)throw Error("ClientServices.subscribeNode: handler is not a function");var c={type:"SubscribeNodeReq",data:{node:a},invokeID:p.generateUUID()},e=m.RESPONSES+"."+c.invokeID,d=this;this.subscribe(e,function(a){d.unsubscribe(e);b&&b(c.invokeID,a)});k.publish(m.REQUESTS,c)},unsubscribeNode:function(a,b,c){if(c&&"function"!==
typeof c)throw Error("ClientServices.unsubscribeNode: handler is not a function");a={type:"UnsubscribeNodeReq",data:{node:a,subid:b},isForceOp:"undefined"!=typeof c.isForceOp?c.isForceOp:!1,invokeID:p.generateUUID()};var e=m.RESPONSES+"."+a.invokeID,d=this;this.subscribe(e,function(a){d.unsubscribe(e);c&&c(a)});k.publish(m.REQUESTS,a)},getNodeSubscriptions:function(a){if(a&&"function"!==typeof a)throw Error("ClientServices.getNodeSubscriptions: handler is not a function");var b={type:"SubscriptionsInfoReq",
data:{},invokeID:p.generateUUID()},c=m.RESPONSES+"."+b.invokeID,e=this;this.subscribe(c,function(b){e.unsubscribe(c);a&&a(JSON.parse(b))});k.publish(m.REQUESTS,b)},makeConnectionReq:function(){r&&e?e.connect(l.id,l.password,l.xmppDomain):v("F403: Access denied. Non-master ClientService instances do not have the clearance level to make this request: makeConnectionReq")},setLogger:function(a){q=a&&"object"===typeof a&&"function"===typeof a.log?a:{}},log:v,_fakeConstuctor:function(){},init:function(b){if(!u){if(!("object"===
typeof b&&"string"===typeof b.host&&0<b.host.length&&b.restHost)||"string"!==typeof b.authorization&&"string"!==typeof b.id)throw Error("Config object contains invalid properties.");l=b;p=a;B=p.getAuthModes();m=d;k=b.hub||gadgets.Hub;l.authorization?(b=p.getCredentials(l.authorization),l.id=b.id,l.password=b.password):l.authorization=p.b64Encode(l.id+":"+l.password);l.systemAuthMode&&""!==l.systemAuthMode||N();if(l.systemAuthMode===B.SSO){M(void 0,{authToken:p.getToken()});if(!l.authToken)throw Error("ClientServices.init() - Access token is unavailable inside Config object.");
k&&k.subscribe(m.ACCESS_TOKEN_REFRESHED_EVENT,M)}u=!0;k&&(this.subscribe(m.EVENTS_CONNECTION_INFO,E),b={type:"ConnectionInfoReq",data:{},invokeID:(new Date).getTime()},k.publish(m.REQUESTS,b))}return this},initBosh:function(c){if("object"!==typeof c||"string"!==typeof c.xmppDomain||"string"!==typeof c.pubsubDomain)throw Error("Config object contains invalid properties.");l.xmppDomain=c.xmppDomain;l.pubsubDomain=c.pubsubDomain;l.resource=c.resource;var d;b=new g(l.host,l.scheme);e=new f(b,k);c=B.SSO===
l.systemAuthMode?l.authToken:l.password;p=a;d=p.encodeNodeName(l.id);b.init(d,c,l.xmppDomain,l.pubsubDomain,l.resource,l.notificationConnectionType);r=!0},setFailoverMode:function(a){r&&k.publish(m.EVENTS_CONNECTION_INFO,{status:a?"failing":"recovered"})},getRestHost:function(){return l&&l.restHost||"localhost"},_getTestObj:function(){return{setPublisher:function(a){e=a}}}}}();window.finesse=window.finesse||{};window.finesse.clientservices=window.finesse.clientservices||{};return window.finesse.clientservices.ClientServices=
b});h("restservices/Notifier",["FinesseBase","clientservices/ClientServices"],function(g,f){var d=g.extend({init:function(){this._super();this._listenerCallback=[]},addListener:function(a,b){var c=this._listenerCallback.length,e,d,f=!0;for(e=0;e<c;e+=1)if(d=this._listenerCallback[e].callback,d===a){f=!1;break}f&&this._listenerCallback.push({callback:this._isAFunction(a),scope:b||window})},removeListener:function(a){var b=!1,c,e;for(c=this._listenerCallback.length-1;0<=c;--c)if(e=this._listenerCallback[c].callback,
e===a){this._listenerCallback[c]=void 0;this._listenerCallback.splice(c,1);b=!0;break}return b},reset:function(){this._listenerCallback=[]},notifyListeners:function(a){var b=this._listenerCallback.length,c,e,d;for(c=0;c<b;c+=1)try{e=this._listenerCallback[c].callback,d=this._listenerCallback[c].scope,"function"===typeof e&&e.call(d,a)}catch(k){f.log("Notifier.js#notifyListeners: Exception caught: ",k)}},getListeners:function(){var a=[],b=this._listenerCallback.length,c;for(c=0;c<b;c+=1)a.push(this._listenerCallback[c].callback);
return a},_isAFunction:function(a){if(void 0===a||"function"===typeof a)return a;throw Error("handler must be a function");}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};window.finesse.restservices.Notifier=d;finesse.restservices=finesse.restservices||{};return d});h("utilities/SessionStorageCachingService",[],function(){var g=function(){return{SESSION_STORAGE_CACHED_LIST:["User"],setItem:function(f,d){sessionStorage.setItem(f,d)},getItem:function(f){return sessionStorage.getItem(f)},
removeItem:function(f){sessionStorage.removeItem(f)},isCacheable:function(f){return-1<this.SESSION_STORAGE_CACHED_LIST.indexOf(f)},clearCache:function(){var f=this;this.SESSION_STORAGE_CACHED_LIST.forEach(function(d){f.removeItem(d)})}}}();window.finesse=window.finesse||{};return window.finesse.SessionStorageCachingService=g});h("utilities/RestCachingService",[],function(){var g=function(){return{CACHED_REST_LIST_FOR_FAILOVER:"WrapUpReasons Media Workflows Team PhoneBooks MediaPropertiesLayouts ECCVariableConfig ReasonCodes WrapUpReasons".split(" "),
REST_TO_BE_SERVRED_FROM_CACHE:["WrapUpReasons","ReasonCodes"],getRestNameForRequestFromCache:function(f,d){var a=this.getFailoverCacheableRestList();if(a&&-1<a.indexOf(f))return f},getFailoverCacheableRestList:function(){return this.CACHED_REST_LIST_FOR_FAILOVER},getCacheableRestList:function(){return this.REST_TO_BE_SERVRED_FROM_CACHE},isRestCacheServiceReachable:function(){return finesse.idb&&finesse.idb.RestCacheDataContainer&&finesse.idb.RestCacheDataContainer.isReachable()},isCacheableForFailover:function(f){return"Team"!==
f||top.window.finesse.container.PageServices&&!top.window.finesse.container.PageServices.getUser().hasSupervisorRole()?-1<this.CACHED_REST_LIST_FOR_FAILOVER.indexOf(f):!1},isCacheable:function(f){return-1<this.REST_TO_BE_SERVRED_FROM_CACHE.indexOf(f)}}}();window.finesse=window.finesse||{};return window.finesse.RestCachingService=g});h("restservices/RestBase","FinesseBase utilities/Utilities restservices/Notifier clientservices/ClientServices clientservices/Topics utilities/SessionStorageCachingService utilities/RestCachingService".split(" "),
function(g,f,d,a,b,c,e){var p=g.extend({doNotLog:!1,_pendingCallbacks:{},getRestClass:function(){throw Error("getRestClass(): Not implemented in subtype.");},getRestType:function(){throw Error("getRestType(): Not implemented in subtype.");},getXMPPNodePath:function(){return this.getRestUrl()},supportsRequests:!0,supportsSubscriptions:!0,keepRestResponse:!1,restResponseStatus:null,extraHeaders:null,explicitSubscription:!1,autoSubscribe:!0,contextId:"",ajaxRequestTimeout:5E3,_logger:{log:a.log,error:a.log},
init:function(a,b,c){var k=this;this._super();"object"===typeof a?(this._id=a.id,this._restObj=a.parentObj,this.autoSubscribe=!1===a.autoSubscribe?!1:!0,this.contextId=a.contextId?a.contextId:this.contextId,this.ajaxRequestTimeout=a.timeout||this.ajaxRequestTimeout,this.doNotSubscribe=a.doNotSubscribe,this.doNotRefresh=this.doNotRefresh||a.doNotRefresh,"undefined"!=typeof a.supportsRequests&&(this.supportsRequests=a.supportsRequests),b={onLoad:a.onLoad,onChange:a.onChange,onAdd:a.onAdd,onDelete:a.onDelete,
onError:a.onError,onNotify:a.onNotify}):(this._id=a,this._restObj=c);this._data={};this._restResponse=void 0;this._lastUpdate={};this._util=f;this._rcs=e;this._config=finesse.container.Config;this._changeNotifier=new d;this._loadNotifier=new d;this._addNotifier=new d;this._deleteNotifier=new d;this._errorNotifier=new d;this._emptyUpdateNotifier=new d;this._loaded=!1;b=b||{};this.addHandler("load",b.onLoad);this.addHandler("change",b.onChange);this.addHandler("add",b.onAdd);this.addHandler("delete",
b.onDelete);this.addHandler("error",b.onError);this.addHandler("notify",b.onNotify);try{this.getRestType(),this.supportsSubscriptions&&this.autoSubscribe&&!this.doNotSubscribe?this.subscribe({success:function(){"object"===typeof a&&a.data?k._processObject(k._normalize(a.data))||k._errorNotifier.notifyListeners(k):k.supportsRequests&&k._synchronize()},error:function(a){k._errorNotifier.notifyListeners(a)}}):"object"===typeof a&&a.data?this._processObject(this._normalize(a.data))||this._errorNotifier.notifyListeners(this):
this.supportsRequests&&this._synchronize()}catch(r){this._logger.error("id="+this._id+": "+r)}},hasProperty:function(a,b){return null!==a&&a.hasOwnProperty(b)},getProperty:function(a,b){return!1===this.hasProperty(a,b)?null:a[b]},_extractId:function(a){var b,c="";for(b in a)if(a.hasOwnProperty(b)){c=a[b].uri;break}return f.getId(c)},getData:function(){return this._data},getRestResponse:function(){return this._restResponse},getBaseRestUrl:function(){return"/finesse/api"},getRestResponseStatus:function(){return this.restResponseStatus},
getRestUrl:function(){var a=this._restObj,b="",b=a instanceof p?b+a.getRestUrl():b+this.getBaseRestUrl(),b=b+("/"+this.getRestType());this._id&&(b+="/"+this._id);return b},getRestUrlAdditionalParameters:function(){return""},getId:function(){return this._id},_synchronize:function(a){if("string"===typeof this._id){var e=this,d=this._loaded,f,k=this.getRestUrl(),g=this.getRestType(),p=b.getTopic(k),B="true"===this._config.failoverReload?e._rcs.isCacheableForFailover.bind(e._rcs):e._rcs.isCacheable.bind(e._rcs);
e._rcs.isRestCacheServiceReachable()&&B(g)?(g={key:p,onsuccess:function(b){if(b&&b.data&&b.data.text)e._logger.log("Rest Caching: Rest data successfully fetched from cache : "+e.getRestType()),sessionStorage.setItem("restCacheUsed","true"),b=b.data,b.object=e._util.xml2js(b.text),b.status=b.rc,e._processSuccessObject(e,b,d,a);else return e._logger.log("Rest Caching: Rest data not available in the cache, making rest call : "+e.getRestType()),e._makeRestRequest(e,d,a)},onerror:function(b){e._logger.log("Rest Caching: Error while fetching rest object from cache. Making rest call",
k,b);return e._makeRestRequest(e,d,a)}},e._logger.log("Rest Caching: Check if rest data is available in the cache for : "+p),finesse.idb.RestCacheDataContainer.fetchData(g)):c.isCacheable(this.getRestType())&&c.getItem(this.getRestType())?(f={},f.object=e._util.xml2js(c.getItem(this.getRestType())),e._logger.log("Rest Caching: Object is created from cached data for : "+p),setTimeout(function(){e._processSuccessObject(e,f,d,a)},0)):this._makeRestRequest(e,d,a)}else throw Error("Can't construct a <"+
this.getRestType()+"> due to invalid id type.");},_makeRestRequest:function(a,b,c){return this._doGET({success:function(e){a._processSuccessObject(a,e,b,c)},error:function(b){0<c?setTimeout(function(){a._synchronize(c-1)},_RETRY_INTERVAL):a._errorNotifier.notifyListeners(b)}})},addHandler:function(a,b,c){var e=null;try{f.validateHandler(b),e=this._getNotifierReference(a),e.addListener(b,c),"load"===a&&this._loaded&&b.call(c||window,this)}catch(r){this._logger.error("id="+this._id+": "+r)}},removeHandler:function(a,
b){var c=null;try{f.validateHandler(b),c=this._getNotifierReference(a),"undefined"===typeof b?c.reset():(finesse.utilities.Utilities.validateHandler(b),c.removeListener(b))}catch(l){this._logger.error("id="+this._id+": "+l)}},isLoaded:function(){if(!this._loaded)throw Error("Cannot operate on object that is not fully instantiated, use onLoad/onLoadError handlers");return this},refresh:function(a){var b=this;if(this.explicitSubscription)this._subscribeNode({success:function(){if(!b.supportsRequests)throw Error("Object doesn't support request operations.");
b._synchronize(a);return this},error:function(a){b._errorNotifier.notifyListeners(a)}});else{if(!this.supportsRequests)throw Error("Object doesn't support request operations.");return this._synchronize(a)}},_validate:function(a){(a="object"===typeof a&&this.hasProperty(a,this.getRestType()))||this._logger.error(this.getRestType()+" failed validation! Does your JS REST class return the correct string from getRestType()?");return a},_shouldAllowBypassServerCache:function(){return window.finesse.restservices.bypassServerCache},
_doGET:function(a){return this.restRequest(this.getRestUrl(),a)},_updateEventHandler:function(a,b){if(a._processUpdate(b))switch(b.object.Update.event){case "POST":a._addNotifier.notifyListeners(a);break;case "PUT":a._changeNotifier.notifyListeners(a);break;case "DELETE":a._deleteNotifier.notifyListeners(a)}},_createPubsubCallback:function(){var a=this;return function(b){a._updateEventHandler(a,b)}},subscribe:function(c){var e=this,d=b.getTopic(this.getXMPPNodePath()),f,k=a.subscribe(d,this._createPubsubCallback(),
!0,this.contextId);c=c||{};f={success:function(){e.doNotRefresh||a.addToRefreshList(e);"function"===typeof c.success&&c.success()},error:function(b){k&&a.unsubscribe(d,this.contextId);"function"===typeof c.error&&c.error(b)}};!0===this.explicitSubscription?this._subscribeNode(f):k?(this._subid="OpenAjaxOnly",f.success()):f.error();return this},unsubscribe:function(c){var e=b.getTopic(this.getRestUrl()),d;a.removeFromRefreshList(this);c=c||{};d={success:function(){"function"===typeof c.success&&c.success()},
error:function(a){"function"===typeof c.error&&c.error(a)}};this._subid?(a.unsubscribe(e,this.contextId),!0===this.explicitSubscription?this._unsubscribeNode(d):(this._subid=void 0,d.success())):d.success();return this},_subscribeNode:function(b){var c=this;b=b||{};a.subscribeNode(this.getXMPPNodePath(),function(a,e){e?"function"===typeof b.error&&b.error(e):(c._subid=a,"function"===typeof b.success&&b.success())})},_unsubscribeNode:function(b){var c=this;b=b||{};a.unsubscribeNode(this.getXMPPNodePath(),
this._subid,function(a){c._subid=void 0;a?"function"===typeof b.error&&b.error(a):"function"===typeof b.success&&b.success()})},_processObject:function(a){return this._validate(a)?(this._data=this.getProperty(a,this.getRestType()),this._loaded||(this._loaded=!0,this._loadNotifier.notifyListeners(this)),!0):!1},_processSuccessObject:function(a,b,c,e){a._processResponse(b)?c&&a._changeNotifier.notifyListeners(a):0<e?setTimeout(function(){a._synchronize(e-1)},_RETRY_INTERVAL):a._errorNotifier.notifyListeners(a)},
_normalize:function(a){var b=this.getRestType(),c=b.charAt(0).toLowerCase()+b.slice(1);!this.hasProperty(a,b)&&this.hasProperty(a,c)&&(a=jQuery.extend(!0,{},a),a[b]=a[c],delete a[c]);return a},_processResponse:function(a){try{return this.keepRestResponse&&(this._restResponse=a.content,this.restResponseStatus=a.status),this._processObject(a.object)}catch(q){this._logger.error(this.getRestType()+": "+q)}return!1},_postProcessUpdateStrategy:function(a){delete this._pendingCallbacks[a]},_processUpdate:function(a){try{var b,
c,e,d;b=this._normalize(a.object.Update.data);this._lastUpdate=a.object;if((c=this._lastUpdate.Update?this._lastUpdate.Update.requestId:void 0)&&this._pendingCallbacks[c]){e={};e.content=this._util.json2xml(gadgets.json.parse(gadgets.json.stringify(a)));e.object={};b.apiErrors&&b.apiErrors.apiError?(d=b.apiErrors.apiError,e.object.ApiErrors={},e.object.ApiErrors.ApiError={},e.object.ApiErrors.ApiError.ErrorData=d.errorData||void 0,e.object.ApiErrors.ApiError.ErrorMessage=d.errorMessage||void 0,e.object.ApiErrors.ApiError.ErrorType=
d.errorType||void 0,e.object.ApiErrors.ApiError.PeripheralErrorCode=d.peripheralErrorCode||void 0,e.object.ApiErrors.ApiError.PeripheralErrorMsg=d.peripheralErrorMsg||void 0,e.object.ApiErrors.ApiError.PeripheralErrorText=d.peripheralErrorText||void 0,e.status=400):(e.object=this._lastUpdate,e.status=200);try{e.object.ApiErrors&&this._pendingCallbacks[c].error&&this._pendingCallbacks[c].error(e)}catch(u){this._logger.error(this.getRestType()+": Caught error while firing callback: "+u)}this._postProcessUpdateStrategy(c)}return this._processObject(b)}catch(u){this._logger.error(this.getRestType()+
": "+u)}return!1},_createAjaxHandler:function(a){var b=!1,c=this;return{abort:function(){b=!0},callback:function(e){if(!b){var d=!1,f;if(a.success||a.error){f={status:e.rc,content:e.text,isUnsent:e.isUnsent};c.doNotLog||c._logger.log(c.getRestType()+": requestId='"+a.uuid+"', Returned with status="+f.status+", content='"+f.content+"', isUnsent = "+f.isUnsent);if(e.text&&0<e.text.length)try{f.object=c._util.xml2js(e.text)}catch(G){d=!0,f.error={errorType:"parseError",errorMessage:"Could not serialize XML: "+
G}}else f.object={};!d&&200<=f.status&&300>f.status?a.success&&a.success(f):a.error&&a.error(f);202!==f.status&&e.headers&&e.headers.requestid&&(e=e.headers.requestid[0],c._pendingCallbacks[e]&&delete c._pendingCallbacks[e])}}}}},restRequest:function(b,c){var e=b.substring(b.lastIndexOf("/")+1,b.length);c=c||{};c.success=this._util.validateHandler(c.success);c.error=this._util.validateHandler(c.error);c.method&&"GET"!==c.method?(c.uuid=c.uuid||this._util.generateUUID(),this._pendingCallbacks[c.uuid]=
{},this._pendingCallbacks[c.uuid].success=c.success,this._pendingCallbacks[c.uuid].error=c.error):(b=-1<b.indexOf("?")?b+"&":b+"?",b+=this.getRestUrlAdditionalParameters(),b+="nocache="+this._util.currentTimeMillis(),this._shouldAllowBypassServerCache()&&(b+="&bypassServerCache=true"));var d=a.getRestHost().toLowerCase();return"localhost"===d||d===window.location.hostname.toLowerCase()?this._restRequestThroughAjax(b,c,e):this._restRequestThroughShindig(b,c)},_restRequestThroughAjax:function(a,e,d){function g(a){v=
a?a:v;$.ajax({url:p,headers:v.extraHeaders||{},beforeSend:function(a){a.setRequestHeader("Authorization",w);a.setRequestHeader("locale",A);a.setRequestHeader("f_username",y);e.uuid&&a.setRequestHeader("requestId",e.uuid)},dataType:D,contentType:z,processData:H,type:n,data:C,timeout:v.ajaxRequestTimeout,success:function(a,d,f){a={rc:f.status,text:a,isUnsent:0==f.readyState,headers:{requestid:f.getResponseHeader("requestId")},restType:v.getRestType()};d=window.finesse.RestCachingService;if(d.isCacheableForFailover(v.getRestType())||
d.isCacheableForFailover(e.restType))f=e.restType?b.getTopic(v.getRestUrl()+e.restType):b.getTopic(v.getRestUrl()),d.isRestCacheServiceReachable()&&(v._logger.log("Saving rest data in the cache: "+f),finesse.idb.RestCacheDataContainer.saveOrUpdateData([{key:f,data:a}]));c.isCacheable(v.getRestType())&&null!==a.text&&(v._logger.log("Saving rest data in the session storage cache: "+v.getRestType()),c.setItem(v.getRestType(),a.text));k.callback(a)},error:function(a,b,c){a={rc:a.status,text:a.responseText,
isUnsent:0==a.readyState,headers:{requestid:a.getResponseHeader("requestId")}};k.callback(a)}})}var p,k,m=window.location.protocol,q=window.location.hostname,h=window.location.port,D,z,n,C="",w,A=this._config.locale,y=this._config.id,H=!0;p=encodeURI(a)+(window.errorOnRestRequest?"ERROR":"");k=this._createAjaxHandler(e);n=e.method||"GET";p=m+"//"+q+":"+h+p;"object"===typeof e.content&&"undefined"!==typeof e.content?"multipart"===e.contentType?(z=!1,C=e.content,H=!1):(C=this._util.js2xml(e.content),
null!==C&&""!==C?z="application/xml":(z="",D="text")):(z="",D="text");w=this._util.getAuthHeaderString(this._config);this.doNotLog||this._logger.log(this.getRestType()+": requestId='"+e.uuid+"', Making REST request: method="+(e.method||"GET")+", url='"+p+"'");m="";this._rcs.getRestNameForRequestFromCache(d,a)&&(m=-1<a.indexOf("?")?b.getTopic(a.split("?")[0]):b.getTopic(a));if(!this._rcs.isRestCacheServiceReachable()||!m||e.method&&"GET"!==e.method)if(c.isCacheable(this.getRestType())&&"GET"===e.method&&
c.getItem(this.getRestType()))k.callback(f.xml2js(c.getItem(this.getRestType())));else{var v=this;g();return{abort:k.abort}}else _this=this,a={key:m,onsuccess:function(a){a&&a.data&&a.data.text?(_this._logger.log("Rest Caching: Rest data successfully fetched from cache : "+_this.getRestType()),sessionStorage.setItem("restCacheUsed","true"),k.callback(a.data)):(_this._logger.log("Rest Caching: Rest data not available in the cache, making rest call : "+_this.getRestType()),g(_this))},onerror:function(){g()}},
_this._logger.log("Rest Caching: Check if rest data is available in the cache for : "+m),finesse.idb.RestCacheDataContainer.fetchData(a)},_restRequestThroughShindig:function(b,c){var e,d,f;e={};c=c||{};e[gadgets.io.RequestParameters.HEADERS]=this.extraHeaders||{};(e[gadgets.io.RequestParameters.METHOD]=c.method)&&"GET"!==c.method&&(e[gadgets.io.RequestParameters.HEADERS].requestId=c.uuid,e[gadgets.io.RequestParameters.GET_FULL_HEADERS]="true");d=encodeURI(b)+(window.errorOnRestRequest?"ERROR":"");
this.doNotLog||this._logger.log(this.getRestType()+": requestId='"+c.uuid+"', Making REST request: method="+(c.method||"GET")+", url='"+d+"'");"object"===typeof c.content&&(e[gadgets.io.RequestParameters.HEADERS]["Content-Type"]="application/xml",e[gadgets.io.RequestParameters.POST_DATA]=this._util.js2xml(c.content),this.doNotLog||this._logger.log(this.getRestType()+": requestId='"+c.uuid+"', POST_DATA='"+e[gadgets.io.RequestParameters.POST_DATA]+"'"));f=this._createAjaxHandler(c);a.makeRequest(d,
f.callback,e);return{abort:f.abort}},_getNotifierReference:function(a){if("load"===a)a=this._loadNotifier;else if("change"===a)a=this._changeNotifier;else if("add"===a)a=this._addNotifier;else if("delete"===a)a=this._deleteNotifier;else if("error"===a)a=this._errorNotifier;else if("notify"===a)a=this._emptyUpdateNotifier;else throw Error("_getNotifierReference(): Trying to get unknown notifier(notifierType="+a+")");return a}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||
{};return window.finesse.restservices.RestBase=p});h("restservices/RestCollectionBase",["restservices/RestBase","utilities/Utilities","restservices/Notifier"],function(g,f,d){g=g.extend({supportsRestItemSubscriptions:!1,getRestItemClass:function(){throw Error("getRestItemClass(): Not implemented in subtype.");},getRestItemType:function(){throw Error("getRestItemType(): Not implemented in subtype.");},getRestItemBaseUrl:function(){return"/finesse/api/"+this.getRestItemType()},_objectCreator:function(a){var b=
this._extractId(a),c=this._collection[b],e=this;c?(c._processObject(a),c._changeNotifier.notifyListeners(c)):c=new (this.getRestItemClass())({doNotSubscribe:this.handlesItemSubscription,doNotRefresh:this.handlesItemRefresh,id:b,data:a,onLoad:function(a){e._collection[b]=a;e._collectionAddNotifier.notifyListeners(a);e.length+=1}})},_objectDeleter:function(a){var b=this._extractId(a),c=this._collection[b];c&&(c._processObject(a),this._collectionDeleteNotifier.notifyListeners(c),delete this._collection[b],
--this.length)},_createErrorNotifier:function(a){return function(b){a._errorNotifier.notifyListeners(b)}},_buildRefreshedCollection:function(a){var b,c,e,d=[];e=a&&null!==this.getProperty(a,this.getRestItemType())?f.getArray(this.getProperty(a,this.getRestItemType())):[];for(a=0;a<e.length;a+=1)b={},b[this.getRestItemType()]=e[a],c=this._extractId(b),this._objectCreator(b),d.push(c),b=this._collection[c],this.handlesItemRefresh&&b.explicitSubscription&&b._subscribeNode({error:this._createErrorNotifier(b)});
for(c in this._collection)if(this._collection.hasOwnProperty(c)){e=!1;for(a=d.length-1;0<=a;--a)if(d[a]===c){e=!0;break}e||this._objectDeleter({data:this._collection[c]._data})}},_RESTRefresh:function(){var a=this;this._doGET({success:function(b){a._processResponse(b)?a._buildRefreshedCollection(a._data):a._errorNotifier.notifyListeners(a)},error:function(b){a._errorNotifier.notifyListeners(b)}})},refresh:function(){var a=this;this.explicitSubscription?this._subscribeNode({success:function(){a._RESTRefresh()},
error:function(b){a._errorNotifier.notifyListeners(b)}}):this._RESTRefresh();return this},extractCollectionData:function(a){var b,c,e=[],d=this;this._data&&(b=this._data[this.getRestItemType()])&&($.isArray(b)||(b=[b]),$.each(b,function(b,f){!0===a?c=f:(c={},c[d.getRestItemType()]=f);e.push(c)}));return e},_addHandlerCb:function(a){return function(b){b=b.extractCollectionData();$.each(b,function(b,e){a._objectCreator(e)})}},_deleteHandlerCb:function(a){return function(b){b=b.extractCollectionData();
$.each(b,function(b,e){a._objectDeleter(e)})}},_isEmtpyUpdate:function(a){return Object.entries(a.data)&&1==Object.entries(a.data).length&&Object.entries(a.data)[0]&&null===a.data[Object.keys(a.data)[0]]&&a.source&&"PUT"===a.event&&a.requestId},_processRestItemUpdate:function(a){var b,c=a.object.Update,e=!1;this._isEmtpyUpdate(c)?(b=f.getId(c.source),e=!0):b=c.data.apiErrors?f.getId(c.source):this._extractId(c.data);if(b=this._collection[b])if(e)b.lastUpdateRequestId=c.requestId,b._emptyUpdateNotifier.notifyListeners(b);
else if(b._processUpdate(a))switch(c.event){case "POST":b._addNotifier.notifyListeners(b);break;case "PUT":b._changeNotifier.notifyListeners(b);break;case "DELETE":b._deleteNotifier.notifyListeners(b)}},_createPubsubCallback:function(){var a=this;return function(b){b.object.Update.source===a.getRestUrl()?a._updateEventHandler(a,b):a._processRestItemUpdate(b)}},_fakeConstuctor:function(){},init:function(a){a=a||{};a.id="";this._collection={};this.length=0;this._collectionAddNotifier=new d;this._collectionDeleteNotifier=
new d;this._super(a);this.addHandler("collectionAdd",a.onCollectionAdd);this.addHandler("collectionDelete",a.onCollectionDelete);this.addHandler("add",this._addHandlerCb(this));this.addHandler("delete",this._deleteHandlerCb(this))},getCollection:function(){return this._collection},_buildCollection:function(a){var b,c,e;if(a&&null!==this.getProperty(a,this.getRestItemType()))for(e=f.getArray(this.getProperty(a,this.getRestItemType())),a=0;a<e.length;a+=1)b={},b[this.getRestItemType()]=e[a],c=this._extractId(b),
this._collection[c]=new (this.getRestItemClass())({doNotSubscribe:this.handlesItemSubscription,doNotRefresh:this.handlesItemRefresh,id:c,data:b}),this.length+=1},_filterOutItem:function(a){return!1},_processObject:function(a){var b;b=this.getRestItemType();if(this._validate(a)){if(this._data=this.getProperty(a,this.getRestType()))if(a=this._data[b],"undefined"!==typeof a)if("undefined"===typeof a.length)this._filterOutItem(a)&&(this._data[b]=[]);else for(b=a.length-1;-1!==b;--b)this._filterOutItem(a[b])&&
a.splice(b,1);this._loaded||(this._buildCollection(this._data),this._loaded=!0,this._loadNotifier.notifyListeners(this));return!0}return!1},_getNotifierReference:function(a){var b;try{b=this._super(a)}catch(c){if("collectionAdd"===a)b=this._collectionAddNotifier;else if("collectionDelete"===a)b=this._collectionDeleteNotifier;else throw c;}return b}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.RestCollectionBase=
g});h("restservices/DialogBase",["restservices/RestBase","utilities/Utilities"],function(g,f){var d=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){throw Error("getRestClass(): Not implemented in subtype.");},_agentDeviceType:"AGENT_DEVICE",getRestType:function(){return"Dialog"},supportsRequests:!1,supportsSubscriptions:!1,getMediaType:function(){this.isLoaded();return this.getData().mediaType},getDialogUri:function(){this.isLoaded();return this.getData().uri},
getCallType:function(){this.isLoaded();return this.getData().mediaProperties.callType},getState:function(){this.isLoaded();return this.getData().state},getParticipants:function(){this.isLoaded();var a=this.getData().participants.Participant;return f.getArray(a)},getServices:function(){this.isLoaded();var a=this.getData().services?this.getData().services.service:[];return f.getArray(a)},getConferenceController:function(){this.isLoaded();return this.getData().conferenceController},updateCallVariables:function(a,
b){this.isLoaded();var c={},e=[],f;for(f in a)a.hasOwnProperty(f)&&e.push({name:f,value:a[f]});c.callvariables={CallVariable:e};b=b||{};b.content={};b.content[this.getRestType()]={mediaProperties:c,requestedAction:d.Actions.UPDATE_CALL_DATA};b.method="PUT";this.restRequest(this.getRestUrl(),b);return this},getParticipantTimerCounters:function(a){var b,c={},e,d;d=this.getParticipants();for(e=0;e<d.length;e+=1)if(b=d[e],b.mediaAddress===a){c.startTime=b.startTime;c.stateChangeTime=b.stateChangeTime;
c.state=b.state;break}return c},getMediaProperties:function(){var a,b,c;this.isLoaded();c=jQuery(this.getData().mediaProperties);if(void 0!==this._lastMediaPropertiesJQuery&&void 0!==this._lastMediaPropertiesMap&&this._lastMediaPropertiesJQuery.is(c))return this._lastMediaPropertiesMap;b={};if(a=this.getData().mediaProperties)a.callvariables&&a.callvariables.CallVariable&&(void 0===a.callvariables.CallVariable.length&&(a.callvariables.CallVariable=[a.callvariables.CallVariable]),jQuery.each(a.callvariables.CallVariable,
function(a,c){b[c.name]=c.value})),jQuery.each(a,function(a,c){"callvariables"!==a&&(b[a]=c)});this._lastMediaPropertiesMap=b;this._lastMediaPropertiesJQuery=c;return this._lastMediaPropertiesMap},_makeRequest:function(a,b){b=b||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:b.success,error:b.error,uuid:b.uuid,content:a})}});d.Actions={UPDATE_CALL_DATA:"UPDATE_CALL_DATA",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||
{};return window.finesse.restservices.DialogBase=d});h("restservices/Dialog",["restservices/DialogBase","utilities/Utilities"],function(g,f){var d=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){return d},REQUESTID_REAPER_TIMEOUT:5E3,getFromAddress:function(){this.isLoaded();return this.getData().fromAddress},getToAddress:function(){this.isLoaded();return this.getData().toAddress},getCallbackNumber:function(){this.isLoaded();return this.getData().callbackNumber},
getSecondaryId:function(){this.isLoaded();return this.getData().secondaryId},getParticipantTimerCounters:function(a){var b,c={},e,d;d=this.getParticipants();for(e=0;e<d.length;e+=1)if(b=d[e],b.mediaAddress===a){c.startTime=b.startTime;c.stateChangeTime=b.stateChangeTime;c.state=b.state;break}return c},getDroppableParticipants:function(a){this.isLoaded();var b=[],c,e="",d,g;c=this.getParticipants();a&&(e=a);for(a=0;a<c.length;a+=1)g=c[a],g.mediaAddress!==e&&(d=this._isParticipantStateDroppable(g),
!0===d&&b.push(g));return f.getArray(b)},_isParticipantStateDroppable:function(a){var b=null===window.finesse.container.Config.dropParticipant?"agents":window.finesse.container.Config.dropParticipant,c=null===window.finesse.container.Config.enableDropParticipantFor?"supervisor_only":window.finesse.container.Config.enableDropParticipantFor,e=!1;if(a.state===d.ParticipantStates.ACTIVE||a.state===d.ParticipantStates.ACCEPTED||a.state===d.ParticipantStates.HELD)e=!0;a=a.mediaAddressType===this._agentDeviceType;
if("agents"===b&&!a||"all"===b&&"supervisor_only"===c&&!a)e=!1;return e},isParticipantDroppable:function(a){var b,c=!1,e,d;if(b=this.getDroppableParticipants())for(e=0;e<b.length;e+=1)if(d=b[e],d.mediaAddress===a&&(d=this._isParticipantStateDroppable(d),!0===d)){c=!0;break}return c},getCallbackInfo:function(){this.isLoaded();return this.getData().scheduledCallbackInfo},makeConsultCall:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,toAddress:b,requestedAction:d.Actions.CONSULT_CALL};
this._makeRequest(e,c);return this},initiateDirectTransfer:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,toAddress:b,requestedAction:d.Actions.TRANSFER_SST};this._makeRequest(e,c);return this},updateWrapUpReason:function(a,b){this.isLoaded();var c;c="UCCX"===window.finesse.container.Config.deploymentType?{wrapUpItems:{wrapUpItem:a}}:{wrapUpReason:a};b=b||{};b.content={};b.content[this.getRestType()]={mediaProperties:c,requestedAction:d.Actions.UPDATE_CALL_DATA};
b.method="PUT";this.restRequest(this.getRestUrl(),b);return this},requestAction:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,requestedAction:b};this._makeRequest(e,c);return this},dropParticipant:function(a,b){this.requestAction(a,d.Actions.PARTICIPANT_DROP,b)},sendDTMFRequest:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,requestedAction:"SEND_DTMF",actionParams:{ActionParam:{name:"dtmfString",value:c}}};this._makeRequest(e,
b);return this},updateCallbackTime:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,requestedAction:d.Actions.UPDATE_SCHEDULED_CALLBACK,actionParams:{ActionParam:{name:"callbackTime",value:b}}};this._makeRequest(e,c);return this},updateCallbackNumber:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,requestedAction:d.Actions.UPDATE_SCHEDULED_CALLBACK,actionParams:{ActionParam:{name:"callbackNumber",value:b}}};this._makeRequest(e,
c);return this},cancelCallback:function(a,b){this.isLoaded();var c={};c[this.getRestType()]={targetMediaAddress:a,requestedAction:d.Actions.CANCEL_SCHEDULED_CALLBACK};this._makeRequest(c,b);return this},reclassifyCall:function(a,b,c){this.isLoaded();var e={};e[this.getRestType()]={targetMediaAddress:a,requestedAction:d.Actions.RECLASSIFY,actionParams:{ActionParam:{name:"outboundClassification",value:b}}};this._makeRequest(e,c);return this},_createRequestIdReaper:function(a){var b=this;return function(){b._logger.log("Dialog: clearing the requestId-to-callbacks mapping for requestId="+
a);delete b._pendingCallbacks[a]}},_postProcessUpdateStrategy:function(a){this._logger.log("Dialog: determining whether to set timeout for clearing requestId-to-callbacks mapping requestId="+a);var b=this._pendingCallbacks[a];b&&!b.used&&(this._logger.log("Dialog: setting timeout for clearing requestId-to-callbacks mapping requestId="+a),setTimeout(this._createRequestIdReaper(a),this.REQUESTID_REAPER_TIMEOUT),b.used=!0)}});d.Actions={DROP:"DROP",ANSWER:"ANSWER",HOLD:"HOLD",BARGE_CALL:"BARGE_CALL",
PARTICIPANT_DROP:"PARTICIPANT_DROP",MAKE_CALL:"MAKE_CALL",RETRIEVE:"RETRIEVE",UPDATE_SCHEDULED_CALLBACK:"UPDATE_SCHEDULED_CALLBACK",CANCEL_SCHEDULED_CALLBACK:"CANCEL_SCHEDULED_CALLBACK",CONSULT_CALL:"CONSULT_CALL",TRANSFER:"TRANSFER",TRANSFER_SST:"TRANSFER_SST",CONFERENCE:"CONFERENCE",RECLASSIFY:"RECLASSIFY",UPDATE_CALL_DATA:"UPDATE_CALL_DATA",START_RECORDING:"START_RECORDING",DTMF:"SEND_DTMF",ACCEPT:"ACCEPT",REJECT:"REJECT",CLOSE:"CLOSE",_fakeConstructor:function(){}};d.States={ALERTING:"ALERTING",
INITIATING:"INITIATING",ACTIVE:"ACTIVE",DROPPED:"DROPPED",INITIATED:"INITIATED",FAILED:"FAILED",ACCEPTED:"ACCEPTED",_fakeConstructor:function(){}};d.ParticipantStates={ALERTING:"ALERTING",INITIATING:"INITIATING",ACTIVE:"ACTIVE",DROPPED:"DROPPED",HELD:"HELD",INITIATED:"INITIATED",FAILED:"FAILED",WRAP_UP:"WRAP_UP",ACCEPTED:"ACCEPTED",_fakeConstructor:function(){}};d.ReasonStates={BUSY:"BUSY",BAD_DESTINATION:"BAD_DESTINATION",OTHER:"OTHER",DEVICE_RESOURCE_NOT_AVAILABLE:"DEVICE_RESOURCE_NOT_AVAILABLE",
_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Dialog=d});h("restservices/Dialogs",["restservices/RestCollectionBase","restservices/Dialog"],function(g,f){var d=g.extend({includeNonVoice:!1,_fakeConstuctor:function(){},init:function(a){this.includeNonVoice=a.includeNonVoice;this._super(a)},getRestUrlAdditionalParameters:function(){return this.includeNonVoice?"type=voice&type=non-voice&":
""},getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"Dialogs"},getRestItemType:function(){return"Dialog"},supportsRequests:!0,supportsRestItemSubscriptions:!0,REQUESTID_REAPER_TIMEOUT:5E3,createNewCallDialog:function(a,b,c){var e={};e[this.getRestItemType()]={requestedAction:"MAKE_CALL",toAddress:a,fromAddress:b};c=c||{};this.restRequest(this.getRestUrl(),{method:"POST",success:c.success,error:c.error,content:e});return this},createNewSuperviseCallDialog:function(a,
b,c,e){var d={};this._isLoaded=!0;d[this.getRestItemType()]={requestedAction:c,toAddress:a,fromAddress:b};e=e||{};this.restRequest(this.getRestUrl(),{method:"POST",success:e.success,error:e.error,content:d});return this},createNewBargeCall:function(a,b,c,e,d){this.isLoaded();var f={};f[this.getRestItemType()]={fromAddress:a,toAddress:b,requestedAction:c,associatedDialogUri:e};d=d||{};this.restRequest(this.getRestUrl(),{method:"POST",success:d.success,error:d.error,content:f});return this},getDialogCount:function(a){this.isLoaded();
var b,c=0;if(a){for(b in this._collection)this._collection.hasOwnProperty(b)&&"SUPERVISOR_MONITOR"!==this._collection[b].getCallType()&&(c+=1);return c}return this.length},_createRequestIdReaper:function(a){var b=this;return function(){b._logger.log("Dialogs: clearing the requestId-to-callbacks mapping for requestId="+a);delete b._pendingCallbacks[a]}},_postProcessUpdateStrategy:function(a){this._logger.log("Dialogs: determining whether to set timeout for clearing requestId-to-callbacks mapping requestId="+
a);var b=this._pendingCallbacks[a];b&&!b.used&&(this._logger.log("Dialogs: setting timeout for clearing requestId-to-callbacks mapping requestId="+a),setTimeout(this._createRequestIdReaper(a),this.REQUESTID_REAPER_TIMEOUT),b.used=!0)}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Dialogs=d});h("restservices/ClientLog",["restservices/RestBase"],function(g){var f=g.extend({doNotLog:!0,explicitSubscription:!0,init:function(d){this._super({id:"",
data:{clientLog:null},onAdd:d.onAdd,onChange:d.onChange,onLoad:d.onLoad,onError:d.onError,onDelete:d.onDelete,parentObj:d.parentObj})},getRestClass:function(){return f},getRestType:function(){return"ClientLog"},getXMPPNodePath:function(){return this.getRestUrl()},_doGET:function(d){},sendLogs:function(d,a){if(a=a||{},a.isZip){var b=new FormData;b.append("file",d);this.restRequest(this.getRestUrl().replace("ClientLog","CompressedClientLog"),{method:"POST",success:a.success,error:a.error,content:b,
contentType:"multipart"})}else this.restRequest(this.getRestUrl(),{method:"POST",error:a.error,content:d})}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.ClientLog=f});h("restservices/Queue",["restservices/RestBase","utilities/Utilities"],function(g,f){var d=g.extend({_fakeConstuctor:function(){},init:function(a,b,c){this._super(a,b,c)},getRestClass:function(){return d},getRestType:function(){return"Queue"},supportsSubscriptions:function(){return!0},
explicitSubscription:!0,getXMPPNodePath:function(){return this.getRestUrl()},getId:function(){this.isLoaded();return this._id},getName:function(){this.isLoaded();return this.getData().name},getStatistics:function(){this.isLoaded();return this.getData().statistics},_parseIdFromUriString:function(a){return f.getId(a)}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Queue=d});h("restservices/Queues",["restservices/RestCollectionBase",
"restservices/Queue"],function(g,f){var d=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getXMPPNodePath:function(){return this.getRestUrl()},getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"Queues"},getRestItemType:function(){return"Queue"},explicitSubscription:!0,handlesItemRefresh:!0});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Queues=
d});h("restservices/WrapUpReason",["restservices/RestBase"],function(g){var f=g.extend({_fakeConstuctor:function(){},init:function(d){this._super(d)},getRestClass:function(){return f},getRestType:function(){return"WrapUpReason"},getParentRestType:function(){return"WrapUpReasons"},supportsRequests:!1,supportsSubscriptions:!1,getLabel:function(){this.isLoaded();return this.getData().label},getForAll:function(){this.isLoaded();return this.getData().forAll},getUri:function(){this.isLoaded();return this.getData().uri}});
window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.WrapUpReason=f});h("restservices/WrapUpReasons",["restservices/RestCollectionBase","restservices/WrapUpReason"],function(g,f){var d=g.extend({teamId:null,_fakeConstuctor:function(){},init:function(a){a&&a.teamId&&(this.teamId=a.teamId);this._super(a)},getRestUrl:function(){return this.teamId?this.getBaseRestUrl()+"/TeamResource/"+this.teamId+"/"+this.getRestType():this._super()},
getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"WrapUpReasons"},getRestItemType:function(){return"WrapUpReason"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.WrapUpReasons=d});h("restservices/Contact",["restservices/RestBase"],
function(g){var f=g.extend({_fakeConstuctor:function(){},init:function(d){this._super(d)},getRestClass:function(){return f},getRestType:function(){return"Contact"},supportsRequests:!1,supportsSubscriptions:!1,getFirstName:function(){this.isLoaded();return this.getData().firstName},getLastName:function(){this.isLoaded();return this.getData().lastName},getPhoneNumber:function(){this.isLoaded();return this.getData().phoneNumber},getDescription:function(){this.isLoaded();return this.getData().description},
createPutSuccessHandler:function(d,a,b){return function(c){c.object=a;d._processResponse(c);c.object={};b(c)}},createPostSuccessHandler:function(d,a,b){return function(c){c.object=a;d._processResponse(c);c.object={};b(c)}},add:function(d,a){var b={};b[this.getRestType()]={firstName:d.firstName,lastName:d.lastName,phoneNumber:d.phoneNumber,description:d.description};a=a||{};this.restRequest(this.getRestUrl(),{method:"POST",success:this.createPostSuccessHandler(this,b,a.success),error:a.error,content:b});
return this},update:function(d,a){this.isLoaded();var b={};b[this.getRestType()]={uri:this.getId(),firstName:d.firstName,lastName:d.lastName,phoneNumber:d.phoneNumber,description:d.description};a=a||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,b,a.success),error:a.error,content:b});return this},"delete":function(d){this.isLoaded();d=d||{};this.restRequest(this.getRestUrl(),{method:"DELETE",success:this.createPutSuccessHandler(this,{},d.success),error:d.error,
content:void 0});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Contact=f});h("restservices/Contacts",["restservices/RestCollectionBase","restservices/Contact"],function(g,f){var d=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"Contacts"},getRestItemType:function(){return"Contact"},
supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Contacts=d});h("restservices/PhoneBook",["restservices/RestBase","restservices/Contacts"],function(g,f){var d=g.extend({_contacts:null,_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){return d},getRestType:function(){return"PhoneBook"},
supportsRequests:!1,supportsSubscriptions:!1,getName:function(){this.isLoaded();return this.getData().name},getType:function(){this.isLoaded();return this.getData().type},getUri:function(){this.isLoaded();return this.getData().uri},getContacts:function(a){a=a||{};a.parentObj=this;this.isLoaded();null===this._contacts&&(this._contacts=new f(a));return this._contacts},getEmbeddedContacts:function(){this.isLoaded();return this.getData().contacts},createPutSuccessHandler:function(a,b,c){return function(e){e.object=
b;a._processResponse(e);e.object={};c(e)}},createPostSuccessHandler:function(a,b,c){return function(e){e.object=b;a._processResponse(e);e.object={};c(e)}},add:function(a,b){var c={};c[this.getRestType()]={name:a.name,type:a.type};b=b||{};this.restRequest(this.getRestUrl(),{method:"POST",success:this.createPostSuccessHandler(this,c,b.success),error:b.error,content:c});return this},update:function(a,b){this.isLoaded();var c={};c[this.getRestType()]={uri:this.getId(),name:a.name,type:a.type};b=b||{};
this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,c,b.success),error:b.error,content:c});return this},"delete":function(a){this.isLoaded();a=a||{};this.restRequest(this.getRestUrl(),{method:"DELETE",success:this.createPutSuccessHandler(this,{},a.success),error:a.error,content:void 0});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.PhoneBook=d});h("restservices/PhoneBooks",
["restservices/RestCollectionBase","restservices/PhoneBook"],function(g,f){var d=g.extend({teamId:null,_fakeConstuctor:function(){},init:function(a){this.keepRestResponse=!0;this.extraHeaders={Range:"objects=1-6000"};a&&a.teamId&&(this.teamId=a.teamId);this._super(a)},getRestUrl:function(){return this.teamId?this.getBaseRestUrl()+"/TeamResource/"+this.teamId+"/"+this.getRestType():this._super()},getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"PhoneBooks"},
getRestItemType:function(){return"PhoneBook"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.PhoneBooks=d});h("restservices/WorkflowAction",["restservices/RestBase"],function(g){g=g.extend({_contacts:null,actionTypes:[{name:"BROWSER_POP",params:[{name:"windowName",type:"text"},{name:"path",
type:"systemVariableSingleLineEditor"}]},{name:"HTTP_REQUEST",params:[{name:"method",type:"dropdown",values:["POST","PUT"]},{name:"location",type:"dropdown",values:["FINESSE","OTHER"]},{name:"contentType",type:"text"},{name:"path",type:"systemVariableSingleLineEditor"},{name:"body",type:"systemVariableMultiLineEditor"}]}],_fakeConstuctor:function(){},init:function(f){this._super(f)},getRestClass:function(){return finesse.restservices.WorkflowAction},getRestType:function(){return"WorkflowAction"},
supportsRequests:!1,supportsSubscriptions:!1,getName:function(){this.isLoaded();return this.getData().name},getType:function(){this.isLoaded();return this.getData().type},getUri:function(){this.isLoaded();return this.getData().uri},getHandledBy:function(){this.isLoaded();return this.getData().handledBy},getParams:function(){var f={},d=this.getData().params.Param,a,b;for(a=0;a<d.length;a+=1)b=d[a],f[b.name]=b.value||"";return f},getActionVariables:function(){var f={},d=this.getData().actionVariables,
a,b;if(null===d||"undefined"===typeof d||0===d.length)return f;d=d.ActionVariable;if(0<d.length)for(a=0;a<d.length;a+=1)b=d[a],b.name=b.name||"",b.type=b.type||"",b.node=b.node||"",b.testValue=b.testValue||"",f[b.name]=b;else f[d.name]=d;return f},createPutSuccessHandler:function(f,d,a){return function(b){b.object=d;f._processResponse(b);b.object={};a(b)}},createPostSuccessHandler:function(f,d,a){return function(b){b.object=d;f._processResponse(b);b.object={};a(b)}},buildParamsForRest:function(f){var d=
{Param:[]},a;for(a in f)f.hasOwnProperty(a)&&d.Param.push({name:a,value:f[a]});return d},buildActionVariablesForRest:function(f){var d={ActionVariable:[]},a,b;for(a in f)f.hasOwnProperty(a)&&(b={name:f[a].name,type:f[a].type,node:f[a].node,testValue:f[a].testValue},d.ActionVariable.push(b));return d},add:function(f,d){var a={};a[this.getRestType()]={name:f.name,type:f.type,handledBy:f.handledBy,params:this.buildParamsForRest(f.params),actionVariables:this.buildActionVariablesForRest(f.actionVariables)};
d=d||{};this.restRequest(this.getRestUrl(),{method:"POST",success:this.createPostSuccessHandler(this,a,d.success),error:d.error,content:a});return this},update:function(f,d){this.isLoaded();var a={};a[this.getRestType()]={uri:this.getId(),name:f.name,type:f.type,handledBy:f.handledBy,params:this.buildParamsForRest(f.params),actionVariables:this.buildActionVariablesForRest(f.actionVariables)};d=d||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,a,d.success),
error:d.error,content:a});return this},"delete":function(f){this.isLoaded();f=f||{};this.restRequest(this.getRestUrl(),{method:"DELETE",success:this.createPutSuccessHandler(this,{},f.success),error:f.error,content:void 0});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.WorkflowAction=g});h("restservices/WorkflowActions",["restservices/RestCollectionBase","restservices/RestBase","restservices/WorkflowAction"],
function(g,f,d){var a=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"WorkflowActions"},getRestItemType:function(){return"WorkflowAction"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.WorkflowActions=
a});h("restservices/Workflow",["restservices/RestBase","restservices/WorkflowActions"],function(g,f){var d=g.extend({init:function(a){this._super(a)},getRestClass:function(){return d},getRestType:function(){return"Workflow"},supportsRequests:!1,supportsSubscriptions:!1,getUri:function(){this.isLoaded();return this.getData().uri},getName:function(){this.isLoaded();return this.getData().name},getDescription:function(){this.isLoaded();return this.getData().description},getMedia:function(){this.isLoaded();
return this.getData().media},getTriggerSet:function(){this.isLoaded();return this.getData().TriggerSet},getConditionSet:function(){this.isLoaded();return this.getData().ConditionSet},getWorkflowActions:function(){this.isLoaded();var a=this.getData().workflowActions;null===a&&(a="");return a},createPutSuccessHandler:function(a,b,c){return function(e){e.object=b;a._processResponse(e);e.object={};c(e)}},createPostSuccessHandler:function(a,b,c){return function(e){e.object=b;a._processResponse(e);e.object=
{};c(e)}},add:function(a,b){var c={};c[this.getRestType()]={media:a.media,name:a.name,description:a.description,TriggerSet:a.TriggerSet,ConditionSet:a.ConditionSet,workflowActions:a.workflowActions};b=b||{};this.restRequest(this.getRestUrl(),{method:"POST",success:this.createPostSuccessHandler(this,c,b.success),error:b.error,content:c});return this},update:function(a,b){this.isLoaded();var c={};c[this.getRestType()]={uri:this.getId(),media:this.getMedia(),name:a.name,description:a.description,TriggerSet:a.TriggerSet,
ConditionSet:a.ConditionSet,workflowActions:a.workflowActions};b=b||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,c,b.success),error:b.error,content:c});return this},"delete":function(a){this.isLoaded();a=a||{};this.restRequest(this.getRestUrl(),{method:"DELETE",success:this.createPutSuccessHandler(this,{},a.success),error:a.error,content:void 0});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||
{};return window.finesse.restservices.Workflow=d});h("restservices/Workflows",["restservices/RestCollectionBase","restservices/RestBase","restservices/Workflow"],function(g,f,d){var a=g.extend({init:function(a){a&&a.teamId&&(this.teamId=a.teamId);this._super(a)},getRestUrl:function(){return this.teamId?this.getBaseRestUrl()+"/TeamResource/"+this.teamId+"/"+this.getRestType():this._super()},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"Workflows"},
getRestItemType:function(){return"Workflow"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Workflows=a});h("restservices/MediaPropertiesLayout",["restservices/RestBase"],function(g){var f=g.extend({_fakeConstuctor:function(){},init:function(d){this._super(d)},getRestClass:function(){return f},
getRestType:function(){return"MediaPropertiesLayout"},supportsSubscriptions:!1,getName:function(){this.isLoaded();return this._data.name},getDescription:function(){this.isLoaded();return this._data.description||""},getType:function(){this.isLoaded();return this._data.type||""},get:function(){this._synchronize();return this},getData:function(){var d=this._data,a,b;a=this.getEmptyData();a.name=d.name;a.description=d.description;a.type=d.type;b=function(b,e){b?b.mediaProperty&&(b={"":b}):b={};jQuery.each(b,
function(b,c){c.displayName||(c.displayName="");a.columns[e].push(c)})};if(d.header&&d.header.entry)d.header.entry.displayName||(d.header.entry.displayName=""),a.header=d.header.entry;else throw"MediaPropertiesLayout.getData() - Header does not contain an entry";d.column&&d.column.entry&&(d.column=[null,{entry:d.column.entry}]);d.column&&0<d.column.length&&2>=d.column.length&&(d.column[0]&&d.column[0].entry&&b(d.column[0].entry,0),d.column[1]&&d.column[1].entry&&b(d.column[1].entry,1));return a},
getEmptyData:function(){return{header:{displayName:null,mediaProperty:null},columns:[[],[]]}},update:function(d,a){var b={};d.type=this.getType();b[this.getRestType()]=d;a=a||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:a.success,error:a.error,content:b});return this},add:function(d,a){var b={};b[this.getRestType()]=d;a=a||{};this.restRequest(this.getRestUrl(),{method:"POST",success:a.success,error:a.error,content:b});return this},"delete":function(d){d=d||{};this.restRequest(this.getRestUrl(),
{method:"DELETE",success:d.success,error:d.error,content:void 0});return this}});f.Object={_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaPropertiesLayout=f});h("restservices/UserMediaPropertiesLayout",["restservices/MediaPropertiesLayout"],function(g){var f=g.extend({init:function(d){this._super(d)},getRestClass:function(){return f},getRestUrl:function(){return"/finesse/api/User/"+
this.getId()+"/"+this.getRestType()},update:function(d,a){throw Error("update(): Cannot update layout for User's MediaPropertiesLayout");},add:function(d,a){throw Error("add(): Cannot create a new layout for User's MediaPropertiesLayout");},"delete":function(d,a){throw Error("delete(): Cannot delete the layout for User's MediaPropertiesLayout");}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.UserMediaPropertiesLayout=
f});h("restservices/MediaPropertiesLayouts",["restservices/RestCollectionBase","restservices/RestBase","restservices/MediaPropertiesLayout"],function(g,f,d){var a=g.extend({init:function(a){a&&a.teamId&&(this.teamId=a.teamId);this._super(a)},getRestUrl:function(){return this.teamId?this.getBaseRestUrl()+"/TeamResource/"+this.teamId+"/"+this.getRestType():this._super()},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"MediaPropertiesLayouts"},getRestItemType:function(){return"MediaPropertiesLayout"},
supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaPropertiesLayouts=a});h("restservices/UserMediaPropertiesLayouts",["restservices/MediaPropertiesLayouts","restservices/UserMediaPropertiesLayout"],function(g,f){var d=g.extend({init:function(a){this._super(a)},getRestClass:function(){return d},
getRestItemClass:function(){return f}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.UserMediaPropertiesLayouts=d});h("restservices/MediaDialog",["restservices/DialogBase"],function(g){var f=g.extend({supportsRequests:!0,_fakeConstuctor:function(){},init:function(d){this._super(d)},getRestClass:function(){return f},transfer:function(d,a){this.setTaskState(f.TaskActions.TRANSFER,a,d)},setTaskState:function(d,a,b){this.isLoaded();
var c={};c[this.getRestType()]={requestedAction:d,target:b};a=a||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:a.success,error:a.error,content:c});return this}});f.TaskActions={ACCEPT:"ACCEPT",START:"START",PAUSE:"PAUSE",RESUME:"RESUME",WRAP_UP:"WRAP_UP",TRANSFER:"TRANSFER",CLOSE:"CLOSE",_fakeConstructor:function(){}};f.States={OFFERED:"OFFERED",ACTIVE:"ACTIVE",PAUSED:"PAUSED",WRAPPING_UP:"WRAPPING_UP",INTERRUPTED:"INTERRUPTED",CLOSED:"CLOSED",ACCEPTED:"ACCEPTED",UNKNOWN:"UNKNOWN",_fakeConstructor:function(){}};
f.ParticipantStates=f.States;window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaDialog=f});h("restservices/../../thirdparty/Class",[],function(){var g=!1,f=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Class=function(){};Class.extend=function(d){function a(){!g&&this.init&&this.init.apply(this,arguments)}var b=this.prototype;g=!0;var c=new this;g=!1;for(var e in d)c[e]="function"==typeof d[e]&&"function"==typeof b[e]&&
f.test(d[e])?function(a,c){return function(){var e=this._super;this._super=b[a];var d=c.apply(this,arguments);this._super=e;return d}}(e,d[e]):d[e];a.prototype=c;a.prototype.constructor=a;a.extend=arguments.callee;return a};return Class});h("restservices/MediaDialogsSubscriptionManager",["../../thirdparty/Class","clientservices/ClientServices","clientservices/Topics"],function(g,f,d){var a=g.extend({_mediaDialogsMap:{},_sourceRegEx:null,_subscriptionId:null,_fakeConstuctor:function(){},_makeSourceRegEx:function(a){return new RegExp("^"+
a.getRestUrl()+"/Media/[0-9]+/Dialogs$")},_getMediaIdFromEventUpdate:function(b){return b.object.Update.source.split("/")[a.MEDIA_ID_INDEX_IN_SOURCE]},_updateEventHandler:function(a){var b=this._getMediaIdFromEventUpdate(a);(b=this._mediaDialogsMap[b])&&b._updateEventHandler(b,a)},_getMediaIdFromRestUpdate:function(a){return a.object.Update.data.dialog.mediaProperties.mediaId},_processRestItemUpdate:function(a){var b=this._getMediaIdFromRestUpdate(a);(b=this._mediaDialogsMap[b])&&b._processRestItemUpdate(a)},
_createPubsubCallback:function(){var a=this;return function(b){b.object.Update.source.match(a._sourceRegEx)?a._updateEventHandler(b):a._processRestItemUpdate(b)}},_manage:function(a){this._mediaDialogsMap[a.getMedia().getMediaId()]=a},_unManage:function(a){a=a.getMedia().getMediaId();this._callbackMap[a]&&delete this._callbackMap[a]},init:function(a){this._sourceRegEx=this._makeSourceRegEx(a)},subscribe:function(a,c){var b=d.getTopic(a.getXMPPNodePath()),g,k;c=c||{};g={success:function(){f.addToRefreshList(a);
"function"===typeof c.success&&c.success()},error:function(e){k&&(a._unManage(a),f.unsubscribe(b));"function"===typeof c.error&&c.error(e)}};this._manage(a);if(this._subscriptionId)k=!0;else if(k=f.subscribe(b,this._createPubsubCallback(),!0))this._subscriptionId="OpenAjaxOnly";k?g.success():g.error();return this}});a.MEDIA_ID_INDEX_IN_SOURCE=6;window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaDialogsSubscriptionManager=
a});h("restservices/MediaDialogs",["restservices/RestCollectionBase","restservices/RestBase","restservices/Dialogs","restservices/MediaDialog","restservices/MediaDialogsSubscriptionManager"],function(g,f,d,a,b){var c=d.extend({_fakeConstuctor:function(){},init:function(a){this._mediaObj=a.mediaObj;this._super(a)},getMedia:function(){return this._mediaObj},getRestItemClass:function(){return a},getXMPPNodePath:function(){var a=this._restObj,b="",b=a instanceof f?b+a.getRestUrl():b+"/finesse/api";return b+=
"/"+this.getRestType()+"/Media"},getRestUrl:function(){var a=this._mediaObj,b="",b=a instanceof f?b+a.getRestUrl():b+"/finesse/api",b=b+("/"+this.getRestType());this._id&&(b+="/"+this._id);return b},subscribe:function(a){c.subscriptionManager||(c.subscriptionManager=new b(this._restObj));c.subscriptionManager.subscribe(this,a);return this}});c.subscriptionManager=null;window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaDialogs=
c});h("restservices/MediaOptionsHelper",["../../thirdparty/Class","../utilities/Utilities","../clientservices/ClientServices","../cslogger/ClientLogger"],function(g,f,d,a){var b=g.extend({_media:null,_mediaOptions:null,_state:null,_fakeConstuctor:function(){},_formatLogMessage:function(a){return"MediaOptionsHelper["+this.media.getMediaId()+"]: "+a},_log:function(b){a.log(this._formatLogMessage(b))},_error:function(b){a.error(this._formatLogMessage(b))},_setState:function(a){this._state=a;this._log("changed state to "+
this._state)},_shouldLoginToFixOptions:function(a){return this._mediaOptions&&a.isLoggedIn()&&(a.getDialogLogoutAction()!==this._mediaOptions.dialogLogoutAction||a.getInterruptAction()!==this._mediaOptions.interruptAction||a.getMaxDialogLimit()!==this._mediaOptions.maxDialogLimit)},_agentIsAlreadyLoggedIn:function(a){return a&&a.object&&a.object.ApiErrors&&a.object.ApiErrors.ApiError&&"E_ARM_STAT_AGENT_ALREADY_LOGGED_IN"===a.object.ApiErrors.ApiError.ErrorMessage},_isSuccessfulLoginResponse:function(a){return a&&
(202===a.status||this._agentIsAlreadyLoggedIn(a))},_processConnectedState:function(a){var c=this;this._shouldLoginToFixOptions(a)&&(a=function(a){c._setState(b.States.MONITORING_OPTIONS);c._isSuccessfulLoginResponse(a)||c._error("failed to reset options: "+a.status+": "+a.content)},this._setState(b.States.SETTING_OPTIONS),this._log("logging in to fix options"),this.media.login({dialogLogoutAction:c._mediaOptions.dialogLogoutAction,interruptAction:c._mediaOptions.interruptAction,maxDialogLimit:c._mediaOptions.maxDialogLimit,
handlers:{success:a,error:a}}))},_processResettingOptionsState:function(a){this._log("Resetting options is in progress")},init:function(a,e){var c=this,f=function(a){switch(c._state){case b.States.MONITORING_OPTIONS:c._processConnectedState(a);break;case b.States.SETTING_OPTIONS:c._processResettingOptionsState(a);break;default:c._error("unexpected state: "+c.state)}};this.media=a;this._mediaOptions=e||{};this._mediaOptions.maxDialogLimit&&(this._mediaOptions.maxDialogLimit=this._mediaOptions.maxDialogLimit.toString());
d.addToRefreshList(this.media);this._setState(b.States.MONITORING_OPTIONS);this.media.addHandler("load",f);this.media.addHandler("change",f);this._log("initialized")}});b.States={MONITORING_OPTIONS:"MONITORING_OPTIONS",SETTING_OPTIONS:"SETTING_OPTIONS",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaOptionsHelper=b});h("restservices/Media",["restservices/RestBase","restservices/MediaDialogs",
"restservices/MediaOptionsHelper"],function(g,f,d){var a=g.extend({supportsRequests:!0,_mdialogs:null,_mediaOptions:null,_optionsHelper:null,_fakeConstuctor:function(){},init:function(a){this._super(a)},_getDataAttribute:function(a){this.isLoaded();return this.getData()[a]},getRestClass:function(){return a},getRestType:function(){return"Media"},getMediaUri:function(){return this._getDataAttribute("uri")},getId:function(){return this._getDataAttribute("id")},getName:function(){return this._getDataAttribute("name")},
getReasonCodeId:function(){return this._getDataAttribute("reasonCodeId")},getReasonCodeLabel:function(){this.isLoaded();return this.getData().reasonCode?this.getData.reasonCode.label:""},getInterruptAction:function(){return this._getDataAttribute("interruptAction")},getDialogLogoutAction:function(){return this._getDataAttribute("dialogLogoutAction")},getState:function(){return this._getDataAttribute("state")},getMediaId:function(){return this._getDataAttribute("id")},getMaxDialogLimit:function(){return this._getDataAttribute("maxDialogLimit")},
getInterruptible:function(){return"true"===this._getDataAttribute("interruptible")},isInterruptible:function(){return this.getInterruptible()},getRoutable:function(){return"true"===this._getDataAttribute("routable")},isRoutable:function(){return this.getRoutable()},setRoutable:function(a){var b={},e=this.getRestType(),d=this.getRestUrl();a=a||{};b[e]={routable:a.routable};this._makeRequest(b,d,a.handlers||{});return this},_makeRequest:function(a,c,e){e=e||{};this.restRequest(c,{method:"PUT",success:e.success,
error:e.error,content:a})},_containsLoginOptions:function(a){return a.maxDialogLimit||a.interruptAction||a.dialogLogoutAction},_makeLoginOptions:function(a){return this._mediaOptions?a?this._containsLoginOptions(a)?a:{maxDialogLimit:this._mediaOptions.maxDialogLimit,interruptAction:this._mediaOptions.interruptAction,dialogLogoutAction:this._mediaOptions.dialogLogoutAction,handlers:a.handlers}:this._mediaOptions:a},_ensureOptionsAreInSynch:function(){!this._optionsHelper&&this._mediaOptions&&(this._optionsHelper=
new d(this,this._mediaOptions))},login:function(b){this.setState(a.States.LOGIN,null,this._makeLoginOptions(b));return this},logout:function(b,c){return this.setState(a.States.LOGOUT,b,c)},setState:function(a,c,e){var b,d={},f=this.getRestType(),g=this.getRestUrl();e=e||{};c&&(b=c.id);d[f]={state:a,maxDialogLimit:e.maxDialogLimit,interruptAction:e.interruptAction,dialogLogoutAction:e.dialogLogoutAction,reasonCodeId:b};this._makeRequest(d,g,e.handlers||{});return this},getMediaDialogs:function(a){a=
a||{};a.parentObj=this._restObj;a.mediaObj=this;this.isLoaded();null===this._mdialogs&&(this._mdialogs=new f(a));return this._mdialogs},refreshMediaDialogs:function(){this._mdialogs&&this._mdialogs.refresh()},setMediaOptions:function(a){a&&(this._mediaOptions=a,this._optionsHelper||(this._optionsHelper=new d(this,this._mediaOptions)))},refresh:function(a){this._synchronize(a||1);this.refreshMediaDialogs()},isInWorkState:function(){return this.getState()===a.States.WORK},isLoggedIn:function(){var b=
this.getState();return b&&b!==a.States.LOGOUT}});a.States={LOGIN:"LOGIN",LOGOUT:"LOGOUT",NOT_READY:"NOT_READY",READY:"READY",RESERVED:"RESERVED",INTERRUPTED:"INTERRUPTED",WORK:"WORK",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Media=a});h("restservices/MediaList",["restservices/RestCollectionBase","restservices/Media","restservices/RestBase","utilities/Utilities"],function(g,f,d,a){var b=
g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},getRestClass:function(){return b},getRestItemClass:function(){return f},getRestType:function(){return"MediaList"},getRestItemType:function(){return"Media"},supportsRequests:!0,supportsRestItemSubscriptions:!0,getRestUrl:function(){var a=this._restObj,b="",b=a instanceof d?b+a.getRestUrl():b+"/finesse/api",b=b+("/"+this.getRestItemType());this._id&&(b+="/"+this._id);return b},getMedia:function(a){this.isLoaded();a=a||{};var b=
a.id,c=this._collection[b];if(!c)throw Error("No media found with id: "+b);c.addHandler("load",a.onLoad);c.addHandler("change",a.onChange);c.addHandler("add",a.onAdd);c.addHandler("delete",a.onDelete);c.addHandler("error",a.onError);c.setMediaOptions(a.mediaOptions);return c},_buildCollection:function(b){var c,d,f;if(b&&null!==this.getProperty(b,this.getRestItemType()))for(f=a.getArray(this.getProperty(b,this.getRestItemType())),b=0;b<f.length;b+=1)c={},c[this.getRestItemType()]=f[b],d=c[this.getRestItemType()].id,
this._collection[d]=new (this.getRestItemClass())({id:d,data:c,parentObj:this._restObj}),this.length+=1}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.MediaList=b});h("restservices/ReasonCodes",[],function(){var g=Class.extend({_fakeConstuctor:function(){}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.ReasonCodes=g});h("restservices/TeamResource",
["restservices/RestBase","utilities/Utilities","clientservices/Topics","utilities/RestCachingService"],function(g,f,d,a){var b=g.extend({supportsSubscriptions:!1,doNotRefresh:!0,autoSubscribe:!1,supportsRequests:!1,teamId:null,rcs:a,_logger:{log:finesse.clientservices.ClientServices.log},init:function(a){this._super(a);if(!a.teamId)throw Error("Team Id is mandatory");this.teamId=a.teamId},doGet:function(a){},getRestClass:function(){return b},getRestType:function(){return"TeamResource"},getRestItemType:function(){return"ReasonCodes"},
getRestUrl:function(){return this.getBaseRestUrl()+"/"+this.getRestType()+"/"+this.teamId+"/"},_parseIdFromUriString:function(a){return f.getId(a)},lookupReasonCode:function(a,b,d){this.getReasonCodesByType(d,{success:function(c){a.success(c.filter(function(a){return a.code===b})[0])},error:function(b){a.error(b)}},!0)},getReasonCodesByType:function(a,b,f){var c=this,e=this.getRestUrl()+"ReasonCodes";f=f?!0:!1;if(this.rcs.isRestCacheServiceReachable()&&this.rcs.isCacheable("ReasonCodes")){var g={key:d.getTopic(e),
onsuccess:function(d){d?(c._logger.log("Getting Reason Codes from cache for category="+a+" and Team="+this.teamId),c._reasonCodesSuccessHandler(a,e,d.data.text,b,f)):c._makeRestRequest(c,e,this.teamId,a,b,f,"ReasonCodes")},onerror:function(a){c._logger.log("Error while fetching reason codes from cache",a)}};finesse.idb.RestCacheDataContainer.fetchData(g)}else this._makeRestRequest(c,e,this.teamId,a,b,f,"ReasonCodes")},_makeRestRequest:function(a,b,d,f,g,m,l){a._logger.log("Fetching Reason Codes category=ALL");
a.restRequest(b+"?category=ALL",{method:"GET",success:function(c){a._reasonCodesSuccessHandler(f,b,c.content,g,m)},error:function(a){g.error(a)},content:{},restType:l})},_reasonCodesSuccessHandler:function(a,b,d,f,g){b=[];var c=[];d=this._util.xml2js(d);var e=[];d&&d.ReasonCodes.ReasonCode&&(e=d.ReasonCodes.ReasonCode);if(void 0!==e[0])for(i=0;i<e.length;i+=1)a===e[i].category&&("true"===e[i].systemCode?c.push(this._getResonCodeObject(e[i])):b.push(this._getResonCodeObject(e[i])));f.success(g?b.concat(c):
b)},_getResonCodeObject:function(a){return{label:a.label,id:f.getId(a.uri),uri:a.uri,code:a.code}}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamResource=b});h("restservices/User","restservices/RestBase restservices/Dialogs restservices/ClientLog restservices/Queues restservices/WrapUpReasons restservices/PhoneBooks restservices/Workflows restservices/UserMediaPropertiesLayout restservices/UserMediaPropertiesLayouts restservices/Media restservices/MediaList restservices/ReasonCodes utilities/Utilities restservices/TeamResource".split(" "),
function(g,f,d,a,b,c,e,p,k,q,m,l,r,h){var u=g.extend({_dialogs:null,_clientLogObj:null,_wrapUpReasons:null,_phoneBooks:null,_workflows:null,_mediaPropertiesLayout:null,_mediaPropertiesLayouts:null,_queues:null,media:null,mediaList:null,_TeamResource:null,init:function(a){this._super(a)},Callbacks:{},getRestClass:function(){return u},getRestType:function(){return"User"},getXMPPNodePath:function(){return this.getRestUrl()},supportsSubscriptions:function(){return!0},getFirstName:function(){this.isLoaded();
return r.convertNullToEmptyString(this.getData().firstName)},getReasonCode:function(){this.isLoaded();return this.getData().reasonCode},getPendingStateReasonCode:function(){this.isLoaded();return this.getData().pendingStateReasonCode},isReasonCodeReserved:function(){var a=this.getReasonCode();return a?"true"===a.systemCode?!0:!1:!1},getLastName:function(){this.isLoaded();return r.convertNullToEmptyString(this.getData().lastName)},getFullName:function(){this.isLoaded();return r.formatString("{0} {1}",
r.convertNullToEmptyString(this.getData().firstName),r.convertNullToEmptyString(this.getData().lastName))},getExtension:function(){this.isLoaded();return r.convertNullToEmptyString(this.getData().extension)},getTeamId:function(){this.isLoaded();return this.getData().teamId},getTeamName:function(){this.isLoaded();return this.getData().teamName},hasAgentRole:function(){this.isLoaded();return this.hasRole("Agent")},hasSupervisorRole:function(){this.isLoaded();return this.hasRole("Supervisor")},hasRole:function(a){this.isLoaded();
var b=!1,c,e,d;e=this.getData().roles.role;d=e.length;if("string"===typeof e)e===a&&(b=!0);else for(c=0;c<d;c+=1)if(e[c]===a){b=!0;break}return b},getPendingState:function(){this.isLoaded();return r.convertNullToEmptyString(this.getData().pendingState)},getWrapUpTimer:function(){this.isLoaded();return this.getData().wrapUpTimer},getState:function(){this.isLoaded();return this.getData().state},getMediaState:function(){this.isLoaded();void 0===this.getData().mediaState&&(this.getData().mediaState=null);
return this.getData().mediaState},getStateChangeTime:function(){this.isLoaded();return this.getData().stateChangeTime},getWrapUpOnIncoming:function(){this.isLoaded();return this.getData().settings.wrapUpOnIncoming},getWrapUpOnOutgoing:function(){this.isLoaded();return this.getData().settings.wrapUpOnOutgoing},isWrapUpRequired:function(){return this.getWrapUpOnIncoming()===u.WrapUpMode.REQUIRED||this.getWrapUpOnIncoming()===u.WrapUpMode.REQUIRED_WITH_WRAP_UP_DATA},isMobileAgent:function(){this.isLoaded();
var a=this.getData().mobileAgent;return null!==a&&"object"===typeof a},getMobileAgentMode:function(){this.isLoaded();return this.isMobileAgent()?this.getData().mobileAgent.mode:null},getMobileAgentDialNumber:function(){this.isLoaded();return this.isMobileAgent()?this.getData().mobileAgent.dialNumber:null},getDialogs:function(a){a=a||{};a.parentObj=this;this.isLoaded();null===this._dialogs&&(this._dialogs=new f(a));return this._dialogs},getDialogsNoCache:function(a){a=a||{};a.parentObj=this;this.isLoaded();
return this._dialogs=new f(a)},getMediaList:function(a){a=a||{};a.parentObj=this;this.isLoaded();null===this.mediaList&&(this.mediaList=new m(a));return this.mediaList},getClientLog:function(a){a=a||{};a.parentObj=this;this.isLoaded();if(null===this._clientLogObj)this._clientLogObj=new d(a);else if(a.onLoad&&"function"===typeof a.onLoad)a.onLoad(this._clientLogObj);return this._clientLogObj},getQueues:function(b){b=b||{};b.parentObj=this;this.isLoaded();null===this._queues&&(this._queues=new a(b));
return this._queues},getWrapUpReasons:function(a){a=a||{};a.parentObj=this;a.teamId=this.getTeamId();this.isLoaded();null===this._wrapUpReasons&&(this._wrapUpReasons=new b(a));return this._wrapUpReasons},getPhoneBooks:function(a){a=a||{};a.parentObj=this;a.teamId=this.getTeamId();this.isLoaded();null===this._phoneBooks&&(this._phoneBooks=new c(a));return this._phoneBooks},loadWorkflows:function(a){a=a||{};a.parentObj=this;a.teamId=this.getTeamId();this.isLoaded();null===this._workflows?this._workflows=
new e(a):this._workflows.refresh()},getMediaPropertiesLayout:function(a){a=a||{};a.parentObj=this;a.id=this._id;this.isLoaded();null===this._mediaPropertiesLayout&&(this._mediaPropertiesLayout=new p(a));return this._mediaPropertiesLayout},getMediaPropertiesLayouts:function(a){a=a||{};a.parentObj=this;a.teamId=this.getTeamId();this.isLoaded();null===this._mediaPropertiesLayouts&&(this._mediaPropertiesLayouts=new k(a));return this._mediaPropertiesLayouts},getSupervisedTeams:function(){this.isLoaded();
try{return r.getArray(this.getData().teams.Team)}catch(B){return[]}},_login:function(a){var b={},c=this.getRestType();a=a||{};b[c]={state:u.States.LOGIN,extension:a.extension};a.reasonCodeId&&(b[c].reasonCodeId=a.reasonCodeId);a.activeDeviceId&&(b[c].activeDeviceId=a.activeDeviceId);"object"===typeof a.mobileAgent&&(b[c].mobileAgent={mode:a.mobileAgent.mode,dialNumber:a.mobileAgent.dialNumber});a=a.handlers||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:a.success,error:a.error,content:b});
return this},login:function(a,b){this.isLoaded();return this._login({extension:a,handlers:b})},loginWithActiveDeviceId:function(a,b,c){this.isLoaded();return this._login({extension:a,activeDeviceId:b,handlers:c})},loginMobileAgent:function(a,b,c,e,d){this.isLoaded();a={extension:a,mobileAgent:{mode:b,dialNumber:c},handlers:e};d&&(a.reasonCodeId=d.id);return this._login(a)},_updateMobileAgent:function(a){var b={},c=this.getRestType();a=a||{};b[c]={};"object"===typeof a.mobileAgent&&(b[c].mobileAgent=
{mode:a.mobileAgent.mode,dialNumber:a.mobileAgent.dialNumber});a=a.handlers||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:a.success,error:a.error,content:b});return this},updateToMobileAgent:function(a,b,c){this.isLoaded();return this._updateMobileAgent({mobileAgent:{mode:a,dialNumber:b},handlers:c})},logout:function(a,b){return this.setState("LOGOUT",a,b)},setState:function(a,b,c){this.isLoaded();var e={};b?e[this.getRestType()]={state:a,reasonCodeId:b.id}:e[this.getRestType()]={state:a};
c=c||{};a={method:"PUT",success:c.success,error:c.error,content:e};this.restRequest(this.getRestUrl(),a);return this},makeCall:function(a,b){this.isLoaded();this.getDialogs().createNewCallDialog(a,this.getExtension(),b);return this},makeSMCall:function(a,b){this.isLoaded();this.getDialogs().createNewSuperviseCallDialog(a,this.getExtension(),"SILENT_MONITOR",b);return this},makeBargeCall:function(a,b,c){this.isLoaded();this.getDialogs().createNewBargeCall(this.getExtension(),a,"BARGE_CALL",b,c);return this},
isPendingStateChange:function(){var a=this.getState();return a&&(a===u.States.TALKING||a===u.States.HOLD||a===u.States.RESERVED_OUTBOUND_PREVIEW)},isWrapUp:function(){var a=this.getState();return a&&(a===u.States.WORK||a===u.States.WORK_READY)},_parseIdFromUriString:function(a){return r.getId(a)},getReasonCodeLabel:function(){this.isLoaded();return this.getData().reasonCode?this.getData().reasonCode.label:""},getNotReadyReasonCodeId:function(){this.isLoaded();var a,b;b=this.getData().reasonCodeId;
"-1"!==b&&(a=b);return a},getReasonCodeById:function(a,b){var c=this,e,d;d=this.getRestUrl()+"/ReasonCode/"+b;this.restRequest(d,{method:"GET",success:function(b){e={uri:b.object.ReasonCode.uri,label:b.object.ReasonCode.label,id:c._parseIdFromUriString(b.object.ReasonCode.uri)};a.success(e)},error:function(b){a.error(b)},content:{}})},isDeviceSelectionEnabled:function(){this.isLoaded();return this.getData().settings?"enabled"===this.getData().settings.deviceSelection:!1},getDevices:function(){this.isLoaded();
return this.getData().Devices},getSkillTargetId:function(){this.isLoaded();return this.getData().skillTargetId},getActiveDeviceId:function(){this.isLoaded();return this.getData().activeDeviceId},getServices:function(){this.isLoaded();var a=this.getData().services?this.getData().services.service:[];return r.getArray(a)},_getReasonCodesByType:function(a,b){this._TeamResource||(this._TeamResource=new h({teamId:this.getTeamId()}));this._TeamResource.getReasonCodesByType(a,b)},getSignoutReasonCodes:function(a){this._getReasonCodesByType("LOGOUT",
a)},getNotReadyReasonCodes:function(a){this._getReasonCodesByType("NOT_READY",a)}});u.MediaStates={BUSY:"BUSY",_fakeConstructor:function(){}};u.States={LOGIN:"LOGIN",LOGOUT:"LOGOUT",NOT_READY:"NOT_READY",READY:"READY",RESERVED:"RESERVED",RESERVED_OUTBOUND:"RESERVED_OUTBOUND",RESERVED_OUTBOUND_PREVIEW:"RESERVED_OUTBOUND_PREVIEW",TALKING:"TALKING",HOLD:"HOLD",WORK:"WORK",WORK_READY:"WORK_READY",_fakeConstructor:function(){}};u.WorkMode={CALL_BY_CALL:"CALL_BY_CALL",NAILED_CONNECTION:"NAILED_CONNECTION",
_fakeConstructor:function(){}};u.WrapUpMode={REQUIRED:"REQUIRED",REQUIRED_WITH_WRAP_UP_DATA:"REQUIRED_WITH_WRAP_UP_DATA",OPTIONAL:"OPTIONAL",NOT_ALLOWED:"NOT_ALLOWED",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.User=u});h("restservices/Users",["restservices/RestCollectionBase","restservices/RestBase","restservices/User"],function(g,f,d){var a=g.extend({_fakeConstuctor:function(){},init:function(a){this._super(a)},
getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"Users"},getRestItemType:function(){return"User"},getXMPPNodePath:function(){return this.getRestUrl()},_doGET:function(a){var b=this;a=a||{};return this._restObj&&"Team"===this._restObj.getRestType()?(this._restObj._doGET({success:function(c){b._restObj._validate(c.object)?(c.object[b.getRestType()]=c.object[b._restObj.getRestType()][b.getRestType().toLowerCase()],a.success(c)):a.error(c)},error:a.error}),
this):this._super(a)},supportsRequests:!1,handlesItemSubscription:!0,explicitSubscription:!0});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Users=a});h("restservices/TeamNotReadyReasonCode",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d)},getRestClass:function(){return f},getRestType:function(){return"ReasonCode"},supportsRequests:!1,supportsSubscriptions:!1,getCategory:function(){this.isLoaded();
return this.getData().category},getCode:function(){this.isLoaded();return this.getData().code},getLabel:function(){this.isLoaded();return this.getData().label},getForAll:function(){this.isLoaded();return this.getData().forAll},getUri:function(){this.isLoaded();return this.getData().uri},getSystemCode:function(){this.isLoaded();return this.getData().systemCode}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamNotReadyReasonCode=
f});h("restservices/TeamNotReadyReasonCodes",["restservices/RestCollectionBase","restservices/RestBase","restservices/TeamNotReadyReasonCode"],function(g,f,d){var a=g.extend({init:function(a){this._super(a)},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"ReasonCodes"},getRestUrl:function(){var a=this._restObj,c="",c=a instanceof f?c+a.getRestUrl():c+"/finesse/api",c=c+"/ReasonCodes?category=NOT_READY";this._id&&(c+="/"+this._id);return c},getRestItemType:function(){return"ReasonCode"},
supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this},createPutSuccessHandler:function(a,c,e){return function(b){b.object=c;a._processResponse(b);b.object={};e(b)}},update:function(a,c){this.isLoaded();var b={},d=[],f,g;b[this.getRestType()]={};for(f in a)a.hasOwnProperty(f)&&(g={uri:a[f]},d.push(g));b[this.getRestType()]={ReasonCode:d};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,
b,c.success),error:c.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamNotReadyReasonCodes=a});h("restservices/TeamWrapUpReason",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d)},getRestClass:function(){return f},getRestType:function(){return"WrapUpReason"},supportsRequests:!1,supportsSubscriptions:!1,getLabel:function(){this.isLoaded();return this.getData().label},
getForAll:function(){this.isLoaded();return this.getData().forAll},getUri:function(){this.isLoaded();return this.getData().uri}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamWrapUpReason=f});h("restservices/TeamWrapUpReasons",["restservices/RestCollectionBase","restservices/RestBase","restservices/TeamWrapUpReason"],function(g,f,d){var a=g.extend({init:function(a){this._super(a)},getRestClass:function(){return a},
getRestItemClass:function(){return d},getRestType:function(){return"WrapUpReasons"},getRestItemType:function(){return"WrapUpReason"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this},createPutSuccessHandler:function(a,c,d){return function(b){b.object=c;a._processResponse(b);b.object={};d(b)}},update:function(a,c){this.isLoaded();var b={},d=[],f,g;b[this.getRestType()]={};for(f in a)a.hasOwnProperty(f)&&(g={uri:a[f]},
d.push(g));b[this.getRestType()]={WrapUpReason:d};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,b,c.success),error:c.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamWrapUpReasons=a});h("restservices/TeamSignOutReasonCode",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d)},getRestClass:function(){return f},
getRestType:function(){return"ReasonCode"},supportsRequests:!1,supportsSubscriptions:!1,getCategory:function(){this.isLoaded();return this.getData().category},getCode:function(){this.isLoaded();return this.getData().code},getLabel:function(){this.isLoaded();return this.getData().label},getForAll:function(){this.isLoaded();return this.getData().forAll},getUri:function(){this.isLoaded();return this.getData().uri},getSystemCode:function(){this.isLoaded();return this.getData().systemCode}});window.finesse=
window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamSignOutReasonCode=f});h("restservices/TeamSignOutReasonCodes",["restservices/RestCollectionBase","restservices/RestBase","restservices/TeamSignOutReasonCode"],function(g,f,d){var a=g.extend({init:function(a){this._super(a)},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"ReasonCodes"},getRestUrl:function(){var a=this._restObj,c=
"",c=a instanceof f?c+a.getRestUrl():c+"/finesse/api",c=c+"/ReasonCodes?category=LOGOUT";this._id&&(c+="/"+this._id);return c},getRestItemType:function(){return"ReasonCode"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this},createPutSuccessHandler:function(a,c,d){return function(b){b.object=c;a._processResponse(b);b.object={};d(b)}},update:function(a,c){this.isLoaded();var b={},d=[],f,g;b[this.getRestType()]={};
for(f in a)a.hasOwnProperty(f)&&(g={uri:a[f]},d.push(g));b[this.getRestType()]={ReasonCode:d};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,b,c.success),error:c.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamSignOutReasonCodes=a});h("restservices/TeamPhoneBook",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d)},
getRestClass:function(){return f},getRestType:function(){return"PhoneBook"},supportsRequests:!1,supportsSubscriptions:!1,getName:function(){this.isLoaded();return this.getData().name},getUri:function(){this.isLoaded();return this.getData().uri}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamPhoneBook=f});h("restservices/TeamPhoneBooks",["restservices/RestCollectionBase","restservices/RestBase","restservices/TeamPhoneBook"],
function(g,f,d){var a=g.extend({init:function(a){this._super(a)},getRestClass:function(){return a},getRestItemClass:function(){return d},getRestType:function(){return"PhoneBooks"},getRestUrl:function(){var a=this._restObj,c="",c=a instanceof f?c+a.getRestUrl():c+"/finesse/api",c=c+"/PhoneBooks";this._id&&(c+="/"+this._id);return c},getRestItemType:function(){return"PhoneBook"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();
return this},createPutSuccessHandler:function(a,c,d){return function(b){b.object=c;a._processResponse(b);b.object={};d(b)}},update:function(a,c){this.isLoaded();var b={},d=[],f,g;b[this.getRestType()]={};for(f in a)a.hasOwnProperty(f)&&(g={uri:a[f]},d.push(g));b[this.getRestType()]={PhoneBook:d};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,b,c.success),error:c.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=
window.finesse.restservices||{};return window.finesse.restservices.TeamPhoneBooks=a});h("restservices/LayoutConfig",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super("",d);this._layoutxml={}},getRestClass:function(){return f},getRestType:function(){return"LayoutConfig"},getRestUrl:function(){return"/finesse/api/"+this.getRestType()+"/default"},supportsSubscriptions:!1,keepRestResponse:!0,getLayoutxml:function(){this.isLoaded();var d=this.getData().layoutxml;return d=
d.replace(/&amp;/g,"&")},get:function(){this._synchronize();return this},createPutSuccessHandler:function(d,a,b){return function(c){c.content=a;c.object.LayoutConfig={};c.object.LayoutConfig.finesseLayout=a;d._processResponse(c);c.object.LayoutConfig={};b(c)}},update:function(d,a){this.isLoaded();var b={};d=d.replace(/&(?!amp;)/g,"&amp;");d=d.replace(/<gadget>\s*(\S+)\s*<\/gadget>/g,"<gadget>$1</gadget>");b[this.getRestType()]={layoutxml:finesse.utilities.Utilities.translateHTMLEntities(d,!0)};a=
a||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,d,a.success),error:a.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.LayoutConfig=f});h("restservices/TeamLayoutConfig",["restservices/RestBase","utilities/Utilities","restservices/LayoutConfig"],function(g,f,d){var a=g.extend({keepRestResponse:!0,init:function(a){this._super(a)},getRestClass:function(){return a},
getRestType:function(){return"TeamLayoutConfig"},supportsRequests:!1,supportsSubscriptions:!1,getLayoutXML:function(){this.isLoaded();var a=this.getData().layoutxml;return a=a.replace(/&amp;/g,"&")},getUseDefault:function(){this.isLoaded();return this.getData().useDefault},get:function(){this._id="0";this._loaded=!1;this._collection={};this._synchronize();return this},createPutSuccessHandler:function(a,c,d){return function(b){b.object=c;a._processResponse(b);b.object={};d(b)}},put:function(a,c){this._id=
"0";this.isLoaded();var b=a.layoutXML.replace(/&(?!amp;)/g,"&amp;"),d={},b=b.replace(/<gadget>\s*(\S+)\s*<\/gadget>/g,"<gadget>$1</gadget>");d[this.getRestType()]={useDefault:a.useDefault,layoutxml:finesse.utilities.Utilities.translateHTMLEntities(b,!0)};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,d,c.success),error:c.error,content:d});return this},getRestUrl:function(){if(void 0===this._restObj)throw new Exception("TeamLayoutConfig instances must have a parent team object.");
return this._restObj.getRestUrl()+"/LayoutConfig"}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamLayoutConfig=a});h("restservices/TeamWorkflow",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d)},getRestClass:function(){return f},getRestType:function(){return"Workflow"},supportsRequests:!1,supportsSubscriptions:!1,getName:function(){this.isLoaded();return this.getData().name},
getDescription:function(){this.isLoaded();return this.getData().description},getUri:function(){this.isLoaded();return this.getData().uri}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamWorkflow=f});h("restservices/TeamWorkflows",["restservices/RestCollectionBase","restservices/TeamWorkflow","restservices/RestBase"],function(g,f,d){var a=g.extend({init:function(a){this._super(a)},getRestClass:function(){return a},
getRestItemClass:function(){return f},getRestType:function(){return"Workflows"},getRestUrl:function(){var a=this._restObj,c="",c=a instanceof d?c+a.getRestUrl():c+"/finesse/api/Team";this._id&&(c+="/"+this._id);return c+"/Workflows"},getRestItemType:function(){return"Workflow"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this},createPutSuccessHandler:function(a,c,d){return function(b){b.object=c;a._processResponse(b);
b.object={};d(b)}},update:function(a,c){this.isLoaded();var b={},d=[],f,g;b[this.getRestType()]={};for(f in a)a.hasOwnProperty(f)&&(g={uri:a[f]},d.push(g));b[this.getRestType()]={Workflow:d};c=c||{};this.restRequest(this.getRestUrl(),{method:"PUT",success:this.createPutSuccessHandler(this,b,c.success),error:c.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamWorkflows=a});h("restservices/TeamMessage",
["restservices/RestBase"],function(g){g=g.extend({init:function(f){this._super(f)},getRestClass:function(){throw Error("getRestClass(): Not implemented in subtype.");},getRestType:function(){return"TeamMessage"},supportsRequests:!1,supportsSubscriptions:!1,getTeamMessageUri:function(){this.isLoaded();return this.getData().uri},getId:function(){this.isLoaded();return this.getData().id},getCreatedBy:function(){this.isLoaded();return this.getData().createdBy},getCreatedAt:function(){this.isLoaded();
return this.getData().createdAt},getDuration:function(){this.isLoaded();return this.getData().duration},getContent:function(){this.isLoaded();return this.getData().content},add:function(f,d){var a={};a[this.getRestType()]={duration:f.expires,content:f.message,teams:f.teams};d=d||{};this.restRequest(this.getRestUrl(),{method:"POST",success:d.success,error:d.error,content:a});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamMessage=
g});h("restservices/TeamMessages",["restservices/RestCollectionBase","restservices/RestBase","restservices/TeamMessage","utilities/Utilities"],function(g,f,d,a){var b=g.extend({init:function(a){this._super(a)},getRestClass:function(){return b},getRestItemClass:function(){return d},getRestType:function(){return"teamMessages"},getRestItemType:function(){return"TeamMessage"},supportsRequests:!0,supportsSubscriptions:!0,supportsRestItemSubscriptions:!0,getBroadcastMessages:function(){this.isLoaded();
return this.getData},getRestUrl:function(){if(void 0===this._restObj)throw new Exception("Broadcast message instances must have a parent team object.");return this._restObj.getRestUrl()+"/TeamMessages"},_buildCollection:function(b){var c,d,f;if(b&&null!==this.getProperty(b,this.getRestItemType()))for(f=a.getArray(this.getProperty(b,this.getRestItemType())),b=0;b<f.length;b+=1)c={},c[this.getRestItemType()]=f[b],d=c[this.getRestItemType()].id,this._collection[d]=new (this.getRestItemClass())({id:d,
data:c,parentObj:this._restObj}),this.length+=1}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.TeamMessages=b});h("restservices/Team","restservices/RestBase utilities/Utilities restservices/Users restservices/TeamNotReadyReasonCodes restservices/TeamWrapUpReasons restservices/TeamSignOutReasonCodes restservices/TeamPhoneBooks restservices/TeamLayoutConfig restservices/TeamWorkflows restservices/TeamMessages".split(" "),
function(g,f,d,a,b,c,e,p,k,q){g=g.extend({_teamLayoutConfig:null,init:function(a){this._super(a)},getRestClass:function(){return finesse.restesrvices.Team},getRestType:function(){return"Team"},supportsSubscriptions:!1,getId:function(){this.isLoaded();return this.getData().id},getName:function(){this.isLoaded();return this.getData().name},getUri:function(){this.isLoaded();return this.getData().uri},getUsers:function(a){this.isLoaded();a=a||{};a.parentObj=this;a.data=this.getData();return new d(a)},
getTeamNotReadyReasonCodes:function(b){b=b||{};b.parentObj=this;this.isLoaded();this._teamNotReadyReasonCodes||(this._teamNotReadyReasonCodes=new a(b));return this._teamNotReadyReasonCodes},getTeamWrapUpReasons:function(a){a=a||{};a.parentObj=this;this.isLoaded();this._teamWrapUpReasons||(this._teamWrapUpReasons=new b(a));return this._teamWrapUpReasons},getTeamSignOutReasonCodes:function(a){a=a||{};a.parentObj=this;this.isLoaded();this._teamSignOutReasonCodes||(this._teamSignOutReasonCodes=new c(a));
return this._teamSignOutReasonCodes},getTeamPhoneBooks:function(a){a=a||{};a.parentObj=this;this.isLoaded();this._phonebooks||(this._phonebooks=new e(a));return this._phonebooks},getTeamWorkflows:function(a){a=a||{};a.parentObj=this;this.isLoaded();this._workflows||(this._workflows=new k(a));return this._workflows},getTeamLayoutConfig:function(a){a=a||{};a.parentObj=this;this.isLoaded();null===this._teamLayoutConfig&&(this._teamLayoutConfig=new p(a));return this._teamLayoutConfig},getTeamMessages:function(a){a=
a||{};a.parentObj=this;this.isLoaded();this._teamMessages||(this._teamMessages=new q(a));return this._teamMessages}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Team=g});h("restservices/Teams",["restservices/RestCollectionBase","restservices/Team"],function(g,f){var d=g.extend({init:function(a){this._super(a)},getRestClass:function(){return d},getRestItemClass:function(){return f},getRestType:function(){return"Teams"},
getRestItemType:function(){return"Team"},supportsRequests:!0,supportsRestItemSubscriptions:!1,get:function(){this._loaded=!1;this._collection={};this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Teams=d});h("restservices/SystemInfo",["restservices/RestBase"],function(g){var f=g.extend({supportsSubscriptions:!1,doNotRefresh:!0,_fakeConstuctor:function(){},init:function(d,a,b){this._super(d,
a,b)},getRestClass:function(){return f},getRestType:function(){return"SystemInfo"},_validate:function(d){return!0},getStatus:function(){this.isLoaded();return this.getData().status},getLastCTIHeartbeatStatus:function(){this.isLoaded();return this.getData().lastCTIHeartbeatStatus},getCtiTimeInMMode:function(){this.isLoaded();return this.getData().ctiTimeInMMode},getCtiMMode:function(){this.isLoaded();return this.getData().ctiMMode},getFinesseTimeInMMode:function(){this.isLoaded();return this.getData().finesseTimeInMMode},
getFinesseMMode:function(){this.isLoaded();return this.getData().finesseMMode},getCtiServers:function(){this.isLoaded();return this.getData().ctiServers},getStatusReason:function(){this.isLoaded();return this.getData().statusReason},getCurrentTimestamp:function(){this.isLoaded();return this.getData().currentTimestamp},getXmppDomain:function(){this.isLoaded();return this.getData().xmppDomain},getXmppPubSubDomain:function(){this.isLoaded();return this.getData().xmppPubSubDomain},getDeploymentType:function(){this.isLoaded();
return this.getData().deploymentType},isSingleNode:function(){var d=this.getData().secondaryNode;return d&&d.host?!1:!0},getAlternateHost:function(){var d=!1,a=this.getData().primaryNode,b=this.getData().secondaryNode,c=this.getData().xmppDomain;if(a&&a.host&&(c===a.host&&(d=!0),b&&b.host))return d?b.host:a.host},getPeripheralId:function(){this.isLoaded();return null===this.getData().peripheralId?"":this.getData().peripheralId},getlicense:function(){this.isLoaded();return this.getData().license||
""},getSystemAuthMode:function(){this.isLoaded();return this.getData().systemAuthMode},getCtiVersion:function(){this.isLoaded();return this.getData().ctiVersion},getHeartbeatInterval:function(){this.isLoaded();return this.getData().ctiHeartbeatInterval},getFailoverTimeSlot:function(){this.isLoaded();return this.getData().failoverTimeSlot},getTimeZoneOffset:function(){this.isLoaded();return this.getData().timezoneOffset}});f.Statuses={IN_SERVICE:"IN_SERVICE",OUT_OF_SERVICE:"OUT_OF_SERVICE",_fakeConstructor:function(){}};
f.Deployments={UCCX:"UCCX",UCCE:"UCCE",_fakeConstructor:function(){}};f.MMode={IN_PROGRESS:"IN_PROGRESS",FAILED:"FAILED",COMPLETED:"COMPLETED",EMPTY:"",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.SystemInfo=f});h("restservices/DialogLogoutActions",[],function(){var g={CLOSE:"CLOSE",TRANSFER:"TRANSFER",_fakeConstructor:function(){},isValidAction:function(f){return f?g.hasOwnProperty(f.toUpperCase()):
!1}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.DialogLogoutActions=g});h("restservices/InterruptActions",[],function(){var g={ACCEPT:"ACCEPT",IGNORE:"IGNORE",_fakeConstructor:function(){},isValidAction:function(f){return f?g.hasOwnProperty(f.toUpperCase()):!1}};window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.InterruptActions=g});h("restservices/ReasonCodeLookup",
["restservices/RestBase","utilities/Utilities","restservices/TeamResource"],function(g,f,d){var a=g.extend({supportsSubscriptions:!1,doNotRefresh:!0,autoSubscribe:!1,supportsRequests:!1,_fakeConstuctor:function(){},init:function(a){this._super(a)},doGet:function(a){},getRestClass:function(){return a},getRestType:function(){return"ReasonCode"},_parseIdFromUriString:function(a){return f.getId(a)},lookupReasonCode:function(a,c,e){this._teamResource||(this._teamResource=new d({teamId:(finesse.container?
finesse.container:finesse.gadget).Config.teamId}));this._teamResource.lookupReasonCode(a,c,e)}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.ReasonCodeLookup=a});h("restservices/ChatConfig",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super("",d)},getRestClass:function(){return f},getRestType:function(){return"ChatConfig"},getRestUrl:function(){return"/finesse/api/"+this.getRestType()},
supportsSubscriptions:!1,getPrimaryNode:function(){this.isLoaded();return this.getData().primaryNode},getSecondaryNode:function(){this.isLoaded();return this.getData().secondaryNode},get:function(){this._synchronize();return this},createPutSuccessHandler:function(d,a,b){return function(c){c.object.ChatConfig=a;d._processResponse(c);c.object.ChatConfig={};b(c)}},update:function(d,a){this.isLoaded();var b={};b[this.getRestType()]={primaryNode:d.primaryNode,secondaryNode:d.secondaryNode};a=a||{};this.restRequest(this.getRestUrl(),
{method:"PUT",success:this.createPutSuccessHandler(this,d,a.success),error:a.error,content:b});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.ChatConfig=f});h("restservices/ECCVariableConfig.js",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super("",d)},getRestClass:function(){return f},getRestType:function(){return"ECCVariableConfig"},getRestUrl:function(){return"/finesse/api/"+
this.getRestType()},supportsSubscriptions:!1,get:function(){this._synchronize();return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.ECCVariableConfig=f});h("utilities/I18n",["utilities/Utilities"],function(g){var f=function(){var d;return{setGetter:function(a){d=a},getString:function(a){var b,c,e="";d||(finesse.container&&finesse.container.I18n?d=finesse.container.I18n.getMsg:gadgets&&(b=new gadgets.Prefs,
d=b.getMsg));try{var f=d(a);c="string"===typeof f?f.replace(/&apos;/g,"'"):f}catch(k){e="finesse.utilities.I18n.getString(): invalid _getMsg"}if(c){c=[c];for(b=1;b<arguments.length;b+=1)c.push(arguments[b]);return g.formatString.apply(this,c)}b=function(){return"???"+a+"???"+e};b.toString=function(){return"???"+a+"???"+e};return b}}}();window.finesse=window.finesse||{};window.finesse.utilities=window.finesse.utilities||{};return window.finesse.utilities.I18n=f});h("utilities/Logger",[],function(){return function(){var g,
f=function(a){return 10>a?"0"+a:a},d=function(){var a=!1;try{void 0!==window.console&&(a=!0)}catch(c){a=!1}return a},a=function(){var a=new Date;return f(a.getHours())+":"+f(a.getMinutes())+":"+f(a.getSeconds())};return{setDebug:function(a){g=a},log:function(b){var c=a();g&&d()&&window.console.log(c+": DEBUG - "+b)},info:function(b){var c=a();d()&&window.console.info(c+": INFO - "+b)},warn:function(b){var c=a();d()&&window.console.warn(c+": WARN - "+b)},error:function(b){var c=a();d()&&window.console.error(c+
": ERROR - "+b)}}}()});h("utilities/BackSpaceHandler",[],function(){var g=function(f){var d=!1,a=f.srcElement||f.target;8===f.keyCode&&(d="INPUT"===a.tagName.toUpperCase()&&("TEXT"===a.type.toUpperCase()||"PASSWORD"===a.type.toUpperCase()||"FILE"===a.type.toUpperCase()||"SEARCH"===a.type.toUpperCase()||"EMAIL"===a.type.toUpperCase()||"NUMBER"===a.type.toUpperCase()||"DATE"===a.type.toUpperCase())||"TEXTAREA"===a.tagName.toUpperCase()?a.readOnly||a.disabled:!a.isContentEditable);d&&f.preventDefault()};
window.addEventListener?window.addEventListener("keydown",g):window.attachEvent?window.attachEvent("onkeydown",g):window.console.error("Unable to attach backspace handler event ")});!function(g,f){"function"==typeof h&&h.amd?h("utilities/../../thirdparty/tv4/tv4.min.js",[],f):"undefined"!=typeof module&&module.exports?module.exports=f():g.tv4=f()}(this,function(){function g(a){return encodeURI(a).replace(/%25[0-9][0-9]/g,function(a){return"%"+a.substring(3)})}function f(a){var b="";l[a.charAt(0)]&&
(b=a.charAt(0),a=a.substring(1));var c="",d="",e=!0,f=!1,w=!1;"+"===b?e=!1:"."===b?(d=".",c="."):"/"===b?(d="/",c="/"):"#"===b?(d="#",e=!1):";"===b?(d=";",c=";",f=!0,w=!0):"?"===b?(d="?",c="&",f=!0):"&"===b&&(d="&",c="&",f=!0);b=[];a=a.split(",");for(var k=[],p=0;p<a.length;p++){var h=a[p],m=null;-1!==h.indexOf(":")&&(m=h.split(":"),h=m[0],m=parseInt(m[1],10));for(var q={};r[h.charAt(h.length-1)];)q[h.charAt(h.length-1)]=!0,h=h.substring(0,h.length-1);k.push({truncate:m,name:h,suffices:q});b.push(h)}a=
function(a){for(var b="",v=0,A=0;A<k.length;A++){var y=k[A],E=a(y.name);if(null===E||void 0===E||Array.isArray(E)&&0===E.length||"object"==typeof E&&0===Object.keys(E).length)v++;else if(b+=A===v?d:c||",",Array.isArray(E)){f&&(b+=y.name+"=");for(var l=0;l<E.length;l++)0<l&&(b+=y.suffices["*"]?c||",":",",y.suffices["*"]&&f&&(b+=y.name+"=")),b+=e?encodeURIComponent(E[l]).replace(/!/g,"%21"):g(E[l])}else if("object"==typeof E){f&&!y.suffices["*"]&&(b+=y.name+"=");var l=!0,p;for(p in E)l||(b+=y.suffices["*"]?
c||",":","),l=!1,b+=e?encodeURIComponent(p).replace(/!/g,"%21"):g(p),b+=y.suffices["*"]?"=":",",b+=e?encodeURIComponent(E[p]).replace(/!/g,"%21"):g(E[p])}else f&&(b+=y.name,w&&""===E||(b+="=")),null!=y.truncate&&(E=E.substring(0,y.truncate)),b+=e?encodeURIComponent(E).replace(/!/g,"%21"):g(E)}return b};return a.varNames=b,{prefix:d,substitution:a}}function d(a){if(!(this instanceof d))return new d(a);for(var b=a.split("{"),c=[b.shift()],e=[],v=[],g=[];0<b.length;){var w=b.shift(),k=w.split("}")[0],
w=w.substring(k.length+1),k=f(k);v.push(k.substitution);e.push(k.prefix);c.push(w);g=g.concat(k.substitution.varNames)}this.fill=function(a){for(var b=c[0],d=0;d<v.length;d++)b+=(0,v[d])(a),b+=c[d+1];return b};this.varNames=g;this.template=a}function a(b,c){if(b===c)return!0;if(b&&c&&"object"==typeof b&&"object"==typeof c){if(Array.isArray(b)!==Array.isArray(c))return!1;if(Array.isArray(b)){if(b.length!==c.length)return!1;for(var d=0;d<b.length;d++)if(!a(b[d],c[d]))return!1}else{for(d in b)if(void 0===
c[d]&&void 0!==b[d])return!1;for(d in c)if(void 0===b[d]&&void 0!==c[d])return!1;for(d in b)if(!a(b[d],c[d]))return!1}return!0}return!1}function b(a){return(a=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/))?{href:a[0]||"",protocol:a[1]||"",authority:a[2]||"",host:a[3]||"",hostname:a[4]||"",port:a[5]||"",pathname:a[6]||"",search:a[7]||"",hash:a[8]||""}:null}function c(a,c){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,
"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return c=b(c||""),a=b(a||""),c&&a?(c.protocol||a.protocol)+(c.protocol||c.authority?c.authority:a.authority)+d(c.protocol||c.authority||"/"===c.pathname.charAt(0)?c.pathname:c.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+c.pathname:a.pathname)+(c.protocol||c.authority||c.pathname?
c.search:c.search||a.search)+c.hash:null}function e(a){return a.split("#")[0]}function p(a,b){if(a&&"object"==typeof a)if(void 0===b?b=a.id:"string"==typeof a.id&&(b=c(b,a.id),a.id=b),Array.isArray(a))for(var d=0;d<a.length;d++)p(a[d],b);else for(d in"string"==typeof a.$ref&&(a.$ref=c(b,a.$ref)),a)"enum"!==d&&p(a[d],b)}function k(a){var b=C[a||"en"];return function(a){var c=b[a.code]||F[a.code];if("string"!=typeof c)return"Unknown error code "+a.code+": "+JSON.stringify(a.messageParams);var d=a.params;
return c.replace(/\{([^{}]*)\}/g,function(a,b){var c=d[b];return"string"==typeof c||"number"==typeof c?c:a})}}function q(a,b,c,d,e){if(Error.call(this),void 0===a)throw Error("No error code supplied: "+d);this.message="";this.params=b;this.code=a;this.dataPath=c||"";this.schemaPath=d||"";this.subErrors=e||null;a=Error(this.message);if(this.stack=a.stack||a.stacktrace,!this.stack)try{throw a;}catch(E){this.stack=E.stack||E.stacktrace}}function m(a){var b,d,f=new h,g={setErrorReporter:function(a){return"string"==
typeof a?this.language(a):(d=a,!0)},addFormat:function(){f.addFormat.apply(f,arguments)},language:function(a){return a?(C[a]||(a=a.split("-")[0]),C[a]?(b=a,a):!1):b},addLanguage:function(a,b){for(var c in t)b[c]&&!b[t[c]]&&(b[t[c]]=b[c]);var d=a.split("-")[0];if(C[d])for(c in C[a]=Object.create(C[d]),b)"undefined"==typeof C[d][c]&&(C[d][c]=b[c]),C[a][c]=b[c];else C[a]=b,C[d]=b;return this},freshApi:function(a){var b=m();return a&&b.language(a),b},validate:function(a,c,e,g){var v=k(b);e=new h(f,!1,
d?function(a,b,c){return d(a,b,c)||v(a,b,c)}:v,e,g);"string"==typeof c&&(c={$ref:c});e.addSchema("",c);var w=e.validateAll(a,c,null,null,"");return!w&&g&&(w=e.banUnknownProperties(a,c)),this.error=w,this.missing=e.missing,this.valid=null===w,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(a,c,e,g){var v=k(b);e=new h(f,!0,d?function(a,b,c){return d(a,b,c)||v(a,b,c)}:v,e,g);"string"==typeof c&&(c={$ref:c});e.addSchema("",c);e.validateAll(a,
c,null,null,"");g&&e.banUnknownProperties(a,c);a={};return a.errors=e.errors,a.missing=e.missing,a.valid=0===a.errors.length,a},addSchema:function(){return f.addSchema.apply(f,arguments)},getSchema:function(){return f.getSchema.apply(f,arguments)},getSchemaMap:function(){return f.getSchemaMap.apply(f,arguments)},getSchemaUris:function(){return f.getSchemaUris.apply(f,arguments)},getMissingUris:function(){return f.getMissingUris.apply(f,arguments)},dropSchemas:function(){f.dropSchemas.apply(f,arguments)},
defineKeyword:function(){f.defineKeyword.apply(f,arguments)},defineError:function(a,b,c){if("string"!=typeof a||!/^[A-Z]+(_[A-Z]+)*$/.test(a))throw Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof b||0!==b%1||1E4>b)throw Error("Code number must be an integer > 10000");if("undefined"!=typeof t[a])throw Error("Error already defined: "+a+" as "+t[a]);if("undefined"!=typeof D[b])throw Error("Error code already used: "+D[b]+" as "+b);t[a]=b;D[b]=a;F[a]=F[b]=c;for(var d in C)c=
C[d],c[a]&&(c[b]=c[b]||c[a])},reset:function(){f.reset();this.error=null;this.missing=[];this.valid=!0},missing:[],error:null,valid:!0,normSchema:p,resolveUrl:c,getDocumentUri:e,errorCodes:t};return g.language(a||"en"),g}Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=c.length;return function(e){if("object"!=typeof e&&
"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[],g;for(g in e)a.call(e,g)&&f.push(g);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&f.push(c[g]);return f}}());Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(1<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(0<d||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(d=0<=d?d:Math.max(c-Math.abs(d),0);c>d;d++)if(d in b&&b[d]===a)return d;return-1});Object.isFrozen||(Object.isFrozen=function(a){for(var b="tv4_test_frozen_key";a.hasOwnProperty(b);)b+=Math.random();try{return a[b]=
!0,delete a[b],!1}catch(y){return!0}});var l={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},r={"*":!0};d.prototype={toString:function(){return this.template},fillFromObject:function(a){return this.fill(function(b){return a[b]})}};var h=function(a,b,c,d,e){if(this.missing=[],this.missingMap={},this.formatValidators=a?Object.create(a.formatValidators):{},this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError,d&&(this.checkRecursive=
!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),e&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=c||k("en"),"string"==typeof this.errorReporter)throw Error("debug");if(this.definedKeywords={},a)for(var f in a.definedKeywords)this.definedKeywords[f]=a.definedKeywords[f].slice(0)};h.prototype.defineKeyword=
function(a,b){this.definedKeywords[a]=this.definedKeywords[a]||[];this.definedKeywords[a].push(b)};h.prototype.createError=function(a,b,c,d,e,f,g){a=new q(a,b,c,d,e);return a.message=this.errorReporter(a,f,g),a};h.prototype.returnError=function(a){return a};h.prototype.collectError=function(a){return a&&this.errors.push(a),null};h.prototype.prefixErrors=function(a,b,c){for(;a<this.errors.length;a++)this.errors[a]=this.errors[a].prefixWith(b,c);return this};h.prototype.banUnknownProperties=function(a,
b){for(var c in this.unknownPropertyPaths){var d=this.createError(t.UNKNOWN_PROPERTY,{path:c},c,"",null,a,b);if(d=this.handleError(d))return d}return null};h.prototype.addFormat=function(a,b){if("object"==typeof a){for(var c in a)this.addFormat(c,a[c]);return this}this.formatValidators[a]=b};h.prototype.resolveRefs=function(a,b){if(void 0!==a.$ref){if(b=b||{},b[a.$ref])return this.createError(t.CIRCULAR_REFERENCE,{urls:Object.keys(b).join(", ")},"","",null,void 0,a);b[a.$ref]=!0;a=this.getSchema(a.$ref,
b)}return a};h.prototype.getSchema=function(a,b){var c;if(void 0!==this.schemas[a])return c=this.schemas[a],this.resolveRefs(c,b);var d=a,e="";if(-1!==a.indexOf("#")&&(e=a.substring(a.indexOf("#")+1),d=a.substring(0,a.indexOf("#"))),"object"==typeof this.schemas[d]){c=this.schemas[d];e=decodeURIComponent(e);if(""===e)return this.resolveRefs(c,b);if("/"!==e.charAt(0))return;for(var e=e.split("/").slice(1),f=0;f<e.length;f++){var g=e[f].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===c[g]){c=void 0;
break}c=c[g]}if(void 0!==c)return this.resolveRefs(c,b)}void 0===this.missing[d]&&(this.missing.push(d),this.missing[d]=d,this.missingMap[d]=d)};h.prototype.searchSchemas=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this.searchSchemas(a[c],b);else if(a&&"object"==typeof a){var d;if(d="string"==typeof a.id)a:{d=a.id;if(d.substring(0,b.length)===b){var f=d.substring(b.length);if(0<d.length&&"/"===d.charAt(b.length-1)||"#"===f.charAt(0)||"?"===f.charAt(0)){d=!0;break a}}d=!1}d&&void 0===
this.schemas[a.id]&&(this.schemas[a.id]=a);for(c in a)"enum"!==c&&("object"==typeof a[c]?this.searchSchemas(a[c],b):"$ref"===c&&(d=e(a[c]))&&void 0===this.schemas[d]&&void 0===this.missingMap[d]&&(this.missingMap[d]=d))}};h.prototype.addSchema=function(a,b){if("string"!=typeof a||"undefined"==typeof b){if("object"!=typeof a||"string"!=typeof a.id)return;b=a;a=b.id}a===e(a)+"#"&&(a=e(a));this.schemas[a]=b;delete this.missingMap[a];p(b,a);this.searchSchemas(b,a)};h.prototype.getSchemaMap=function(){var a=
{},b;for(b in this.schemas)a[b]=this.schemas[b];return a};h.prototype.getSchemaUris=function(a){var b=[],c;for(c in this.schemas)a&&!a.test(c)||b.push(c);return b};h.prototype.getMissingUris=function(a){var b=[],c;for(c in this.missingMap)a&&!a.test(c)||b.push(c);return b};h.prototype.dropSchemas=function(){this.schemas={};this.reset()};h.prototype.reset=function(){this.missing=[];this.missingMap={};this.errors=[]};h.prototype.validateAll=function(a,b,c,d,e){var f;if(b=this.resolveRefs(b),!b)return null;
if(b instanceof q)return this.errors.push(b),b;var g,v=this.errors.length,k=null,l=null;if(this.checkRecursive&&a&&"object"==typeof a){if(f=!this.scanned.length,a[this.validatedSchemasKey]){var p=a[this.validatedSchemasKey].indexOf(b);if(-1!==p)return this.errors=this.errors.concat(a[this.validationErrorsKey][p]),null}if(Object.isFrozen(a)&&(g=this.scannedFrozen.indexOf(a),-1!==g)&&(p=this.scannedFrozenSchemas[g].indexOf(b),-1!==p))return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[g][p]),
null;if(this.scanned.push(a),Object.isFrozen(a))-1===g&&(g=this.scannedFrozen.length,this.scannedFrozen.push(a),this.scannedFrozenSchemas.push([])),k=this.scannedFrozenSchemas[g].length,this.scannedFrozenSchemas[g][k]=b,this.scannedFrozenValidationErrors[g][k]=[];else{if(!a[this.validatedSchemasKey])try{Object.defineProperty(a,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(a,this.validationErrorsKey,{value:[],configurable:!0})}catch(I){a[this.validatedSchemasKey]=[],a[this.validationErrorsKey]=
[]}l=a[this.validatedSchemasKey].length;a[this.validatedSchemasKey][l]=b;a[this.validationErrorsKey][l]=[]}}p=this.errors.length;b=this.validateBasic(a,b,e)||this.validateNumeric(a,b,e)||this.validateString(a,b,e)||this.validateArray(a,b,e)||this.validateObject(a,b,e)||this.validateCombinations(a,b,e)||this.validateHypermedia(a,b,e)||this.validateFormat(a,b,e)||this.validateDefinedKeywords(a,b,e)||null;if(f){for(;this.scanned.length;)delete this.scanned.pop()[this.validatedSchemasKey];this.scannedFrozen=
[];this.scannedFrozenSchemas=[]}if(b||p!==this.errors.length)for(;c&&c.length||d&&d.length;)f=c&&c.length?""+c.pop():null,e=d&&d.length?""+d.pop():null,b&&(b=b.prefixWith(f,e)),this.prefixErrors(p,f,e);return null!==k?this.scannedFrozenValidationErrors[g][k]=this.errors.slice(v):null!==l&&(a[this.validationErrorsKey][l]=this.errors.slice(v)),this.handleError(b)};h.prototype.validateFormat=function(a,b){if("string"!=typeof b.format||!this.formatValidators[b.format])return null;var c=this.formatValidators[b.format].call(null,
a,b);return"string"==typeof c||"number"==typeof c?this.createError(t.FORMAT_CUSTOM,{message:c},"","/format",null,a,b):c&&"object"==typeof c?this.createError(t.FORMAT_CUSTOM,{message:c.message||"?"},c.dataPath||"",c.schemaPath||"/format",null,a,b):null};h.prototype.validateDefinedKeywords=function(a,b,c){for(var d in this.definedKeywords)if("undefined"!=typeof b[d])for(var e=this.definedKeywords[d],f=0;f<e.length;f++){var g=(0,e[f])(a,b[d],b,c);if("string"==typeof g||"number"==typeof g)return this.createError(t.KEYWORD_CUSTOM,
{key:d,message:g},"","",null,a,b).prefixWith(null,d);if(g&&"object"==typeof g){c=g.code;if("string"==typeof c){if(!t[c])throw Error("Undefined error code (use defineError): "+c);c=t[c]}else"number"!=typeof c&&(c=t.KEYWORD_CUSTOM);e="object"==typeof g.message?g.message:{key:d,message:g.message||"?"};d=g.schemaPath||"/"+d.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(c,e,g.dataPath||null,d,null,a,b)}}return null};h.prototype.validateBasic=function(a,b,c){var d;return(d=this.validateType(a,
b,c))?d.prefixWith(null,"type"):(d=this.validateEnum(a,b,c))?d.prefixWith(null,"type"):null};h.prototype.validateType=function(a,b){if(void 0===b.type)return null;var c=typeof a;null===a?c="null":Array.isArray(a)&&(c="array");var d=b.type;Array.isArray(d)||(d=[d]);for(var e=0;e<d.length;e++){var f=d[e];if(f===c||"integer"===f&&"number"===c&&0===a%1)return null}return this.createError(t.INVALID_TYPE,{type:c,expected:d.join("/")},"","",null,a,b)};h.prototype.validateEnum=function(b,c){if(void 0===c["enum"])return null;
for(var d=0;d<c["enum"].length;d++)if(a(b,c["enum"][d]))return null;return this.createError(t.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(b):b},"","",null,b,c)};h.prototype.validateNumeric=function(a,b,c){return this.validateMultipleOf(a,b,c)||this.validateMinMax(a,b,c)||this.validateNaN(a,b,c)||null};var n=Math.pow(2,-51),B=1-n;h.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;if(void 0===c)return null;if("number"==typeof a){var d=a/c%1;if(d>=n&&B>d)return this.createError(t.NUMBER_MULTIPLE_OF,
{value:a,multipleOf:c},"","",null,a,b)}return null};h.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!==b.minimum){if(a<b.minimum)return this.createError(t.NUMBER_MINIMUM,{value:a,minimum:b.minimum},"","/minimum",null,a,b);if(b.exclusiveMinimum&&a===b.minimum)return this.createError(t.NUMBER_MINIMUM_EXCLUSIVE,{value:a,minimum:b.minimum},"","/exclusiveMinimum",null,a,b)}if(void 0!==b.maximum){if(a>b.maximum)return this.createError(t.NUMBER_MAXIMUM,{value:a,maximum:b.maximum},
"","/maximum",null,a,b);if(b.exclusiveMaximum&&a===b.maximum)return this.createError(t.NUMBER_MAXIMUM_EXCLUSIVE,{value:a,maximum:b.maximum},"","/exclusiveMaximum",null,a,b)}return null};h.prototype.validateNaN=function(a,b){return"number"!=typeof a?null:!0===isNaN(a)||a===1/0||a===-(1/0)?this.createError(t.NUMBER_NOT_A_NUMBER,{value:a},"","/type",null,a,b):null};h.prototype.validateString=function(a,b,c){return this.validateStringLength(a,b,c)||this.validateStringPattern(a,b,c)||null};h.prototype.validateStringLength=
function(a,b){return"string"!=typeof a?null:void 0!==b.minLength&&a.length<b.minLength?this.createError(t.STRING_LENGTH_SHORT,{length:a.length,minimum:b.minLength},"","/minLength",null,a,b):void 0!==b.maxLength&&a.length>b.maxLength?this.createError(t.STRING_LENGTH_LONG,{length:a.length,maximum:b.maxLength},"","/maxLength",null,a,b):null};h.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||"string"!=typeof b.pattern&&!(b.pattern instanceof RegExp))return null;var c;if(b.pattern instanceof
RegExp)c=b.pattern;else{var d="",e=b.pattern.match(/^\/(.+)\/([img]*)$/);e?(c=e[1],d=e[2]):c=b.pattern;c=new RegExp(c,d)}return c.test(a)?null:this.createError(t.STRING_PATTERN,{pattern:b.pattern},"","/pattern",null,a,b)};h.prototype.validateArray=function(a,b,c){return Array.isArray(a)?this.validateArrayLength(a,b,c)||this.validateArrayUniqueItems(a,b,c)||this.validateArrayItems(a,b,c)||null:null};h.prototype.validateArrayLength=function(a,b){var c;return void 0!==b.minItems&&a.length<b.minItems&&
(c=this.createError(t.ARRAY_LENGTH_SHORT,{length:a.length,minimum:b.minItems},"","/minItems",null,a,b),this.handleError(c))?c:void 0!==b.maxItems&&a.length>b.maxItems&&(c=this.createError(t.ARRAY_LENGTH_LONG,{length:a.length,maximum:b.maxItems},"","/maxItems",null,a,b),this.handleError(c))?c:null};h.prototype.validateArrayUniqueItems=function(b,c){if(c.uniqueItems)for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)if(a(b[d],b[e])){var f=this.createError(t.ARRAY_UNIQUE,{match1:d,match2:e},"",
"/uniqueItems",null,b,c);if(this.handleError(f))return f}return null};h.prototype.validateArrayItems=function(a,b,c){if(void 0===b.items)return null;var d,e;if(Array.isArray(b.items))for(e=0;e<a.length;e++)if(e<b.items.length){if(d=this.validateAll(a[e],b.items[e],[e],["items",e],c+"/"+e))return d}else{if(void 0!==b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(d=this.createError(t.ARRAY_ADDITIONAL_ITEMS,{},"/"+e,"/additionalItems",null,a,b),this.handleError(d)))return d}else if(d=
this.validateAll(a[e],b.additionalItems,[e],["additionalItems"],c+"/"+e))return d}else for(e=0;e<a.length;e++)if(d=this.validateAll(a[e],b.items,[e],["items"],c+"/"+e))return d;return null};h.prototype.validateObject=function(a,b,c){return"object"!=typeof a||null===a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b,c)||this.validateObjectRequiredProperties(a,b,c)||this.validateObjectProperties(a,b,c)||this.validateObjectDependencies(a,b,c)||null};h.prototype.validateObjectMinMaxProperties=
function(a,b){var c,d=Object.keys(a);return void 0!==b.minProperties&&d.length<b.minProperties&&(c=this.createError(t.OBJECT_PROPERTIES_MINIMUM,{propertyCount:d.length,minimum:b.minProperties},"","/minProperties",null,a,b),this.handleError(c))?c:void 0!==b.maxProperties&&d.length>b.maxProperties&&(c=this.createError(t.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:d.length,maximum:b.maxProperties},"","/maxProperties",null,a,b),this.handleError(c))?c:null};h.prototype.validateObjectRequiredProperties=function(a,
b){if(void 0!==b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]&&(d=this.createError(t.OBJECT_REQUIRED,{key:d},"","/required/"+c,null,a,b),this.handleError(d)))return d}return null};h.prototype.validateObjectProperties=function(a,b,c){var d,e;for(e in a){var f=c+"/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),g=!1;if(void 0!==b.properties&&void 0!==b.properties[e]&&(g=!0,d=this.validateAll(a[e],b.properties[e],[e],["properties",e],f)))return d;if(void 0!==b.patternProperties)for(var k in b.patternProperties)if((new RegExp(k)).test(e)&&
(g=!0,d=this.validateAll(a[e],b.patternProperties[k],[e],["patternProperties",k],f)))return d;if(g)this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]);else if(void 0!==b.additionalProperties)if(this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]),"boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(d=this.createError(t.OBJECT_ADDITIONAL_PROPERTIES,{key:e},"","/additionalProperties",null,a,b).prefixWith(e,
null),this.handleError(d)))return d}else{if(d=this.validateAll(a[e],b.additionalProperties,[e],["additionalProperties"],f))return d}else this.trackUnknownProperties&&!this.knownPropertyPaths[f]&&(this.unknownPropertyPaths[f]=!0)}return null};h.prototype.validateObjectDependencies=function(a,b,c){var d;if(void 0!==b.dependencies)for(var e in b.dependencies)if(void 0!==a[e]){var f=b.dependencies[e];if("string"==typeof f){if(void 0===a[f]&&(d=this.createError(t.OBJECT_DEPENDENCY_KEY,{key:e,missing:f},
"","",null,a,b).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(Array.isArray(f))for(var g=0;g<f.length;g++){var k=f[g];if(void 0===a[k]&&(d=this.createError(t.OBJECT_DEPENDENCY_KEY,{key:e,missing:k},"","/"+g,null,a,b).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(d=this.validateAll(a,f,[],["dependencies",e],c))return d}return null};h.prototype.validateCombinations=function(a,b,c){return this.validateAllOf(a,b,c)||
this.validateAnyOf(a,b,c)||this.validateOneOf(a,b,c)||this.validateNot(a,b,c)||null};h.prototype.validateAllOf=function(a,b,c){if(void 0===b.allOf)return null;for(var d,e=0;e<b.allOf.length;e++)if(d=this.validateAll(a,b.allOf[e],[],["allOf",e],c))return d;return null};h.prototype.validateAnyOf=function(a,b,c){if(void 0===b.anyOf)return null;var d,e,f=[],g=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var k=!0,l=0;l<b.anyOf.length;l++){this.trackUnknownProperties&&
(this.unknownPropertyPaths={},this.knownPropertyPaths={});var p=this.errors.length,h=this.validateAll(a,b.anyOf[l],[],["anyOf",l],c);if(null===h&&p===this.errors.length){if(this.errors=this.errors.slice(0,g),this.trackUnknownProperties){for(var m in this.knownPropertyPaths)e[m]=!0,delete d[m];for(var q in this.unknownPropertyPaths)e[q]||(d[q]=!0);k=!1;continue}return null}h&&f.push(h.prefixWith(null,""+l).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=
e),k?(f=f.concat(this.errors.slice(g)),this.errors=this.errors.slice(0,g),this.createError(t.ANY_OF_MISSING,{},"","/anyOf",f,a,b)):void 0};h.prototype.validateOneOf=function(a,b,c){if(void 0===b.oneOf)return null;var d,e,f=null,g=[],k=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var l=0;l<b.oneOf.length;l++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var p=this.errors.length,h=this.validateAll(a,
b.oneOf[l],[],["oneOf",l],c);if(null===h&&p===this.errors.length){if(null!==f)return this.errors=this.errors.slice(0,k),this.createError(t.ONE_OF_MULTIPLE,{index1:f,index2:l},"","/oneOf",null,a,b);if(f=l,this.trackUnknownProperties){for(var m in this.knownPropertyPaths)e[m]=!0,delete d[m];for(var q in this.unknownPropertyPaths)e[q]||(d[q]=!0)}}else h&&g.push(h)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===f?(g=g.concat(this.errors.slice(k)),this.errors=
this.errors.slice(0,k),this.createError(t.ONE_OF_MISSING,{},"","/oneOf",g,a,b)):(this.errors=this.errors.slice(0,k),null)};h.prototype.validateNot=function(a,b,c){if(void 0===b.not)return null;var d,e,f=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});c=this.validateAll(a,b.not,null,null,c);var g=this.errors.slice(f);return this.errors=this.errors.slice(0,f),this.trackUnknownProperties&&
(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===c&&0===g.length?this.createError(t.NOT_PASSED,{},"","/not",null,a,b):null};h.prototype.validateHypermedia=function(a,b,c){if(!b.links)return null;for(var e,f=0;f<b.links.length;f++)if(e=b.links[f],"describedby"===e.rel){e=new d(e.href);for(var g=!0,k=0;k<e.varNames.length;k++)if(!(e.varNames[k]in a)){g=!1;break}if(g&&(e={$ref:e.fillFromObject(a)},e=this.validateAll(a,e,[],["links",f],c)))return e}};var t={INVALID_TYPE:0,ENUM_MISMATCH:1,
ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,
FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1E3},D={},z;for(z in t)D[t[z]]=z;var F={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",
NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",
STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",
ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};q.prototype=Object.create(Error.prototype);q.prototype.constructor=q;q.prototype.name="ValidationError";
q.prototype.prefixWith=function(a,b){if(null!==a&&(a=a.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+a+this.dataPath),null!==b&&(b=b.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+b+this.schemaPath),null!==this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this};var C={};z=m();return z.addLanguage("en-gb",F),z.tv4=z,z});h("utilities/JsonValidator",["../../thirdparty/tv4/tv4.min.js"],function(g){var f={_fakeConstuctor:function(){},
validateJson:function(d,a){var b=g.validate(d,a),c={};c.valid=b;b||(c.error=g.error);return c}};window.finesse=window.finesse||{};window.finesse.utilities=window.finesse.utilities||{};return window.finesse.utilities.JsonValidator=f});h("cslogger/FinesseLogger",["clientservices/ClientServices","utilities/Utilities"],function(g,f){var d=function(){var a=[],b=!1;_logStr="";_logSize=0;_loggingInitialized=_sendLogShown=!1;_maxLocalStorageSize=5E6;_halfMaxLocalStorageSize=.5*_maxLocalStorageSize;_purgeStartPercent=
.75;_sessionKey=_session=_linePrefix=null;_logInfo={};_userObject=_findSessionsObj=null;_myConsoleLog=function(a){void 0!==window.console&&window.console.log(a)};_initLogging=function(){!_loggingInitialized&&(_session=sessionStorage.getItem("finSessKey"))&&(_sessionKey="Fi"+_session,_linePrefix=_sessionKey+"_",_logInfo={},_logInfo.name=_session,_logInfo.size=0,_logInfo.head=0,_logInfo.tail=0,_logInfo.startTime=(new Date).getTime(),_loggingInitialized=!0,_initSessionList())};_getTotalData=function(){var a,
b,d,f=0;d=localStorage.getItem("FinesseSessionsInfo");if(!d)return 0;d=JSON.parse(d);for(a in d.sessions)d.sessions.hasOwnProperty(a)&&((b=localStorage.getItem("Fi"+a))?(b=JSON.parse(b),f+=b.size):_myConsoleLog("_getTotalData failed to get log info for "+a));return f};_purgeCurrentSession=function(){var a,b,d,f;a=_getTotalData();if(!(a<_halfMaxLocalStorageSize)&&(f=localStorage.getItem(_sessionKey))){for(f=JSON.parse(f);a>_halfMaxLocalStorageSize;){try{if(d=_sessionKey+"_"+f.tail,b=localStorage.getItem(d))localStorage.removeItem(d),
a-=b.length,f.size-=b.length}catch(q){_myConsoleLog("purgeCurrentSession encountered err="+q)}if(f.tail<f.head)f.tail+=1;else break}localStorage.getItem(_sessionKey)&&(localStorage.setItem(_sessionKey,JSON.stringify(f)),_myConsoleLog("Done _purgeCurrentSession() - currentStoreSize="+a))}};_purgeSession=function(a){var b,c;b=localStorage.getItem("Fi"+a);if(!b)return _myConsoleLog("_purgeSession failed to get logInfo for "+a),0;for(b=JSON.parse(b);b.tail<=b.head;)try{localStorage.removeItem("Fi"+a+
"_"+b.tail),b.tail+=1}catch(k){_myConsoleLog("In _purgeSession err="+k);break}localStorage.removeItem("Fi"+a);c=localStorage.getItem("FinesseSessionsInfo");if(!c)return _myConsoleLog("_purgeSession could not get sessions Info, it was cleared?"),0;c=JSON.parse(c);null!==c.sessions&&(delete c.sessions[a],--c.total,c.lastWrittenBy=_session,localStorage.setItem("FinesseSessionsInfo",JSON.stringify(c)));return b.size};_purgeOldSessions=function(a){var b;a=0;var c,d,f;b=localStorage.getItem("FinesseSessionsInfo");
if(!b)return _myConsoleLog("Could not get FinesseSessionsInfo"),!0;d=JSON.parse(b);b=_getTotalData();f=_session;d=d.sessions;for(c in d)if(d.hasOwnProperty(c)&&c!==f&&(a+=_purgeSession(c),b-a<_halfMaxLocalStorageSize))return!0;return!1};_insertLineHandleError=function(a){_myConsoleLog(a)};_checkSizeAndPurge=function(){var a;a=_getTotalData();a>.75*_maxLocalStorageSize&&(_myConsoleLog("in _checkSizeAndPurge, totalSize ("+a+") exceeds limit"),(a=_purgeOldSessions(a))?_myConsoleLog("in _checkSizeAndPurge after purging old session, purge is done"):
(a=_getTotalData(),a>.75*_maxLocalStorageSize&&(_myConsoleLog("in _checkSizeAndPurge after purging old session,still needs purging, now storeSize ("+a+")"),_purgeCurrentSession(),_myConsoleLog("in _checkSizeAndPurge done purging current session."))))};_sessionsInfoContains=function(a,b){return a&&a.sessions&&a.sessions.hasOwnProperty(b)?!0:!1};_getAndSetNumberOfSessions=function(a){var b;b=localStorage.getItem("FinesseSessionsInfo");if(null===b)b={total:1,sessions:{}},b.sessions[a.name]=a.startTime,
b.lastWrittenBy=a.name,localStorage.setItem("FinesseSessionsInfo",JSON.stringify(b));else{b=JSON.parse(b);if(_sessionsInfoContains(b,a.name))return;b.total=parseInt(b.total,10)+1;b.sessions[a.name]=a.startTime;b.lastWrittenBy=a.name;localStorage.setItem("FinesseSessionsInfo",JSON.stringify(b));a=localStorage.getItem("FinesseSessionsInfo");if(!a){_myConsoleLog("Could not get FinesseSessionsInfo");return}JSON.parse(a)}localStorage.getItem(_sessionKey)||localStorage.setItem(_sessionKey,JSON.stringify(_logInfo))};
_initSessionList=function(){_getAndSetNumberOfSessions(_logInfo)};_persistLine=function(a){var b;b=localStorage.getItem(_sessionKey);null!==b&&(_logInfo=JSON.parse(b),_logInfo.head+=1,localStorage.setItem(_linePrefix+_logInfo.head,a),_logInfo.size+=a.length,0===_logInfo.tail&&(_logInfo.tail=_logInfo.head),localStorage.setItem(_sessionKey,JSON.stringify(_logInfo)),_checkSizeAndPurge())};_insertLine=function(a){try{_persistLine(a)}catch(e){_myConsoleLog("error in _insertLine(), err="+e)}};_clearLocalStorage=
function(){localStorage.clear()};getIntValue=function(a,b){try{return parseInt(a)}catch(p){return b}};checkIfLogCollectionSchedulePresentInSession=function(){return(logCollDataObj=JSON.parse(sessionStorage.getItem(window.finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA)||null))&&!0===logCollDataObj.isDesktopAutoLogScheduled&&null!=logCollDataObj.logSchedule};_collectMethod=function(c){var e,h=getIntValue(window.finesse.container.Config.clientLogSize,1572864);e=f.getSanitizedUserAgentString()+"&#10;";
e=escape(e);_sendLogShown||(_sendLogShown=!0,_logSize=e.length);"true"===window.sessionStorage.getItem("enableLocalLog")&&c&&(0<c.length&&"\n"===c.substring(0,1)?_insertLine(c.substring(1)):_insertLine(c));c=c.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"&#10;");c=c.replace(/[\x00-\x1F\x7F-\x9F]/g,"");c=escape(c+"\n");if(c.length<h)for(;_logSize+c.length>h;)checkIfLogCollectionSchedulePresentInSession()&&!b&&_userObject&&
(g.log("FinesseLogger._collectMethod(): Posting the logs once to server as the memory logs exceeded maximum allowed length"),e={success:d.logPostedOnOverloadSuccess,error:d.logPostedOnOverloadFailure},g.log("FinesseLogger._collectMethod(): Setting the flag _triedLogPostOnceOnOverload to true as there will be no retry posting in case of error"),b=!0,d.publishCompressedClientLog(_userObject,{},e)),_logSize-=a.shift().length;a.push(c);_logSize+=c.length};return{init:function(){g.subscribe("finesse.clientLogging.*",
_collectMethod);_initLogging()},initSubscription:function(b,d){d=d||{};_userObject=b||null;var c=d.onAdd&&"function"===typeof d.onAdd?d.onAdd:function(){};d.onAdd=function(b){c(b);b&&b._data&&b._data.schedule||(_logSize=a.length=0,_sendLogShown=!1)};b.getClientLog(d)},clear:function(){_clearLocalStorage()},initLocalLog:function(){_initLogging()},localLog:function(a){_insertLine(a)},addLogDataToSessionStorage:function(){var b=JSON.parse(sessionStorage.getItem(finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA)||
null);checkIfLogCollectionSchedulePresentInSession()&&(b.scheduledLogArrayData=a||[],sessionStorage.setItem(finesse.utilities.Utilities.CONSTANTS.LOG_COLL_DATA,JSON.stringify(b)))},setLogPostedFalse:function(){b=!1},logPostedOnOverloadSuccess:function(){g.log("FinesseLogger.logPostedOnOverloadSuccess(): posted logs successfully")},logPostedOnOverloadFailure:function(a){g.log("FinesseLogger.logPostedOnOverloadFailure(): logs posting failed:Status:"+a.status+",Content:"+a.content)},publishLocalStorageCompressedFile:function(a,
b,d){b=b||{};d=d||{};var c=new JSZip,e="Desktop-Client-LocalStorageLog."+a.getId()+(b.logScheduleId?".schedule"+b.logScheduleId:"")+"."+(new Date).toISOString()+".txt";c.file(e,window.finesse.modules.LocalStorageViewer.getContents(null,null));c.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:9}}).then(function(c){b.uploadzipfile=c;b.onLoad=function(a){a.sendLogs(b.uploadzipfile,{error:d.error,success:d.success,isZip:!0})};a.getClientLog(b)})},publishCompressedClientLog:function(b,
d,g,k){d=d||{};g=g||{};"function"===g.sending&&g.sending();_logStr=f.getSanitizedUserAgentString()+"&#10;";_logStr=k&&0<k.length?_logStr+unescape(k.join("")):_logStr+unescape(a.join(""));k="Desktop-ClientLog."+b.getId()+(d.logScheduleId?".schedule"+d.logScheduleId:"")+"."+(new Date).toISOString()+".txt";_logStr=_logStr.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#10;/g,"");var c=new JSZip;c.file(k,_logStr);c.generateAsync({type:"blob",
compression:"DEFLATE",compressionOptions:{level:9}}).then(function(c){d.uploadzipfile=c;var e=d.onAdd&&"function"===typeof d.onAdd?d.onAdd:function(){};d.onAdd=function(){e();_logSize=a.length=0;_sendLogShown=!1;g.success()};d.onLoad=function(a){a.sendLogs(d.uploadzipfile,{error:g.error,success:d.onAdd,isZip:!0})};b.getClientLog(d)})},publish:function(b,d,g){d=d||{};g=g||{};"function"===g.sending&&g.sending();_logStr=f.getSanitizedUserAgentString()+"&#10;";_logStr+=unescape(a.join(""));var c={ClientLog:{logData:_logStr}},
e=d.onAdd&&"function"===typeof d.onAdd?d.onAdd:function(){};d.onAdd=function(){e();_logSize=a.length=0;_sendLogShown=!1};d.onLoad=function(a){a.sendLogs(c,{error:g.error})};b.getClientLog(d)}}}();window.finesse=window.finesse||{};window.finesse.cslogger=window.finesse.cslogger||{};return window.finesse.cslogger.FinesseLogger=d});h("containerservices/Topics",[],function(){var g=function(){this.namespace="finesse.containerservices";var f=function(d){return this.namespace+"."+d};return{REQUESTS:f("requests"),
RELOAD_GADGET:f("reloadGadget"),getTopic:function(d){0===d.indexOf("/")&&(d=d.substr(1));return d.replace(/\//g,".")}}}();window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};window.finesse.containerservices.Topics=g;finesse.containerservices=finesse.containerservices||{};return g});h("containerservices/MasterPublisher",["utilities/Utilities","containerservices/Topics"],function(g,f){var d=function(){var a=gadgets.Hub,b={log:finesse.clientservices.ClientServices.log},
c={ACTIVETAB:"ActiveTabReq",SET_ACTIVETAB:"SetActiveTabReq",RELOAD_GADGET:"ReloadGadgetReq"},d=function(d,e){if("object"===typeof e&&"string"===typeof e.type&&"object"===typeof e.data)switch(e.type){case c.ACTIVETAB:a.publish("finesse.containerservices.activeTab",finesse.container.Tabs.getActiveTab());break;case c.SET_ACTIVETAB:"string"===typeof e.data.id&&(b.log("Handling request to activate tab: "+e.data.id),finesse.container.Tabs.activateTab(e.data.id));break;case c.RELOAD_GADGET:a.publish("finesse.containerservices.reloadGadget",
e.data)}};a.subscribe(f.REQUESTS,d);this.beginTestSection=0;this.getTestObject=function(){var b=new MockControl;a=b.createMock(gadgets.Hub);return{mock:b,hub:a,reqtypes:c,clientRequestHandler:d}};this.endTestSection=0};window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.MasterPublisher=d});h("containerservices/WorkflowActionEvent",["FinesseBase"],function(g){g=g.extend({_name:null,_type:null,_handledBy:null,
_params:[],_actionVariables:[],init:function(){this._super()},setWorkflowActionEvent:function(f){!0===f.hasOwnProperty("name")&&!0===f.hasOwnProperty("type")&&!0===f.hasOwnProperty("handledBy")&&!0===f.hasOwnProperty("params")&&!0===f.hasOwnProperty("actionVariables")?(this._name=f.name,this._type=f.type,this._handledBy=f.handledBy,this._params=f.params,this._actionVariables=f.actionVariables,f=!0):f=!1;return f},getName:function(){return this._name||""},getType:function(){return this._type||""},
getHandledBy:function(){return this._handledBy||""},getParams:function(){var f={},d=this._params,a,b;if(null===d||0===d.length)return f;for(a=0;a<d.length;a+=1)b=d[a],b.name=b.name||"",b.value=b.value||"",b.expandedValue=b.expandedValue||"",f[b.name]=b;return f},getActionVariables:function(){var f={},d=this._actionVariables,a,b;if(null===d||0===d.length)return f;for(a=0;a<d.length;a+=1)b=d[a],b.name=b.name||"",b.type=b.type||"",b.node=b.node||"",b.testValue=b.testValue||"",b.actualValue=b.actualValue||
"",f[b.name]=b;return f}});g.HandledBy={FINESSE:"FINESSE",OTHER:"OTHER",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.WorkflowActionEvent=g});h("containerservices/TimerTickEvent",["FinesseBase"],function(g){g=g.extend({_dateQueued:null,_tickFrequency:1E3,init:function(f,d){this._super();this._tickFrequency=f;this._dateQueued=d},getTickFrequency:function(){return this._tickFrequency},
getDateQueued:function(){return this._dateQueued}});window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.TimerTickEvent=g});h("containerservices/GadgetViewChangedEvent",["FinesseBase"],function(g){g=g.extend({_gadgetId:null,_tabId:null,_maxAvailableHeight:null,_view:null,init:function(f,d,a,b){this._super();this._gadgetId=f;this._tabId=d;this._maxAvailableHeight=a;this._view=b},getGadgetId:function(){return this._gadgetId||
""},getMaxAvailableHeight:function(){return this._maxAvailableHeight||""},getTabId:function(){return this._tabId||""},getView:function(){return this._view||""}});window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.GadgetViewChangedEvent=g});h("containerservices/MaxAvailableHeightChangedEvent",["FinesseBase"],function(g){g=g.extend({_maxAvailableHeight:null,init:function(f){this._super();this._maxAvailableHeight=
f},getMaxAvailableHeight:function(){return this._maxAvailableHeight||""}});window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.MaxAvailableHeightChangedEvent=g});h("containerservices/ContainerServices","utilities/Utilities restservices/Notifier containerservices/Topics containerservices/MasterPublisher containerservices/WorkflowActionEvent containerservices/TimerTickEvent containerservices/GadgetViewChangedEvent containerservices/MaxAvailableHeightChangedEvent".split(" "),
function(g,f,d,a,b){b=function(){var b,e,h=!1,k=!1,q={log:finesse.clientservices.ClientServices.log},m={},l,r={},u=null,n=!1,B,t,D=function(a){var b,c;switch(a){case "finesse.containerservices.tabbedGadget.activeTab":b=y;break;case finesse.containerservices.ContainerServices.Topics.ACTIVE_TAB:b=A;break;case finesse.containerservices.ContainerServices.Topics.WORKFLOW_ACTION_EVENT:b=_workflowActionEventTracker;break;case finesse.containerservices.ContainerServices.Topics.RELOAD_GADGET_EVENT:b=_masterReloader;
break;case finesse.containerservices.ContainerServices.Topics.GADGET_VIEW_CHANGED_EVENT:b=_gadgetViewChanged;break;case finesse.containerservices.ContainerServices.Topics.MAX_AVAILABLE_HEIGHT_CHANGED_EVENT:b=_maxAvailableHeightChanged;break;case finesse.containerservices.ContainerServices.Topics.ACCESS_TOKEN_REFRESHED_EVENT:b=_accessTokenRefreshed;break;case finesse.containerservices.ContainerServices.Topics.FINESSE_MAINTENANCE_MODE_EVENT:b=_maintenaceModeChange;break;default:b=function(b){c=F(a);
c.notifyListeners(1===arguments.length?b:arguments)}}return b},z=function(){if(!k)throw Error("ContainerServices needs to be inited.");return k},F=function(a){r.hasOwnProperty(a)||(r[a]=new f);return r[a]},C=function(a,b){z();return m[a]?!1:(m[a]=e.subscribe(a,function(a,c){b(c)}),!0)},w=function(){String.prototype.startsWith||(String.prototype.startsWith=function(a,b){b=b||0;return this.indexOf(a,b)===b});if(t){var a;gadgets&&gadgets.Prefs&&(a=gadgets.Prefs(),a=a.getString("routeName"));if(a)u=a;
else if(u=t.route.getAllRoute()[$(frameElement).closest("div[data-group-id]").attr("data-group-id")-1])u=u.startsWith("#/")?u.slice(2):u;else{var b=(a=$(frameElement).closest(".gadgets-gadget-content").parent())?a.attr("id"):"";b&&t.core.runtimeGadgets.forEach(function(a){a.attributes.id===b&&(u=a.navId)})}}else if(null===u)try{u=$(frameElement).closest("div.tab-panel").attr("id").replace("panel_","")}catch(K){q.log("Error accessing current tab: "+K.message),u=null}return u},A=function(a){a===w()?
n||(n=!0,r[finesse.containerservices.ContainerServices.Topics.ACTIVE_TAB].notifyListeners(this)):n=!1},y=function(a){a===$(frameElement).closest(".tabbed-gadget-frame").attr("id")?(n||(n=!0,r["finesse.containerservices.tabbedGadget.activeTab"].notifyListeners(this)),e&&(a={data:{tabId:a},invokeID:(new Date).getTime()},e.publish("finesse.containerservices.tabbedGadget.tabActivationComplete",a))):n=!1},x=function(a){q.log("Sending request to activate tab: "+a);if(e)if(_isLeftNavBarItem(a)){var b={type:"SetActiveTabReq",
data:{id:a},invokeID:(new Date).getTime()};e.publish(B.REQUESTS,b);if(_isTabbedgadget()){var b=_getTabbedGadgetId(),c=_getTabbedGadget(b);void 0!==c.navId&&c.navId!==a||e.publish("finesse.containerservices.tabbedGadget.requests",{reqType:"activateTab",tabId:b})}}else _activateTabbedGadget(a);else throw Error("Hub is not defined.");};_gadgetViewChanged=function(a){a&&(a=new finesse.containerservices.GadgetViewChangedEvent(a.gadgetId,a.tabId,a.maxAvailableHeight,a.view),r[finesse.containerservices.ContainerServices.Topics.GADGET_VIEW_CHANGED_EVENT].notifyListeners(a))};
_getGadgetViewConfig=function(a){return window.top.finesse.containerservices.gadgetViewConfig[a]};_maxAvailableHeightChanged=function(a){a&&(a=new finesse.containerservices.MaxAvailableHeightChangedEvent(a.maxAvailableHeight),r[finesse.containerservices.ContainerServices.Topics.MAX_AVAILABLE_HEIGHT_CHANGED_EVENT].notifyListeners(a))};_workflowActionEventTracker=function(a){var b=new finesse.containerservices.WorkflowActionEvent;b.setWorkflowActionEvent(a)&&r[finesse.containerservices.ContainerServices.Topics.WORKFLOW_ACTION_EVENT].notifyListeners(b)};
_maintenaceModeChange=function(a){a&&r[finesse.containerservices.ContainerServices.Topics.FINESSE_MAINTENANCE_MODE_EVENT].notifyListeners(a)};_masterReloader=function(a,b){var c=b.gadgetId;c&&l.reloadGadget(c)};_toggleGadgetExpandCollapse=function(a){a={type:a,options:{gadgetId:_findMyGadgetId()}};parent.postMessage(a,"*")};_findMyGadgetId=function(){if(gadgets&&gadgets.util&&gadgets.util.getUrlParameters())return gadgets.util.getUrlParameters().mid};_isTabbedgadget=function(){return 0<$(frameElement).closest(".tabbed-gadget-frame").length&&
!_isManagedByTPG()};_showTitleInPageLevelGadget=function(a){var b=document.getElementById("finesse_gadget_"+a).closest(".page-level");a&&b&&(a=b.getElementsByClassName("gadgets-gadget-title-bar")[0])&&(a.setAttribute("style","display:flex !important"),b.firstElementChild.style.alignItems="start")};_getTabbedGadgetId=function(){return $(frameElement).closest(".tabbed-gadget-frame").attr("id")};_getTabbedGadgetContainerId=function(){return $(frameElement).closest(".cd-gadget-card").attr("id")};_isLeftNavBarItem=
function(a){if(t)return a="#"===a[0]?a:"#/"+a,-1<t.route.getAllRoute().indexOf(a)};_getTabbedGadget=function(a){var b=window.top.finesse.containerservices.tabbedGadgets.refs,c;for(c in b)for(var d=b[c].runtimeGadgetsConfig,e=0;e<d.length;e++)if(d[e].attributes.id===a)return d[e]};_activateTabbedGadget=function(a){var b=_getTabbedGadget(a);b?(q.log("Handling request to activate tabbed gadget: "+a),t&&b.navId&&t.route.changeRoute(b.navId),e.publish("finesse.containerservices.tabbedGadget.requests",
{reqType:"activateTab",tabId:a})):q.log("No tab or tabbed gadget found with id: "+a)};_activeTabFromTabbedGadgetReqHandler=function(a,b){var c;"ActiveTabReqForTabbedGadget"===a&&b&&(c=window.finesse.containerservices.tabbedGadgets.refs[b],c=c.navActiveTabMap&&c.navActiveTabMap[c.state.currentNavId],e.publish("finesse.containerservices.tabbedGadget.activeTab",c))};_setTabbedGadgetProps=function(){window.finesse.containerservices.tabbedGadgets.props={onTabChange:function(a){e.publish("finesse.containerservices.tabbedGadget.activeTab",
a)},onMaximize:function(){},onRestore:function(){},onCollapse:function(){},onExpand:function(){}}};_setComponentsTitleMapForTabbedGadgets=function(){var a=window.finesse.utilities.I18n;window.cd.core.runtimeComponentTitles={"queueStatistics.js":a.getString("gadget.queueStatistics.title"),"teamPerformance.js":a.getString("gadget.teamPerformance.title"),"callcontrol.js":a.getString("gadget.callcontrol.title")}};_hideMyGadget=function(){if(_isTabbedgadget())if(e)e.publish("finesse.containerservices.tabbedGadget.requests",
{reqType:"hideGadget",tabId:_getTabbedGadgetId(),tabbedGadgetContainerId:_getTabbedGadgetContainerId()});else throw Error("Hub is not defined.");else q.log("hideMyGadget API works only if the gadget is configured inside a Tabbed Gadget")};_showMyGadget=function(){if(_isTabbedgadget())if(e)e.publish("finesse.containerservices.tabbedGadget.requests",{reqType:"showGadget",tabId:_getTabbedGadgetId(),tabbedGadgetContainerId:_getTabbedGadgetContainerId()});else throw Error("Hub is not defined.");else q.log("showMyGadget API works only if the gadget is configured inside a Tabbed Gadget")};
_showMyGadgetNotification=function(){if(_isTabbedgadget())if(e)e.publish("finesse.containerservices.tabbedGadget.requests",{reqType:"notifyGadget",tabId:_getTabbedGadgetId(),tabbedGadgetContainerId:_getTabbedGadgetContainerId()});else throw Error("Hub is not defined.");else q.log("showMyGadgetNotification API works only if the gadget is configured inside a Tabbed Gadget")};_hideMyGadgetNotification=function(){if(_isTabbedgadget())if(e)e.publish("finesse.containerservices.tabbedGadget.requests",{reqType:"clearGadgetNotification",
tabId:_getTabbedGadgetId(),tabbedGadgetContainerId:_getTabbedGadgetContainerId()});else throw Error("Hub is not defined.");else q.log("_hideMyGadgetNotification API works only if the gadget is configured inside a Tabbed Gadget")};_isManagedByTPG=function(){return $(frameElement).closest(".ld-container-template").length};return{_fakeConstuctor:function(){},init:function(c){if(!k){k=!0;b=g;b.getAuthModes();try{t=window.top.cd}catch(E){q.log("Error accessing common desktop: "+E.message)}gadgets.Hub&&
(e=gadgets.Hub);d&&(B=d);c?(h=!0,l=finesse.container.Container,new a,t&&(window.finesse.containerservices.tabbedGadgets={props:{},refs:{}},e.subscribe("ActiveTabReqForTabbedGadget",_activeTabFromTabbedGadgetReqHandler),_setTabbedGadgetProps(),_setComponentsTitleMapForTabbedGadgets()),e.subscribe(B.RELOAD_GADGET,D(B.RELOAD_GADGET)),b.receiveMessage(function(a){"finesse.containerservices.enableTitleBar"===a.data.type&&_showTitleInPageLevelGadget(a.data.gadgetId)})):parent.finesse&&(l=parent.finesse.container.Container)}this.makeActiveTabReq();
finesse.modules&&finesse.modules.ToastPopover&&(finesse.ToastPopoverInstance=new finesse.modules.ToastPopover);window.finesse.containerservices.PopoverService&&window.finesse.containerservices.PopoverService.init(this);return this},showDialog:function(a){if(l&&l.showDialog&&l.showDialog!==this.showDialog)return l.showDialog(a);this.fallbackDialog||(this.fallbackDialog=$("<div />").dialog({autoOpen:!1,modal:!0,dialogClass:"finesse-fallback-dialog"}));this.hideDialog();return this.fallbackDialog.dialog({title:a.title,
buttons:a.buttons,close:a.close||this.hideDialog}).html(a.message).dialog("open")},hideDialog:function(){if(l&&l.hideDialog&&l.hideDialog!==this.hideDialog)return l.hideDialog();if(this.fallbackDialog)return this.fallbackDialog.dialog("close")},showCertificateBanner:function(a){if(void 0!==l.showCertificateBanner&&l.showCertificateBanner!==this.showCertificateBanner){var b={};b.id=window.finesse.containerservices.ContainerServices.getMyGadgetId();b.callback=a;return l.showCertificateBanner(b)}},hideCertificateBanner:function(a){if(void 0===
a&&void 0===window.finesse.containerservices.ContainerServices.getMyGadgetId())throw Error("ID returned when showCertificateBanner was called need to be sent as params");if(void 0!==l.hideCertificateBanner&&l.hideCertificateBanner!==this.hideCertificateBanner)return l.hideCertificateBanner(a||window.finesse.containerservices.ContainerServices.getMyGadgetId())},reloadMyGadget:function(){var a;if(!h){for(a in r)if(r.hasOwnProperty(a)){var b=a;z();e.unsubscribe(m[b]);delete m[b];delete r[a]}a=_findMyGadgetId();
a={type:"ReloadGadgetReq",data:{gadgetId:a},invokeID:(new Date).getTime()};e.publish(B.REQUESTS,a)}},enableTitleBar:function(){_isTabbedgadget()?q.log("Title bar cannot be enabled for tabbed gadgets"):self!==parent&&b.sendMessage({gadgetId:_findMyGadgetId(),type:"finesse.containerservices.enableTitleBar"})},reloadMyGadgetFromUrl:function(a){if(!h){var b=_findMyGadgetId();l.modifyGadgetUrl(b,a);this.reloadMyGadget()}},addHandler:function(a,c){z();var d=null;try{"tabVisible"===a&&(window.console&&"function"===
typeof window.console.log&&window.console.log("WARNING - Using tabVisible as topic.  This is deprecated.  Use finesse.containerservices.ContainerServices.Topics.ACTIVE_TAB now!"),a=finesse.containerservices.ContainerServices.Topics.ACTIVE_TAB),_isTabbedgadget()&&a===finesse.containerservices.ContainerServices.Topics.ACTIVE_TAB&&(a="finesse.containerservices.tabbedGadget.activeTab"),b.validateHandler(c),d=F(a),d.addListener(c),C(a,D(a))}catch(J){throw Error("addHandler(): "+J);}},removeHandler:function(a,
c){var d=null;try{b.validateHandler(c),d=F(a),d.removeListener(c)}catch(J){throw Error("removeHandler(): "+J);}},publish:function(a,b){if(e)e.publish(a,b);else throw Error("Hub is not defined.");},tabVisible:function(){return n},makeActiveTabReq:function(){if(e)if(_isTabbedgadget())e.publish("ActiveTabReqForTabbedGadget",_getTabbedGadgetContainerId());else{var a={type:"ActiveTabReq",data:{},invokeID:(new Date).getTime()};e.publish(B.REQUESTS,a)}else throw Error("Hub is not defined.");},activateTab:function(a){x(a)},
activateMyTab:function(){x(_isTabbedgadget()?_getTabbedGadgetId():w())},getMyTabId:function(){return w()},getMyGadgetId:function(){return _findMyGadgetId()},setMyGadgetTitle:function(a){q.log("Sending request to set gadget title to: "+a);if(_isTabbedgadget())if(e)e.publish("finesse.containerservices.tabbedGadget.requests",{reqType:"setTitle",tabId:_getTabbedGadgetId(),title:a});else throw Error("Hub is not defined.");else a={type:"SET_GADGET_TITLE",options:{gadgetId:_findMyGadgetId(),title:a}},parent.postMessage(a,
"*")},isTabbedGadget:function(){return _isTabbedgadget()},expandMyGadget:function(){if(_isTabbedgadget()){var a=_getTabbedGadgetId(),b=window.top.finesse.containerservices.tabbedGadgets.refs[_getTabbedGadgetContainerId()];!window.top.$("#"+a).hasClass("display-none")&&b.state.collapsed&&b.toggleCollapseExpand(a)}else _toggleGadgetExpandCollapse("EXPAND_GADGET")},collapseMyGadget:function(){if(_isTabbedgadget()){var a=_getTabbedGadgetId(),b=window.top.finesse.containerservices.tabbedGadgets.refs[_getTabbedGadgetContainerId()];
0<window.top.$("#"+a+":visible").length&&!b.state.collapsed&&b.toggleCollapseExpand(a)}else _toggleGadgetExpandCollapse("COLLAPSE_GADGET")},showMyGadget:function(){_showMyGadget()},hideMyGadget:function(){_hideMyGadget()},getMyGadgetView:function(){return _getGadgetViewConfig(_findMyGadgetId())},showMyGadgetNotification:function(){_showMyGadgetNotification()},hideMyGadgetNotification:function(){_hideMyGadgetNotification()},beginTestSection:0,getTestObject:function(){var a=new MockControl;b=a.createMock(g);
e=a.createMock(gadgets.Hub);k=!0;return{mock:a,hub:e,util:b,addHandler:this.addHandler,removeHandler:this.removeHandler}},endTestSection:0}}();b.Topics={ACTIVE_TAB:"finesse.containerservices.activeTab",WORKFLOW_ACTION_EVENT:"finesse.containerservices.workflowActionEvent",TIMER_TICK_EVENT:"finesse.containerservices.timerTickEvent",FINEXT_NON_VOICE_GADGET_EVENT:"finext.nv",ACTIVE_CALL_STATUS_EVENT:"finesse.containerservices.activeCallStatusEvent",FINEXT_POPOVER_EVENT:"finext.popover",RELOAD_GADGET_EVENT:"finesse.containerservices.reloadGadget",
GADGET_VIEW_CHANGED_EVENT:"finesse.containerservices.gadgetViewChangedEvent",MAX_AVAILABLE_HEIGHT_CHANGED_EVENT:"finesse.containerservices.maxAvailableHeightChangedEvent",FINESSE_MAINTENANCE_MODE_EVENT:"finesse.containerservices.maintenanceMode",_fakeConstructor:function(){}};window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.ContainerServices=b});h("containerservices/FinesseToaster",[],function(){var g=function(){var f=
8E3,d,a=!1,b,c=function(a,b){var c=b&&!isNaN(b)?b:f;return setTimeout(function(){a.close()},c)},e=function(){window.Notification&&"denied"!==window.Notification.permission?window.Notification.requestPermission(function(a){window.Notification.permission!==a&&(window.Notification.permission=a);d.log("FinesseToaster.requestPermission(): request permission status "+a)}):d.log("FinesseToaster.requestPermission(): Notification not supported or permission denied.")},g=function(a,b,c){a.onclick=function(){clearTimeout(c);
window.chrome&&parent.focus();if(b&&b.onclick)if("function"===typeof b.onclick)b.onclick();else throw Error("onclick callback must be a function");this.close()};a.onerror=function(){if(b&&b.onerror)if("function"===typeof b.onerror)b.onerror();else throw Error("onerror callback must be a function");}};return{_fakeConstuctor:function(){},TOASTER_DEFAULT_ICONS:{INCOMING_CALL_ICON:"/desktop/theme/finesse/images/modules/incoming_call.png",INCOMING_CHAT_ICON:"/desktop/theme/finesse/images/modules/incoming_chat.png",
INCOMING_TEAM_MESSAGE:"/desktop/theme/finesse/images/modules/incoming_team_message.png",ALERT_ICON:"/desktop/theme/finesse/images/modules/incoming-alert.png"},showToaster:function(e,h){if(!b)throw Error("FinesseToaster.showToaster() : Finesse toaster is not initialized");if(a)d.log("FinesseToaster.showToaster() : FinesseToaster is disabled");else{var k,l;h.tag="desktop";window.Notification&&"granted"===window.Notification.permission&&(!1===top.window.document.hasFocus()||h.showWhenVisible?d&&-1<f&&
(k=new window.Notification(e,h),l=c(k,h.autoClose),g(k,h,l)):d.log("FinesseToaster supressed : Page is visible and  FineeseToaster.options.showWhenVisible is false"));return k}},init:function(c,g){b=!0;d=g?g:finesse.cslogger.ClientLogger;c&&void 0!==c.toasterNotificationTimeout&&(f=1E3*Number(c.toasterNotificationTimeout),0===f&&(a=!0));e();return finesse.containerservices.FinesseToaster}}}();window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.FinesseToaster=
g});h("interfaces/RestObjectHandlers",["FinesseBase","utilities/Utilities","restservices/Notifier","clientservices/ClientServices","clientservices/Topics"],function(){var g=function(){return{_fakeConstuctor:function(){}}}();window.finesse=window.finesse||{};window.finesse.interfaces=window.finesse.interfaces||{};return window.finesse.interfaces.RestObjectHandlers=g});h("interfaces/RequestHandlers",["FinesseBase","utilities/Utilities","restservices/Notifier","clientservices/ClientServices","clientservices/Topics"],
function(){var g=function(){return{_fakeConstuctor:function(){}}}();window.finesse=window.finesse||{};window.finesse.interfaces=window.finesse.interfaces||{};window.finesse.interfaces.RequestHandlers=g;finesse=finesse||{};finesse.interfaces=finesse.interfaces||{};return g});h("gadget/Config",["utilities/Utilities"],function(g){var f=function(){if(gadgets&&gadgets.Prefs){var d=new gadgets.Prefs,a={authorization:g.getUserAuthString()||d.getString("credentials")||d.getString("authorization"),authToken:g.getToken(),
country:d.getString("country"),language:d.getString("language"),locale:d.getString("locale"),host:d.getString("host"),hostPort:d.getString("hostPort"),extension:d.getString("extension"),mobileAgentMode:d.getString("mobileAgentMode"),mobileAgentDialNumber:d.getString("mobileAgentDialNumber"),xmppDomain:d.getString("xmppDomain"),pubsubDomain:d.getString("pubsubDomain"),restHost:d.getString("restHost"),scheme:d.getString("scheme"),localhostFQDN:d.getString("localhostFQDN"),localhostPort:d.getString("localhostPort"),
teamId:d.getString("teamId"),teamName:d.getString("teamName"),clientDriftInMillis:d.getInt("clientDriftInMillis"),compatibilityMode:d.getString("compatibilityMode"),peripheralId:d.getString("peripheralId"),systemAuthMode:d.getString("systemAuthMode"),toasterNotificationTimeout:d.getString("toasterNotificationTimeout"),navItemRoute:d.getString("navItemRoute"),speechRecognitionHighlights:d.getString("speechRecognitionHighlights"),_fakeConstructor:function(){}};"UCCE"===d.getString("deploymentType")&&
(a.cceSkillTargetId=d.getString("cceSkillTargetId"),a.enableDropParticipantFor=d.getString("enableDropParticipantFor"),a.dropParticipant=d.getString("dropParticipant"));return a}return{}}();window.finesse=window.finesse||{};window.finesse.container=window.finesse.container||{};window.finesse.container.Config=window.finesse.container.Config||f;window.finesse.gadget=window.finesse.gadget||{};return window.finesse.gadget.Config=f});h("digital/ChannelSchema",["require","exports","module"],function(g,
f,d){g=function(){var a={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string"},menuItems:{type:"array",uniqueItems:!0,items:[{type:"object",properties:{id:{type:"string"},label:{type:"string"},iconColor:{type:"string","enum":["available","unavailable","busy"]}},required:["id","label","iconColor"],additionalProperties:!1}]}},required:["label","menuItems"],additionalProperties:!1},b={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{actionTimeoutInSec:{type:"integer",
minimum:1,maximum:30},icons:{type:"array",minItems:1,items:[{type:"object",properties:{type:{type:"string","enum":["collab-icon","url"]},value:{type:"string"}},required:["type","value"],additionalProperties:!1}]}},required:["actionTimeoutInSec","icons"],additionalProperties:!1},c={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string"},currentState:{type:"string"},iconColor:{type:"string"},enable:{type:"boolean"},logoutDisabled:{type:"boolean"},logoutDisabledText:{type:"string"},
iconBadge:{type:"string","enum":["error","info","warning","none"]},hoverText:{type:"string"}},required:"label currentState iconColor enable logoutDisabled iconBadge".split(" "),additionalProperties:!1};return{_fakeConstuctor:function(){},getMenuConfigSchema:function(){return a},getChannelConfigSchema:function(){return b},getChannelStateSchema:function(){return c}}}();window.finesse=window.finesse||{};window.finesse.digital=window.finesse.digital||{};window.finesse.digital.ChannelSchema=g;"object"===
typeof d&&d.exports&&(d.exports=g);return g});h("digital/ChannelService","require exports module ./ChannelSchema ../utilities/JsonValidator ../utilities/Utilities ../clientservices/ClientServices".split(" "),function(g,f,d){f=function(){var a=g("./ChannelSchema"),b=g("../utilities/JsonValidator"),c=g("../utilities/Utilities"),d,f=!1,k={log:g("../clientservices/ClientServices").log},h,m=Object.freeze({ADD:"ADD",REMOVE:"REMOVE",UPDATE:"UPDATE",UPDATE_MENU:"UPDATE_MENU",UPDATE_CHANNEL_STATE:"UPDATE_CHANNEL_STATE"}),
l=Object.freeze({SUCCESS:"success",FAILURE:"failure"}),r=Object.freeze({AVAILABLE:"available",UNAVAILABLE:"unavailable",BUSY:"busy"}),n=Object.freeze({available:"#2CB14C",unavailable:"#CF4237",busy:"#D79208"}),G=Object.freeze({COLLAB_ICON:"collab-icon",URL:"url"}),B=Object.freeze({NONE:"none",INFO:"info",WARNING:"warning",ERROR:"error"}),t=function(){var a={},b=function(b){a[b]&&(a[b].pendingTimer&&clearTimeout(a[b].pendingTimer),delete a[b])},c=function(c){a[c].pendingTimer=setTimeout(function(){var d=
{status:"failure",error:{errorCode:"408",errorDesc:"Request Timed Out"}};a[c]&&"function"===typeof a[c].error&&(k.log("ChannelService: Request Timeout. Request Id : "+c),a[c].error(d));b(c)},6E4)};return{register:function(b,d,e,f){a[b]={channelId:d,success:e,error:f};c(b)},clear:b,success:function(c,d){if(a[c]&&"function"===typeof a[c].success){d.channelId=a[c].channelId;var e=a[c].success(d);b(c);return e}},error:function(c,d){if(a[c]&&"function"===typeof a[c].error){d.channelId=a[c].channelId;var e=
a[c].error(d);b(c);return e}}}}(),D=function(){var a={};return{register:function(b,c,d){a[b]={channelId:c,menuHandler:d}},clear:function(b){a[b]&&delete a[b]},menuSelection:function(b,c,d,e){if(a[b]&&a[b].menuHandler)return a[b].menuHandler(a[b].channelId,c,d,e)}}}(),z=function(c){c=b.validateJson(c,a.getMenuConfigSchema());if(!c.valid)throw k.log("ChannelService: Finesse Nonvoice API Validation result : "+JSON.stringify(c)),Error("menuConfig structure is not in expected format. Refer finesse client logs for more details.");
},F=function(c){c=b.validateJson(c,a.getChannelConfigSchema());if(!c.valid)throw k.log("ChannelService: Finesse Nonvoice API Validation result : "+JSON.stringify(c)),Error("channelConfig structure is not in expected format. Refer finesse client logs for more details.");},C=function(c){c=b.validateJson(c,a.getChannelStateSchema());if(!c.valid)throw k.log("ChannelService: Finesse Nonvoice API Validation result : "+JSON.stringify(c)),Error("channelState structure is not in expected format. Refer finesse client logs for more details.");
},w=function(a,b){switch(b){case m.ADD:a.hasOwnProperty("channelState")&&(a.channelState.iconColor=n[a.channelState.iconColor]);a.menuConfig.menuItems.forEach(function(a){a.iconColor=n[a.iconColor]});break;case m.UPDATE:a.hasOwnProperty("channelState")&&(a.channelState.iconColor=n[a.channelState.iconColor]);a.hasOwnProperty("menuConfig")&&a.menuConfig.menuItems.forEach(function(a){a.iconColor=n[a.iconColor]});break;case m.UPDATE_CHANNEL_STATE:a.iconColor=n[a.iconColor];a={channelState:a};break;case m.UPDATE_MENU:a.menuItems.forEach(function(a){a.iconColor=
n[a.iconColor]}),a={menuConfig:a}}a.channelState&&(a.channelState.isAgentReady=a.channelState.iconColor===n.available);return a},A=function(a){D.menuSelection(a.id,a.selection,function(b){b={id:a.id,requestId:a.requestId,status:b.hasOwnProperty("status")?b.status:l.SUCCESS};d.publish(h,b)},function(b){var c={id:a.id,requestId:a.requestId,status:b.hasOwnProperty("status")?b.status:l.FAILURE};b.hasOwnProperty("error")&&(c.error=b.error);d.publish(h,c)})},y=function(a){k.log("ChannelService: Received Message from FNC: "+
JSON.stringify(a));try{a="string"===typeof a?JSON.parse(a):a}catch(K){k.log("ChannelService: Error while parsing the FNC message"+a);return}if(a.hasOwnProperty("selection"))A(a);else{var b={status:a.status};a.status===l.FAILURE?(a.hasOwnProperty("error")&&(b.error=a.error),k.log("ChannelService: Failure response for requestId: "+a.requestId),t.error(a.requestId,b)):t.success(a.requestId,b)}},x=function(a,b,e,g,l,p){k.log("ChannelService: Received digital channel request. ChannelId "+a+", Action "+
b+", Data "+JSON.stringify(l));if(!f)throw Error("ChannelService needs to be inited.");var r=(d.getMyGadgetId()||"")+"/"+a,q=h+"."+r;if(b===m.REMOVE)D.clear(r),d.removeHandler(q,y);else{if(!l)throw Error("ChannelService: Channel Data cannot be empty.");try{l="string"===typeof l?JSON.parse(l):l}catch(L){throw Error("ChannelService: Data Parsing Failed. ADD or UPDTAE payload not in expected format. Error: "+L.toString);}var n=l;switch(b){case m.ADD:var u="";n.hasOwnProperty("menuConfig")?n.hasOwnProperty("channelConfig")?
n.hasOwnProperty("channelState")||(u="channelState property missing in Channel Data"):u="channelConfig property missing in Channel Data":u="menuConfig property missing in Channel Data";if(u)throw Error(u);z(n.menuConfig);F(n.channelConfig);C(n.channelState);break;case m.UPDATE:n.hasOwnProperty("menuConfig")&&z(n.menuConfig);n.hasOwnProperty("channelConfig")&&F(n.channelConfig);n.hasOwnProperty("channelState")&&C(n.channelState);break;case m.UPDATE_CHANNEL_STATE:C(n);break;case m.UPDATE_MENU:z(n)}l=
w(l,b);if(b===m.ADD){if(!p||"function"!==typeof p)throw Error("ChannelService: onMenuClick parameter in addChannel() must be a function.");D.register(r,a,p);try{d.addHandler(q,y)}catch(L){throw k.log("ChannelService: Error while subscribing to open ajax topic : "+q+", Exception:"+L.toString()),Error("ChannelService: Unable to subscribe the channel topic with Open Ajax Hub : "+L);}}b=b!==m.ADD?m.UPDATE:b}p=c.generateUUID();b={id:r,topic:q,requestId:p,action:b,data:l};t.register(p,a,e,g);k.log("ChannelService: Sending channel request to FNC: "+
JSON.stringify(b));d.publish(h,b)};return{_fakeConstuctor:function(){},init:function(a){if(!f){if(!a)throw Error("ChannelService: Invalid ContainerService reference.");f=!0;d=a;window.finesse.clientservices.ClientServices.setLogger(window.finesse.cslogger.ClientLogger);h=a.Topics.FINEXT_NON_VOICE_GADGET_EVENT}return this},addChannel:function(a,b,c,d,e){x(a,m.ADD,d,e,b,c)},removeChannel:function(a,b,c){x(a,m.REMOVE,b,c)},updateChannel:function(a,b,c,d){x(a,m.UPDATE,c,d,b)},updateChannelMenu:function(a,
b,c,d){x(a,m.UPDATE_MENU,c,d,b)},updateChannelState:function(a,b,c,d){x(a,m.UPDATE_CHANNEL_STATE,c,d,b)},STATUS:l,STATE_STATUS:r,ICON_TYPE:G,ICON_BADGE_TYPE:B}}();finesse.digital=finesse.digital||{};window.finesse=window.finesse||{};window.finesse.digital=window.finesse.digital||{};window.finesse.digital.ChannelService=f;"object"===typeof d&&d.exports&&(d.exports=f);return f});h("containerservices/PopoverSchema",["require","exports","module"],function(g,f,d){g=function(){var a={$schema:"http://json-schema.org/draft-04/schema#",
type:"object",properties:{icon:{type:"object",properties:{type:{type:"string","enum":["collab-icon","url"]},value:{type:"string"}},required:["type","value"]},content:{type:"array",items:[{type:"object",properties:{name:{type:"string"},value:{type:"string"}},required:["name","value"]}]},headerContent:{type:"object",properties:{maxHeaderTitle:{type:"string"},minHeaderTitle:{type:"string"}}}},required:["icon"],additionalProperties:!1},b={$schema:"http://json-schema.org/draft-04/schema#",type:"object",
properties:{displayTimeoutInSecs:{type:"integer",oneOf:[{minimum:3,maximum:3600},{"enum":[-1]}]},display:{type:"boolean"},counterType:{type:"string","enum":["COUNT_UP","COUNT_DOWN"]}},oneOf:[{properties:{display:{type:"boolean","enum":[!1]}},required:["displayTimeoutInSecs","display"],not:{required:["counterType"]}},{properties:{display:{type:"boolean","enum":[!0]}},required:["displayTimeoutInSecs","display","counterType"]}],additionalProperties:!1},c={$schema:"http://json-schema.org/draft-04/schema#",
type:"object",properties:{keepMaximised:{type:"boolean"},dismissible:{type:"boolean"},clientIdentifier:{type:"string"},requiredActionText:{type:"string"},buttons:{type:"array",minItems:1,maxItems:2,uniqueItems:!0,items:[{type:"object",properties:{id:{type:"string"},label:{type:"string"},type:{type:"string"},hoverText:{type:"string"},confirmButtons:{type:"array",uniqueItems:!0,items:[{type:"object",properties:{id:{type:"string"},label:{type:"string"},hoverText:{type:"string"}},required:["id","label"]}]}},
required:["id","label","type"]}]}},oneOf:[{additionalProperties:!1,properties:{requiredActionText:{type:"string"},clientIdentifier:{type:"string"},dismissible:{type:"boolean","enum":[!1]},keepMaximised:{type:"boolean"},buttons:{type:"array"}}},{additionalProperties:!1,properties:{requiredActionText:{type:"string"},clientIdentifier:{type:"string"},dismissible:{type:"boolean","enum":[!0]},keepMaximised:{type:"boolean"}}}],required:["dismissible"],additionalProperties:!1};return{_fakeConstuctor:function(){},
getBannerDataSchema:function(){return a},getTimerDataSchema:function(){return b},getActionDataSchema:function(){return c}}}();window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};window.finesse.containerservices.PopoverSchema=g;"object"===typeof d&&d.exports&&(d.exports=g);return g});h("containerservices/PopoverService","require exports module ../utilities/Utilities ../clientservices/ClientServices ./PopoverSchema ../utilities/JsonValidator".split(" "),
function(g,f,d){f=function(){var a=g("../utilities/Utilities"),b=g("../clientservices/ClientServices"),c=g("./PopoverSchema"),d=g("../utilities/JsonValidator"),f,k,h=!1,m={log:b.log},l=Object.freeze({SHOW:"show",DISMISS:"dismiss",UPDATE:"update"}),r=function(){if(!h)throw Error("PopoverService needs to be inited.");return h},n=function(){var a={};return{add:function(b,c){a[b]={handler:c}},clear:function(b){a[b]&&delete a[b]},isExist:function(b){return void 0!==a[b]},sendEvent:function(b,c){a[b]&&
a[b].handler(c)}}}(),x=function(){var a=k.getMyGadgetId();return a?a:""},B=function(a){m.log("PopoverService: Received Message from PopoverComp: "+JSON.stringify(a));if(a){try{a="string"===typeof a?JSON.parse(a):a}catch(C){m.log("PopoverService: Error while parsing the popover message: "+C.toString());return}var b={};b.popoverId=a.id;b.source=a.source;m.log("PopoverService: Calling gadget action handler");n.sendEvent(b.popoverId,b);n.clear(b.popoverId)}},t=function(a){if(a){try{a="string"===typeof a?
JSON.parse(a):a}catch(F){throw Error("PopoverService: Data Parsing Failed. Popover data not in expected format. Error: "+F.toString());}return a}},D=function(a,b,c,d){var e=c.topic;try{k.addHandler(e,B)}catch(y){throw m.log("PopoverService: Error while subscribing to open ajax topic : "+e+", Exception:"+y.toString()),Error("PopoverService: Unable to subscribe the popover topic with Open Ajax Hub : "+y);}a||n.add(b,d);m.log("PopoverService: Sending popover show request to Finesse Popover Component: "+
JSON.stringify(c));k.publish(f,c)};return{_fakeConstuctor:function(){},init:function(a){if(!h){if(!a)throw Error("PopoverService: Invalid ContainerService reference.");k=a;f=a.Topics.FINEXT_POPOVER_EVENT;window.finesse.clientservices.ClientServices.setLogger(window.finesse.cslogger.ClientLogger);h=!0}return this},generatePayload:function(a,b,e,g,k){e=t(e);g=t(g);k=t(k);var h=f+"."+b,p=g,r=k,q=d.validateJson(e,c.getBannerDataSchema());if(!q.valid)throw m.log("PopoverService: Banner data validation bannerDataResult : "+
JSON.stringify(q)),Error("PopoverService: Banner data structure is not in expected format. Refer finesse client logs for more details.");p=d.validateJson(p,c.getTimerDataSchema());if(!p.valid)throw m.log("PopoverService: Timer data validation timerDataResult : "+JSON.stringify(p)),Error("PopoverService: Timer data structure is not in expected format. Refer finesse client logs for more details.");r=d.validateJson(r,c.getActionDataSchema());if(!r.valid)throw m.log("PopoverService: Action data validation actionDataResult : "+
JSON.stringify(r)),Error("PopoverService: Action data structure is not in expected format. Refer finesse client logs for more details.");a={id:b,topic:h,action:a?l.UPDATE:l.SHOW,data:{bannerData:e,timerData:g}};k&&(a.data.actionData=k);return a},showPopover:function(b,c,d,e){r();var f=a.generateUUID(),g=x();m.log("PopoverService: Received new popover show request from gadgetId "+g);b=this.generatePayload(!1,f,b,c,d);if("function"!==typeof e)throw Error("PopoverService: Action handler should be a function");
D(!1,f,b,e);return f},updatePopover:function(a,b,c,d){r();var e=x();m.log("PopoverService: Received an update popover request from gadgetId "+e);b=this.generatePayload(!0,a,b,c,d);D(!0,a,b,null)},dismissPopover:function(a){r();m.log("PopoverService: Received popover dismiss request for popover id "+a);a&&n.isExist(a)&&(k.publish(f,{id:a,action:l.DISMISS}),n.clear(a))},COUNTER_TYPE:Object.freeze({COUNT_UP:"COUNT_UP",COUNT_DOWN:"COUNT_DOWN"})}}();window.finesse=window.finesse||{};window.finesse.containerservices=
window.finesse.containerservices||{};window.finesse.containerservices.PopoverService=f;"object"===typeof d&&d.exports&&(d.exports=f);return f});h("workflow/WorkflowSchema",["require","exports","module"],function(g,f,d){g=function(){var a={$schema:"http://json-schema.org/draft-06/schema#",additionalProperties:!1,properties:{mediaType:{type:"string",title:"media type , eg. email, chat etc."},dialogId:{type:"string",title:"The Workflow requestId. this is will be used for logging purpose "},state:{type:"string",
title:"The When to performa ction Schema e.g. EMAIL_PRESENTED, EMAIL_READ etc"},taskVariables:{type:"object"}},required:["dialogId","state","mediaType"]};return{_fakeConstuctor:function(){},getWorkflowParamSchema:function(){return a}}}();window.finesse=window.finesse||{};window.finesse.workflow=window.finesse.workflow||{};window.finesse.workflow.WorkflowSchema=g;"object"===typeof d&&d.exports&&(d.exports=g);return g});h("workflow/WorkflowService","require exports module ./WorkflowSchema ../utilities/JsonValidator ../clientservices/ClientServices".split(" "),
function(g,f,d){f=function(){var a=g("./WorkflowSchema"),b=g("../utilities/JsonValidator"),c,d=!1,f={log:g("../clientservices/ClientServices").log};return{submitTask:function(e){if(!d)throw Error("WorkflowService needs to be initiated.");var g=b.validateJson(e,a.getWorkflowParamSchema());if(!g.valid)throw f.log("WorkflowService: Finesse workflow trigger API parameter  Validation result : "+JSON.stringify(g)),Error("workflow parameter structure is not in expected format. Refer finesse client logs for more details.");
f.log("[WorkflowService] workflow task submitted for Gadget : "+(c.getMyGadgetId()||"")+" : Workflow dialogId: "+e.dialogId);e={gadgetId:c.getMyGadgetId()||"",payload:e};c.publish("finesse.workflow.digitalChannels",e)},_fakeConstuctor:function(){},init:function(a){f.log("WorkflowService is getting initiated.....");if(!d){if(!a)throw Error("WorkflowService: Invalid ContainerService reference.");d=!0;c=a;window.finesse.clientservices.ClientServices.setLogger(window.finesse.cslogger.ClientLogger)}return this}}}();
window.finesse=window.finesse||{};window.finesse.workflow=window.finesse.workflow||{};window.finesse.workflow.WorkflowService=f;"object"===typeof d&&d.exports&&(d.exports=f);return f});h("restservices/UserTeamMessages",["restservices/RestCollectionBase","restservices/RestBase","utilities/Utilities","restservices/TeamMessage","restservices/TeamMessages"],function(g,f,d,a,b){g=b.extend({init:function(a){a=a||{};a.parentObj=this;this._super(a)},getRestClass:function(){return b},getRestItemClass:function(){return a},
getRestType:function(){return"TeamMessages"},supportsRequests:!1,supportsSubscriptions:!1,supportsRestItemSubscriptions:!1,getTeamMessages:function(a,b){b=b||{};this.restRequest("/finesse/api/"+this.getRestType()+"?createdBy="+a,{method:"GET",success:function(a){b.success(a.object.teamMessages?a.object.teamMessages.TeamMessage:null)},error:function(a){b.error(a)},content:{}});return this},deleteTeamMessage:function(a,b){b=b||{};this.restRequest(this.getRestItemBaseUrl()+"/"+a,{method:"DELETE",success:b.success,
error:b.error,content:void 0});return this}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.UserTeamMessages=g});h("shortcutkey/Utilities",[],function(){var g=function(){return{CONSTANTS:{MODIFIER_KEYS_CTRL_SHIFT:"ctrlKey+shiftKey",MODIFIER_KEYS_ALT_SHIFT:"altKey+shiftKey",MODIFIER_KEYS_CTRL_ALT:"ctrlKey+altKey",MODIFIER_KEYS_SHIFT:"shiftKey",MODIFIER_KEYS_CTRL:"ctrlKey",MODIFIER_KEYS_ALT:"altKey",ACTIVE_TAB:"activeTab",
ACTIVE_FRAME:"activeFrame"},getModifierKeys:function(f){return f.modifierKeys?f.modifierKeys.split(" ").join(""):g.CONSTANTS.MODIFIER_KEYS_CTRL_SHIFT},constrcutSKStoreObjKey:function(f){return this.getModifierKeys(f).replace("+","_")+"_"+f.key},constructIdFromKeyEvents:function(f){var d=[],a=g.CONSTANTS;f.ctrlKey&&f.shiftKey?(d.push(a.MODIFIER_KEYS_CTRL),d.push(a.MODIFIER_KEYS_SHIFT)):f.ctrlKey&&f.altKey?(d.push(a.MODIFIER_KEYS_CTRL),d.push(a.MODIFIER_KEYS_ALT)):f.altKey&&f.shiftKey?(d.push(a.MODIFIER_KEYS_ALT),
d.push(a.MODIFIER_KEYS_SHIFT)):!f.ctrlKey||f.shiftKey||f.altKey?!f.altKey||f.shiftKey||f.ctrlKey?!f.shiftKey||f.altKey||f.ctrlKey||d.push(a.MODIFIER_KEYS_SHIFT):d.push(a.MODIFIER_KEYS_ALT):d.push(a.MODIFIER_KEYS_CTRL);var b="";d.forEach(function(a){b+=a+"_"});return b+this._characterFromEvent(f)},_characterFromEvent:function(f){return String.fromCharCode(f.keyCode).toLowerCase()},Logger:{log:function(f){window.finesse&&window.finesse.cslogger?finesse.cslogger.ClientLogger.log(" [ShortcutKeyService] "+
f):console.log(f)}},isFinesseContainer:function(){var f=window.finesse?window.finesse.container:null,d=window.finesse?window.finesse.gadget:null;return f&&f.Config||d&&d.Config}}}();return g});h("shortcutkey/ShortcutKeyStore",["require","./Utilities"],function(g){return function(){var f=[],d=g("./Utilities"),a=d.CONSTANTS,b=d.Logger,c=function(a){return f.filter(function(b){return b.accessKey===a})},e=function(a){var c=0;a.forEach(function(a){f.forEach(function(d,e){a.iframeId&&d.iframeId===a.iframeId&&
d.id===a.id&&(b.log("Duplicate key registration found for gadget :"+d.iframeId+" and Key: "+d.id),c++)})});return 0<c},h=function(a){a.map(function(a){a.conflict=!0})},k=function(b,d){var e=c(b);if(e.filter(function(b){return b.executionScope===a.ACTIVE_FRAME}).length!==e.length||d.executionScope!==a.ACTIVE_FRAME)if(0<e.filter(function(b){return b.executionScope===a.ACTIVE_TAB}).length&&d.executionScope===a.ACTIVE_FRAME)d.conflict=!0,h(e);else if(0<e.length)if(d.isPageLevel)d.conflict=!0,h(e);else{var f=
e.filter(function(a){return a.isPageLevel});if(0<f.length)d.conflict=!0,h(f);else{var g=e.filter(function(a){return d.tabId===a.tabId});0<g.length&&g.forEach(function(b){if(b.componentName.replace(/\s/g,"")!==d.componentName.replace(/\s/g,""))b.accessKey===d.accessKey&&(d.conflict=!0,h(g));else if(d.iframeId===b.iframeId)d.conflict=!0,h(g);else if(b.executionScope===a.ACTIVE_TAB||d.executionScope===a.ACTIVE_TAB)d.conflict=!0,h(g)})}}},q=function(a){var b=window.cd;window!==top&&(b=window.top.cd);
if(b&&b.core.componentsMetaData[a])return b.core.componentsMetaData[a].hashVl},m=function(a){var b=window.top.finesse.containerservices.tabbedGadgets.refs,c;for(c in b)for(var d=b[c].runtimeGadgetsConfig,e=0;e<d.length;e++)if(d[e].attributes.id===a)return{navId:d[e].navId,id:c,tabId:d[e].attributes.id}};return{_fakeConstuctor:function(){},addShortcutKey:function(c){if(Array.isArray(c)){if(e(c))return;c.forEach(function(c){if(c instanceof Object){var e=d.constrcutSKStoreObjKey(c);c.accessKey=e;c.conflict=
!1;if(d.isFinesseContainer()){c.type="gadget"===c.type?c.type:"component";if("component"===c.type&&(c.executionScope===a.ACTIVE_FRAME&&(c.conflict=!0,b.log("Shortcut key for "+JSON.stringify(c)+" cannot have activeFrame executionScope since it is a component")),c.componentId)){var g=m(c.componentId);g?(c.tabId=g.navId,c.tabbedGadgetId=g.id,c.tabbedGadgetTabId=g.tabId):q(c.componentId)&&(c.tabId=q(c.componentId).substr(2))}c.tabId?c.tabLabel=document.querySelector('#leftNavUl [href^="#/'+c.tabId+'"]').getAttribute("title"):
c.isPageLevel=!0}k(e,c);f.push(c);!0===c.conflict&&"function"===typeof window.finesse.shortcutkey.ShortcutKeyService.updateIdentityMenu&&window.finesse.shortcutkey.ShortcutKeyService.updateIdentityMenu(!0);window.frameElement&&(c.iframeId=window.frameElement.id,window.gadgets&&window.gadgets.util&&(0<$(frameElement).closest(".tabbed-gadget-frame").length?(g=m($(frameElement).closest(".tabbed-gadget-frame").attr("id")),c.tabId=g.navId,c.tabbedGadgetId=g.id,c.tabbedGadgetTabId=g.tabId):(e=window.gadgets.util.getUrlParameters().up_navItemRoute,
c.tabId="undefined"!==e?e.substring(2,e.length):"",c.isPageLevel="undefined"===e?!0:!1),c.type="gadget"))}else throw Error("keys should be list of object");})}else b.log("keys should be array of objects");return c},getShortcutKeys:function(){return f},getShortcutKeyById:function(a){return f.filter(function(b){return b.accessKey.toLowerCase()===a.toLowerCase()})},init:function(){return this}}}()});h("shortcutkey/RegistrationParamValidator",["require","./Utilities"],function(g){return function(){var f=
g("./Utilities"),d=f.CONSTANTS,a=[d.MODIFIER_KEYS_CTRL_SHIFT,d.MODIFIER_KEYS_ALT_SHIFT,d.MODIFIER_KEYS_CTRL_ALT,d.MODIFIER_KEYS_CTRL,d.MODIFIER_KEYS_SHIFT,d.MODIFIER_KEYS_ALT],b=[d.ACTIVE_TAB,d.ACTIVE_FRAME],c=["id","componentName","actionName","key","handler"],e=function(a){c.forEach(function(b){if(!a.hasOwnProperty(b))throw Error(b+" is reuired field");})};return{_fakeConstuctor:function(){},validateRequiredParameter:function(a){e(a);Object.keys(a).forEach(function(b){var c=a[b];if("string"===typeof c&&
""===c.trim())throw Error(b+" can not have empty value");if("handler"===b&&"function"!==typeof c)throw Error("handler must be a function");})},validateModifireKeys:function(b){if(-1===a.indexOf(f.getModifierKeys(b)))throw Error("Invalid modifier key: "+b.modifierKeys+", Allowed modifier keys: "+JSON.stringify(a));},validateExecutionScopes:function(a){if(f.isFinesseContainer()&&-1===b.indexOf(a.executionScope))throw Error("Invalid executionScope. Allowed executionScope: "+JSON.stringify(b));}}}()});
h("shortcutkey/ShortcutKeyService","require exports module ./ShortcutKeyStore ./Utilities ./RegistrationParamValidator".split(" "),function(g,f,d){var a=function(){var b=g("./ShortcutKeyStore"),c=g("./Utilities"),d=c.CONSTANTS,f=c.Logger,h=g("./RegistrationParamValidator"),q=!1,m=function(a){return a.filter(function(a){return!0!==a.conflict})},l=function(a,b){if(!Array.isArray(a))throw Error("keys should be list of object");a.forEach(function(a){if(a instanceof Object)a.modifierKeys&&""!==a.modifierKeys.trim()||
(a.modifierKeys=d.MODIFIER_KEYS_CTRL_SHIFT),!c.isFinesseContainer()||a.executionScope&&""!==a.executionScope.trim()||(a.executionScope=d.ACTIVE_TAB),b.validateRequiredParameter(a),b.validateModifireKeys(a),b.validateExecutionScopes(a);else throw Error("keys should be list of object");})},n=function(a,b){var c=window.finesse.containerservices.tabbedGadgets.refs[a];return(c.navActiveTabMap&&c.navActiveTabMap[c.state.currentNavId])===b},u=function(a){return{ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,
keyCode:a.keyCode,key:String.fromCharCode(a.keyCode),which:a.which}},x=function(a){if(c.isFinesseContainer()&&"false"===window.finesse.container.Config.enableShortCutKeys)f.log("Shortcut Keys feature is disabled.");else{var e=c.constructIdFromKeyEvents(a),g;g=b.getShortcutKeyById(e);if(0===g.length)f.log("No key registered for "+e);else if(e=m(g),0===e.length)f.log("There are conflicts of shortcut keys: Following shortcut key will not work: "+JSON.stringify(g));else{if(finesse.container&&finesse.container.Tabs){var h=
finesse.container.Tabs.getActiveTab();g=e.filter(function(a){return a.tabId===h});e=1<e.length&&1<g.length?e.filter(function(a){return a.iframeId===document.activeElement.id})[0]:g[0]?g[0]:e[0]}else e=1<e.length?e.filter(function(a){return a.iframeId===document.activeElement.id})[0]:e[0];if(e){g=e.iframeId;if(finesse.container&&finesse.container.Tabs){if(e.executionScope===d.ACTIVE_FRAME&&e.iframeId!==document.activeElement.id){f.log("Shortcut key for "+JSON.stringify(e)+", will only work if that gadget has active focus");
return}if(e.tabId!==finesse.container.Tabs.getActiveTab()&&!e.isPageLevel){f.log("Shortcut key for "+JSON.stringify(e)+" gadget, will not work. The gadget is not present in current active tab");return}if(e.tabbedGadgetId&&!n(e.tabbedGadgetId,e.tabbedGadgetTabId)){f.log("Shortcut key for "+JSON.stringify(e)+" gadget, will not work. The gadget is not present in current active tab");return}}g?(a={type:"execute_shotcutkey_handler",keyEvent:u(a)},f.log("Asking gadget to execute shortcut key handler : "+
g),document.getElementById(g).contentWindow.postMessage(a,"*")):(f.log("Container is executing shortcut key handler for "+e.componentName+" : "+e.actionName),e.handler(a))}else f.log("Shortcut key for "+JSON.stringify(a)+", will only work if that gadget has active focus")}}},B=function(a){(a.ctrlKey&&a.shiftKey||a.altKey&&a.shiftKey||a.ctrlKey&&a.altKey||a.ctrlKey||a.altKey||a.shiftKey)&&"Shift"!==a.key&&"Control"!==a.key&&"Alt"!==a.key&&(window!==top?(a={type:"finesse_keyup_captured",keyEvent:u(a)},
parent.postMessage(a,"*")):x(a))},t=function(a){a=a[a.message?"message":"data"];if("register_shortcut_key"===a.type)b.addShortcutKey(JSON.parse(a.keys));else if("finesse_keyup_captured"==a.type)x(a.keyEvent);else if("execute_shotcutkey_handler"==a.type){var d=c.constructIdFromKeyEvents(a.keyEvent),d=b.getShortcutKeyById(d),d=m(d);0<d.length&&(validShortcutKeyObj=d[0],f.log("Gadget is executing shortcut key handler for "+validShortcutKeyObj.componentName+" : "+validShortcutKeyObj.actionName),validShortcutKeyObj.handler(a.keyEvent))}};
return{_fakeConstuctor:function(){},registerShortcutKey:function(a){if(!q)throw Error("ShortcutKeyService not intialized. Invoke init method to initialize");"autopilot-frame"===window.name||window.frameElement&&"autopilot-frame"===window.frameElement.id||(l(a,h),a=b.addShortcutKey(a),window!==top&&(a={type:"register_shortcut_key",keys:JSON.stringify(a)},parent.postMessage(a,"*")))},getShorcutKeys:function(){return b.getShortcutKeys().slice(0)},getConflictShortcutKeys:function(){return a.getShorcutKeys().filter(function(a){return!0===
a.conflict})},init:function(){q||("true"!==window.sessionStorage.getItem("finesseSkeyInitiated")&&document.addEventListener("keyup",B,!0),window.addEventListener("message",t,!1),q=!0);return q},sendKeyupEvent:function(a){a={type:"finesse_keyup_captured",keyEvent:{ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,keyCode:a.keyCode,key:String.fromCharCode(a.keyCode),which:a.which}};parent.postMessage(a,"*")},CONSTANTS:{MODIFIER_KEYS:{CTRL_SHIFT:d.MODIFIER_KEYS_CTRL_SHIFT,ALT_SHIFT:d.MODIFIER_KEYS_ALT_SHIFT,
CTRL_ALT:d.MODIFIER_KEYS_CTRL_ALT,CTRL:d.MODIFIER_KEYS_CTRL,SHIFT:d.MODIFIER_KEYS_SHIFT,ALT:d.MODIFIER_KEYS_ALT},EXECUTION_SCOPE:{ACTIVE_TAB:d.ACTIVE_TAB,ACTIVE_FRAME:d.ACTIVE_FRAME}}}}();window.finesse=window.finesse||{};window.finesse.shortcutkey=window.finesse.shortcutkey||{};window.finesse.shortcutkey.ShortcutKeyService=a;"object"===typeof d&&d.exports&&(d.exports=a);return a});h("utilities/RestCacheDataService",[],function(){var g=function(){var f=window.finesse.cslogger.ClientLogger,d={},a=
null,b=window.finesse.utilities.Utilities,c=b.IDB_ACTIONS,e=b.IDB_TOPICS,g=function(){if(gadgets&&gadgets.util&&gadgets.util.getUrlParameters())return gadgets.util.getUrlParameters().mid},h=function(b,c,d){f.log("Sending request to gadget with gadgetid: "+g()+" and requestid: "+b);var h={};h[e.REQUEST]={group:a?a:g(),requestId:b,gadgetId:g(),data:d,action:c};parent.postMessage(h,"*")};window.addEventListener("message",function(a){a.data.hasOwnProperty(e.RESPONSE)&&d[a.data[e.RESPONSE].requestId]&&
(a=a.data[e.RESPONSE],f.log("Recieved response from gadget with gadgetid: "+g()+" and requestid: "+a.requestId),d[a.requestId](a.error,a.data),delete d[a.requestId])});return{_fakeConstuctor:function(){},setGroup:function(b){a?f.log("Group already set to "+a+". Cannot set again."):a=b},saveOrUpdateData:function(a,e){var f=b.generateUUID();d[f]=e;h(f,c.SAVE_OR_UPDATE,a)},fetchData:function(a,e){var f=b.generateUUID();d[f]=e;h(f,c.FETCH,a)},deleteData:function(a,e){var f=b.generateUUID();d[f]=e;h(f,
c.DELETE,a)},clearData:function(a){var e=b.generateUUID();d[e]=a;h(e,c.CLEAR_ALL)}}}();window.finesse=window.finesse||{};window.finesse.utilities=window.finesse.utilities||{};return window.finesse.utilities.DesktopCache=g});h("restservices/Devices",["restservices/RestBase"],function(g){var f=g.extend({init:function(d){this._super(d);if(!d.extension)throw Error("Extension is mandatory");this.extension=d.extension},getRestClass:function(){return f},getRestType:function(){return"Devices"},getRestUrl:function(){return"/finesse/api/"+
this.getRestType()},getDevicesForExtension:function(d){var a=this;a.restRequest(a.getRestUrl()+"?extension="+a.extension,{method:"GET",success:function(b){d.success(a._util.xml2js(b.content))},error:function(a){d.error(a)},content:{},restType:a.getRestType()})}});window.finesse=window.finesse||{};window.finesse.restservices=window.finesse.restservices||{};return window.finesse.restservices.Devices=f});h("containerservices/TaskActivityNotification",[],function(){TaskActivityNotification=function(){var g=
!1,f,d,a=void 0,b=!1,c=!1,e={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{from:{type:"string",pattern:"^\\S+"},message:{type:"object",properties:{taskId:{type:"string",pattern:"^\\S+"},active:{type:"boolean"},mediaType:{type:"string",pattern:"^\\S+"},timestamp:{type:"integer",minimum:0},contextInfo:{type:"object",minProperties:1}},required:["taskId","active","mediaType"],additionalProperties:!1}},required:["from","message"],additionalProperties:!1},h=new finesse.restservices.Notifier,
k=function(b){if(a&&b.subscriberId){f.log("TaskActivityNotification - Request Active Task From:"+b.subscriberId);var c=JSON.parse(JSON.stringify(a));c.subscriberId=b.subscriberId;d.publish(TaskActivityNotification.Topics.TASK_ACTIVITY_STATUS,c);f.log("TaskActivityNotification - Request Active Task Response:"+JSON.stringify(c))}},n=function(a){a.subscriberId&&a.subscriberId!==window.frameElement.id?f.log("TaskActivityNotification - Ignored Received Active Task"+(window.frameElement?NaN+window.frameElement.id:
"")):(a=JSON.parse(JSON.stringify(a)),delete a.subscriberId,f.log("TaskActivityNotification - Received Active Task :"+JSON.stringify(a)),h.notifyListeners(a))};return{_fakeConstuctor:function(){},init:function(a){if(!g){f=finesse.cslogger.ClientLogger;if(!a||"function"!==typeof a.addHandler)throw Error("TaskActivityNotification: Invalid ContainerServices reference.");if(!gadgets.Hub)throw Error("TaskActivityNotification: gadgets.Hub is not available");d=a;g=!0}return this},notifyTaskSelection:function(c,
g){if(!g)throw Error("TaskActivityNotification - Missing parameter message payload");var h={from:c,message:JSON.parse(JSON.stringify(g))},l=finesse.utilities.JsonValidator.validateJson(h,e);if(!l.valid)throw f.log("TaskActivityNotification - JSON validation failed:"+JSON.stringify(l)),Error("TaskActivityNotification: "+l.error.dataPath+" - "+l.error.message);b||(d.addHandler(TaskActivityNotification.Topics.REQUEST_TASK_ACTIVITY_STATUS,k),b=!0);h.message.timestamp||(h.message.timestamp=Date.now());
h.message.contextInfo||(h.message.contextInfo={});d.publish(TaskActivityNotification.Topics.TASK_ACTIVITY_STATUS,h);a=h;f.log("TaskActivityNotification - Publish Active Task :"+JSON.stringify(a))},registerForTaskNotifications:function(a){if("function"!==typeof a)throw Error("TaskActivityNotification: callback provided is not of type 'function'");c||(d.addHandler(TaskActivityNotification.Topics.TASK_ACTIVITY_STATUS,n),c=!0);h.addListener(a);f.log("TaskActivityNotification - Registered a callback")},
requestCurrentTasks:function(){if(0===h._listenerCallback.length)throw Error("TaskActivityNotification: no callbacks registered for receiving task notifications");var a=window.frameElement.id;f.log("TaskActivityNotification - Invoke Request Active Task from:"+a);d.publish(TaskActivityNotification.Topics.REQUEST_TASK_ACTIVITY_STATUS,{subscriberId:a})}}}();TaskActivityNotification.Topics={TASK_ACTIVITY_STATUS:"TaskActivityStatus",REQUEST_TASK_ACTIVITY_STATUS:"RequestTaskActivityStatus",_fakeConstructor:function(){}};
window.finesse=window.finesse||{};window.finesse.containerservices=window.finesse.containerservices||{};return window.finesse.containerservices.TaskActivityNotification=TaskActivityNotification});h("finesse","restservices/Users restservices/Teams restservices/SystemInfo restservices/Media restservices/MediaDialogs restservices/DialogLogoutActions restservices/InterruptActions restservices/ReasonCodeLookup restservices/ChatConfig restservices/ECCVariableConfig.js utilities/I18n utilities/Logger utilities/SaxParser utilities/BackSpaceHandler utilities/JsonValidator cslogger/ClientLogger cslogger/FinesseLogger containerservices/ContainerServices containerservices/FinesseToaster interfaces/RestObjectHandlers interfaces/RequestHandlers gadget/Config digital/ChannelSchema digital/ChannelService containerservices/PopoverService containerservices/PopoverSchema workflow/WorkflowSchema workflow/WorkflowService restservices/UserTeamMessages shortcutkey/ShortcutKeyService utilities/RestCacheDataService restservices/Devices containerservices/TaskActivityNotification".split(" "),
function(){window.finesse.restservices.bypassServerCache=window.document.referrer?-1<window.document.referrer.indexOf("bypassServerCache=true")?!0:!1:-1<window.location.href.indexOf("bypassServerCache=true")?!0:!1;return window.finesse});x(["finesse"]);return x("finesse")});var finesse=window.finesse;//# sourceMappingURL=finesse.js.map
